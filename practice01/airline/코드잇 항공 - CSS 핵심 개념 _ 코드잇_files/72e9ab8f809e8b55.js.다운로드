
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c35bd250-fb5b-5a1d-a523-e287f3ddc1fd")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,840930,540193,766269,261873,722045,502123,e=>{"use strict";let t,r,n,i,s,o,a,l,u,c,h,d,p,f,g,m,v,y,b,w,_,S,I,C,E,k;var x,O,R,T,A,M,P,N,D,L,U,F,j,B,q,z,V,W,G,K,Y,Z,$,H,J,X,Q,ee,et,er,en,ei,es,eo,ea,el,eu,ec,eh,ed,ep,ef,eg,em,ev,ey,eb,ew,e_,eS,eI,eC,eE,ek,ex,eO,eR,eT,eA,eM,eP,eN,eD=e.i(274466),eL="".concat("AMP","_unsent"),eU="https://api2.amplitude.com/2/httpapi",eF=function(e){if(Object.keys(e).length>1e3)return!1;for(var t in e){var r=e[t];if(!ej(t,r))return!1}return!0},ej=function(e,t){var r,n;if("string"!=typeof e)return!1;if(Array.isArray(t)){var i=!0;try{for(var s=(0,eD.__values)(t),o=s.next();!o.done;o=s.next()){var a=o.value;if(Array.isArray(a))return!1;if("object"==typeof a)i=i&&eF(a);else if(!["number","string"].includes(typeof a))return!1;if(!i)return!1}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}else if(null==t)return!1;else if("object"==typeof t)return eF(t);else if(!["number","string","boolean"].includes(typeof t))return!1;return!0},eB=function(){function e(){this._propertySet=new Set,this._properties={}}return e.prototype.getUserProperties=function(){return(0,eD.__assign)({},this._properties)},e.prototype.set=function(e,t){return this._safeSet(ed.SET,e,t),this},e.prototype.setOnce=function(e,t){return this._safeSet(ed.SET_ONCE,e,t),this},e.prototype.append=function(e,t){return this._safeSet(ed.APPEND,e,t),this},e.prototype.prepend=function(e,t){return this._safeSet(ed.PREPEND,e,t),this},e.prototype.postInsert=function(e,t){return this._safeSet(ed.POSTINSERT,e,t),this},e.prototype.preInsert=function(e,t){return this._safeSet(ed.PREINSERT,e,t),this},e.prototype.remove=function(e,t){return this._safeSet(ed.REMOVE,e,t),this},e.prototype.add=function(e,t){return this._safeSet(ed.ADD,e,t),this},e.prototype.unset=function(e){return this._safeSet(ed.UNSET,e,"-"),this},e.prototype.clearAll=function(){return this._properties={},this._properties[ed.CLEAR_ALL]="-",this},e.prototype._safeSet=function(e,t,r){if(this._validate(e,t,r)){var n=this._properties[e];return void 0===n&&(n={},this._properties[e]=n),n[t]=r,this._propertySet.add(t),!0}return!1},e.prototype._validate=function(e,t,r){return!(void 0!==this._properties[ed.CLEAR_ALL]||this._propertySet.has(t))&&(e===ed.ADD?"number"==typeof r:e===ed.UNSET||e===ed.REMOVE||ej(t,r))},e}();(x=ed||(ed={})).SET="$set",x.SET_ONCE="$setOnce",x.ADD="$add",x.APPEND="$append",x.PREPEND="$prepend",x.REMOVE="$remove",x.PREINSERT="$preInsert",x.POSTINSERT="$postInsert",x.UNSET="$unset",x.CLEAR_ALL="$clearAll";var eq=[ed.CLEAR_ALL,ed.UNSET,ed.SET,ed.SET_ONCE,ed.ADD,ed.APPEND,ed.PREPEND,ed.PREINSERT,ed.POSTINSERT,ed.REMOVE];e.s(["Identify",()=>eB,"OrderedIdentifyOperations",()=>eq],840930),(O=ep||(ep={}))[O.None=0]="None",O[O.Error=1]="Error",O[O.Warn=2]="Warn",O[O.Verbose=3]="Verbose",O[O.Debug=4]="Debug";var ez=function(e){return function(){var t=(0,eD.__assign)({},e.config);return{logger:t.loggerProvider,logLevel:t.logLevel}}},eV=function(e,t){var r,n;t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"");try{for(var i=(0,eD.__values)(t.split(".")),s=i.next();!s.done;s=i.next()){var o=s.value;if(!(o in e))return;e=e[o]}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e},eW=function(e,t){return function(){var r,n,i={};try{for(var s=(0,eD.__values)(t),o=s.next();!o.done;o=s.next()){var a=o.value;i[a]=eV(e,a)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}},eG=function(e,t,r,n,i){return void 0===i&&(i=null),function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var a=r(),l=a.logger,u=a.logLevel;if(u&&u<ep.Debug||!u||!l)return e.apply(i,s);var c={type:"invoke public method",name:t,args:s,stacktrace:(Error().stack||"").split("\n").slice(3).map(function(e){return e.trim()}),time:{start:new Date().toISOString()},states:{}};n&&c.states&&(c.states.before=n());var h=e.apply(i,s);return h&&h.promise?h.promise.then(function(){n&&c.states&&(c.states.after=n()),c.time&&(c.time.end=new Date().toISOString()),l.debug(JSON.stringify(c,null,2))}):(n&&c.states&&(c.states.after=n()),c.time&&(c.time.end=new Date().toISOString()),l.debug(JSON.stringify(c,null,2))),h}};(R=ef||(ef={})).SET="$set",R.SET_ONCE="$setOnce",R.ADD="$add",R.APPEND="$append",R.PREPEND="$prepend",R.REMOVE="$remove",R.PREINSERT="$preInsert",R.POSTINSERT="$postInsert",R.UNSET="$unset",R.CLEAR_ALL="$clearAll",(T=eg||(eg={})).IDENTIFY="$identify",T.GROUP_IDENTIFY="$groupidentify",T.REVENUE="revenue_amount",(A=em||(em={})).Unknown="unknown",A.Skipped="skipped",A.Success="success",A.RateLimit="rate_limit",A.PayloadTooLarge="payload_too_large",A.Invalid="invalid",A.Failed="failed",A.Timeout="Timeout",A.SystemError="SystemError";var eK=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=em.Unknown),{event:e,code:t,message:r}},eY=function(){var t="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[t]?globalThis[t]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e.g},eZ=(0,eD.__spreadArray)([],(0,eD.__read)(Array(256).keys()),!1).map(function(e){return e.toString(16).padStart(2,"0")}),e$=function(e){var t,r=eY();if(!(null==(t=null==r?void 0:r.crypto)?void 0:t.getRandomValues))return e?(e^16*Math.random()>>e/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,e$);var n=r.crypto.getRandomValues(new Uint8Array(16));return n[6]=15&n[6]|64,n[8]=63&n[8]|128,(0,eD.__spreadArray)([],(0,eD.__read)(n.entries()),!1).map(function(e){var t=(0,eD.__read)(e,2),r=t[0],n=t[1];return[4,6,8,10].includes(r)?"-".concat(eZ[n]):eZ[n]}).join("")},eH=function(){function e(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return e.prototype.register=function(e,t){var r,n;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if(this.plugins.some(function(t){return t.name===e.name}))return t.loggerProvider.warn("Plugin with name ".concat(e.name," already exists, skipping registration")),[2];return void 0===e.name&&(e.name=e$(),t.loggerProvider.warn("Plugin name is undefined. \n      Generating a random UUID for plugin name: ".concat(e.name,". \n      Set a name for the plugin to prevent it from being added multiple times."))),e.type=null!=(r=e.type)?r:"enrichment",[4,null==(n=e.setup)?void 0:n.call(e,t,this.client)];case 1:return i.sent(),this.plugins.push(e),[2]}})})},e.prototype.deregister=function(e,t){var r;return(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,eD.__generator)(this,function(s){switch(s.label){case 0:if(-1===(n=this.plugins.findIndex(function(t){return t.name===e})))return t.loggerProvider.warn("Plugin with name ".concat(e," does not exist, skipping deregistration")),[2];return i=this.plugins[n],this.plugins.splice(n,1),[4,null==(r=i.teardown)?void 0:r.call(i)];case 1:return s.sent(),[2]}})})},e.prototype.reset=function(e){this.applying=!1,this.plugins.map(function(e){var t;return null==(t=e.teardown)?void 0:t.call(e)}),this.plugins=[],this.client=e},e.prototype.push=function(e){var t=this;return new Promise(function(r){t.queue.push([e,r]),t.scheduleApply(0)})},e.prototype.scheduleApply=function(e){var t=this;this.applying||(this.applying=!0,setTimeout(function(){t.apply(t.queue.shift()).then(function(){t.applying=!1,t.queue.length>0&&t.scheduleApply(0)})},e))},e.prototype.apply=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n,i,s,o,a,l,u,c,h,d,p,f;return(0,eD.__generator)(this,function(g){switch(g.label){case 0:if(!e)return[2];t=(0,eD.__read)(e,1)[0],r=(0,eD.__read)(e,2)[1],n=this.plugins.filter(function(e){return"before"===e.type}),g.label=1;case 1:g.trys.push([1,6,7,8]),s=(i=(0,eD.__values)(n)).next(),g.label=2;case 2:if(s.done)return[3,5];if(!(o=s.value).execute)return[3,4];return[4,o.execute((0,eD.__assign)({},t))];case 3:if(null===(a=g.sent()))return r({event:t,code:0,message:""}),[2];t=a,g.label=4;case 4:return s=i.next(),[3,2];case 5:return[3,8];case 6:return h={error:g.sent()},[3,8];case 7:try{s&&!s.done&&(d=i.return)&&d.call(i)}finally{if(h)throw h.error}return[7];case 8:l=this.plugins.filter(function(e){return"enrichment"===e.type||void 0===e.type}),g.label=9;case 9:g.trys.push([9,14,15,16]),c=(u=(0,eD.__values)(l)).next(),g.label=10;case 10:if(c.done)return[3,13];if(!(o=c.value).execute)return[3,12];return[4,o.execute((0,eD.__assign)({},t))];case 11:if(null===(a=g.sent()))return r({event:t,code:0,message:""}),[2];t=a,g.label=12;case 12:return c=u.next(),[3,10];case 13:return[3,16];case 14:return p={error:g.sent()},[3,16];case 15:try{c&&!c.done&&(f=u.return)&&f.call(u)}finally{if(p)throw p.error}return[7];case 16:return Promise.all(this.plugins.filter(function(e){return"destination"===e.type}).map(function(e){var r=(0,eD.__assign)({},t);return e.execute(r).catch(function(e){return eK(r,0,String(e))})})).then(function(e){var n=(0,eD.__read)(e,1)[0]||eK(t,100,"Event not tracked, no destination plugins on the instance");r(n)}),[2]}})})},e.prototype.flush=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){var e,t=this;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(e){return t.apply(e)}))];case 1:return r.sent(),[4,Promise.all(this.plugins.filter(function(e){return"destination"===e.type}).map(function(e){return e.flush&&e.flush()}))];case 2:return r.sent(),[2]}})})},e.prototype.onIdentityChanged=function(e){this.plugins.forEach(function(t){var r;null==(r=t.onIdentityChanged)||r.call(t,e)})},e.prototype.onSessionIdChanged=function(e){this.plugins.forEach(function(t){var r;null==(r=t.onSessionIdChanged)||r.call(t,e)})},e.prototype.onOptOutChanged=function(e){this.plugins.forEach(function(t){var r;null==(r=t.onOptOutChanged)||r.call(t,e)})},e}(),eJ=function(e,t){return(0,eD.__assign)((0,eD.__assign)({},t),{event_type:eg.IDENTIFY,user_properties:e.getUserProperties()})},eX=function(e,t,r,n){var i;return(0,eD.__assign)((0,eD.__assign)({},n),{event_type:eg.GROUP_IDENTIFY,group_properties:r.getUserProperties(),groups:((i={})[e]=t,i)})},eQ=function(e,t,r){var n,i=new eB;return i.set(e,t),(0,eD.__assign)((0,eD.__assign)({},r),{event_type:eg.IDENTIFY,user_properties:i.getUserProperties(),groups:((n={})[e]=t,n)})},e0=function(e){return{promise:e||Promise.resolve()}},e1=function(){function e(e){void 0===e&&(e="$default"),this.initializing=!1,this.isReady=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new eH(this),this.name=e}return e.prototype._init=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return this.config=e,this.timeline.reset(this),[4,this.runQueuedFunctions("q")];case 1:return t.sent(),this.isReady=!0,[2]}})})},e.prototype.runQueuedFunctions=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n,i,s,o;return(0,eD.__generator)(this,function(a){switch(a.label){case 0:t=this[e],this[e]=[],a.label=1;case 1:a.trys.push([1,8,9,10]),n=(r=(0,eD.__values)(t)).next(),a.label=2;case 2:if(n.done)return[3,7];if(!((i=(0,n.value)())&&"promise"in i))return[3,4];return[4,i.promise];case 3:return a.sent(),[3,6];case 4:return[4,i];case 5:a.sent(),a.label=6;case 6:return n=r.next(),[3,2];case 7:return[3,10];case 8:return s={error:a.sent()},[3,10];case 9:try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}return[7];case 10:if(!this[e].length)return[3,12];return[4,this.runQueuedFunctions(e)];case 11:a.sent(),a.label=12;case 12:return[2]}})})},e.prototype.track=function(e,t,r){var n=(0,eD.__assign)((0,eD.__assign)((0,eD.__assign)({},"string"==typeof e?{event_type:e}:e),r),t&&{event_properties:t});return e0(this.dispatch(n))},e.prototype.identify=function(e,t){var r=eJ(e,t);return e0(this.dispatch(r))},e.prototype.groupIdentify=function(e,t,r,n){var i=eX(e,t,r,n);return e0(this.dispatch(i))},e.prototype.setGroup=function(e,t,r){var n=eQ(e,t,r);return e0(this.dispatch(n))},e.prototype.revenue=function(e,t){var r=(0,eD.__assign)((0,eD.__assign)({},t),{event_type:eg.REVENUE,event_properties:e.getEventProperties()});return e0(this.dispatch(r))},e.prototype.add=function(e){return this.isReady?this._addPlugin(e):(this.q.push(this._addPlugin.bind(this,e)),e0())},e.prototype._addPlugin=function(e){return e0(this.timeline.register(e,this.config))},e.prototype.remove=function(e){return this.isReady?this._removePlugin(e):(this.q.push(this._removePlugin.bind(this,e)),e0())},e.prototype._removePlugin=function(e){return e0(this.timeline.deregister(e,this.config))},e.prototype.dispatchWithCallback=function(e,t){if(!this.isReady)return t(eK(e,0,"Client not initialized"));this.process(e).then(t)},e.prototype.dispatch=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,eD.__generator)(this,function(r){return this.isReady?[2,this.process(e)]:[2,new Promise(function(r){t.dispatchQ.push(t.dispatchWithCallback.bind(t,e,r))})]})})},e.prototype.getOperationAppliedUserProperties=function(e){var t={};if(void 0===e)return t;var r={};return Object.keys(e).forEach(function(t){Object.values(ef).includes(t)||(r[t]=e[t])}),eq.forEach(function(r){if(Object.keys(e).includes(r)){var n=e[r];switch(r){case ef.CLEAR_ALL:Object.keys(t).forEach(function(e){delete t[e]});break;case ef.UNSET:Object.keys(n).forEach(function(e){delete t[e]});break;case ef.SET:Object.assign(t,n)}}}),Object.assign(t,r),t},e.prototype.process=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),this.config.optOut)return[2,eK(e,0,"Event skipped due to optOut config")];return e.event_type===eg.IDENTIFY&&(t=this.getOperationAppliedUserProperties(e.user_properties),this.timeline.onIdentityChanged({userProperties:t})),[4,this.timeline.push(e)];case 1:return 200===(r=i.sent()).code?this.config.loggerProvider.log(r.message):100===r.code?this.config.loggerProvider.warn(r.message):this.config.loggerProvider.error(r.message),[2,r];case 2:return n=String(i.sent()),this.config.loggerProvider.error(n),[2,r=eK(e,0,n)];case 3:return[2]}})})},e.prototype.setOptOut=function(e){this.isReady?this._setOptOut(e):this.q.push(this._setOptOut.bind(this,!!e))},e.prototype._setOptOut=function(e){this.config.optOut!==e&&(this.timeline.onOptOutChanged(e),this.config.optOut=!!e)},e.prototype.flush=function(){return e0(this.timeline.flush())},e.prototype.plugin=function(e){var t=this.timeline.plugins.find(function(t){return t.name===e});return void 0===t?void this.config.loggerProvider.debug("Cannot find plugin with name ".concat(e)):t},e.prototype.plugins=function(e){return this.timeline.plugins.filter(function(t){return t instanceof e})},e}(),e2=function(e,t){var r=Math.max(t,1);return e.reduce(function(e,t,n){var i=Math.floor(n/r);return e[i]||(e[i]=[]),e[i].push(t),e},[])},e3="Amplitude Logger ",e4=function(){function e(){this.logLevel=ep.None}return e.prototype.disable=function(){this.logLevel=ep.None},e.prototype.enable=function(e){void 0===e&&(e=ep.Warn),this.logLevel=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<ep.Verbose||console.log("".concat(e3,"[Log]: ").concat(e.join(" ")))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<ep.Warn||console.warn("".concat(e3,"[Warn]: ").concat(e.join(" ")))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<ep.Error||console.error("".concat(e3,"[Error]: ").concat(e.join(" ")))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<ep.Debug||console.log("".concat(e3,"[Debug]: ").concat(e.join(" ")))},e}(),e5=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:ep.Warn,loggerProvider:new e4,offline:!1,optOut:!1,serverUrl:eU,serverZone:"US",useBatch:!1}},e6=function(){function e(e){this._optOut=!1;var t,r,n,i,s=e5();this.apiKey=e.apiKey,this.flushIntervalMillis=null!=(t=e.flushIntervalMillis)?t:s.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||s.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||s.flushQueueSize,this.instanceName=e.instanceName||s.instanceName,this.loggerProvider=e.loggerProvider||s.loggerProvider,this.logLevel=null!=(r=e.logLevel)?r:s.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=void 0!==e.offline?e.offline:s.offline,this.optOut=null!=(n=e.optOut)?n:s.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||s.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=null!=(i=e.useBatch)?i:s.useBatch,this.loggerProvider.enable(this.logLevel);var o=e8(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=o.serverZone,this.serverUrl=o.serverUrl}return Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),e}(),e8=function(e,t,r){if(void 0===e&&(e=""),void 0===t&&(t=e5().serverZone),void 0===r&&(r=e5().useBatch),e)return{serverUrl:e,serverZone:void 0};var n,i=["US","EU"].includes(t)?t:e5().serverZone;return{serverZone:i,serverUrl:(n=r,"EU"===i?n?"https://api.eu.amplitude.com/batch":"https://api.eu.amplitude.com/2/httpapi":n?"https://api2.amplitude.com/batch":eU)}},e9=function(){function e(){this.sdk={metrics:{histogram:{}}}}return e.prototype.recordHistogram=function(e,t){this.sdk.metrics.histogram[e]=t},e}();function e7(e){var t="";try{"body"in e&&(t=JSON.stringify(e.body,null,2))}catch(e){}return t}var te=function(){function e(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduleId=null,this.scheduledTimeout=0,this.flushId=null,this.queue=[]}return e.prototype.setup=function(e){var t;return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n=this;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return this.config=e,this.storageKey="".concat(eL,"_").concat(this.config.apiKey.substring(0,10)),[4,null==(t=this.config.storageProvider)?void 0:t.get(this.storageKey)];case 1:return(r=i.sent())&&r.length>0&&Promise.all(r.map(function(e){return n.execute(e)})).catch(),[2,Promise.resolve(void 0)]}})})},e.prototype.execute=function(e){var t=this;return e.insert_id||(e.insert_id=e$()),new Promise(function(r){t.queue.push({event:e,attempts:0,callback:function(e){return r(e)},timeout:0}),t.schedule(t.config.flushIntervalMillis),t.saveEvents()})},e.prototype.removeEventsExceedFlushMaxRetries=function(e){var t=this;return e.filter(function(e){return e.attempts+=1,e.attempts<t.config.flushMaxRetries||(t.fulfillRequest([e],500,"Event rejected due to exceeded retry count"),!1)})},e.prototype.scheduleEvents=function(e){var t=this;e.forEach(function(e){t.schedule(0===e.timeout?t.config.flushIntervalMillis:e.timeout)})},e.prototype.schedule=function(e){var t=this;if(!this.config.offline&&(null===this.scheduleId||this.scheduleId&&e>this.scheduledTimeout)){this.scheduleId&&clearTimeout(this.scheduleId),this.scheduledTimeout=e,this.scheduleId=setTimeout(function(){t.queue=t.queue.map(function(e){return e.timeout=0,e}),t.flush(!0)},e);return}},e.prototype.resetSchedule=function(){this.scheduleId=null,this.scheduledTimeout=0},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n=this;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if(this.config.offline)return this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush while offline."),[2];if(this.flushId)return this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush because previous flush has not resolved."),[2];return this.flushId=this.scheduleId,this.resetSchedule(),t=[],r=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):r.push(e)}),[4,e2(t,this.config.flushQueueSize).reduce(function(t,r){return(0,eD.__awaiter)(n,void 0,void 0,function(){return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return[4,t];case 1:return n.sent(),[4,this.send(r,e)];case 2:return[2,n.sent()]}})})},Promise.resolve())];case 1:return i.sent(),this.flushId=null,this.scheduleEvents(this.queue),[2]}})})},e.prototype.send=function(e,t){return void 0===t&&(t=!0),(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,"Event rejected due to missing API key")];r={api_key:this.config.apiKey,events:e.map(function(e){var t=e.event;return t.extra,(0,eD.__rest)(t,["extra"])}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString(),request_metadata:this.config.requestMetadata},this.config.requestMetadata=new e9,o.label=1;case 1:return o.trys.push([1,3,,4]),n=e8(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(n,r)];case 2:if(null===(i=o.sent()))return this.fulfillRequest(e,0,"Unexpected error occurred"),[2];if(!t)return"body"in i?this.fulfillRequest(e,i.statusCode,"".concat(i.status,": ").concat(e7(i))):this.fulfillRequest(e,i.statusCode,i.status),[2];return this.handleResponse(i,e),[3,4];case 3:var a;return s=(a=o.sent())instanceof Error?a.message:String(a),this.config.loggerProvider.error(s),this.handleResponse({status:em.Failed,statusCode:0},e),[3,4];case 4:return[2]}})})},e.prototype.handleResponse=function(e,t){var r=e.status;switch(r){case em.Success:this.handleSuccessResponse(e,t);break;case em.Invalid:this.handleInvalidResponse(e,t);break;case em.PayloadTooLarge:this.handlePayloadTooLargeResponse(e,t);break;case em.RateLimit:this.handleRateLimitResponse(e,t);break;default:this.config.loggerProvider.warn("{code: 0, error: \"Status '".concat(r,"' provided for ").concat(t.length,' events"}')),this.handleOtherResponse(t)}},e.prototype.handleSuccessResponse=function(e,t){this.fulfillRequest(t,e.statusCode,"Event tracked successfully")},e.prototype.handleInvalidResponse=function(e,t){var r=this;if(e.body.missingField||e.body.error.startsWith("Invalid API key"))return void this.fulfillRequest(t,e.statusCode,e.body.error);var n=new Set((0,eD.__spreadArray)((0,eD.__spreadArray)((0,eD.__spreadArray)((0,eD.__spreadArray)([],(0,eD.__read)(Object.values(e.body.eventsWithInvalidFields)),!1),(0,eD.__read)(Object.values(e.body.eventsWithMissingFields)),!1),(0,eD.__read)(Object.values(e.body.eventsWithInvalidIdLengths)),!1),(0,eD.__read)(e.body.silencedEvents),!1).flat()),i=t.filter(function(t,i){return!n.has(i)||void r.fulfillRequest([t],e.statusCode,e.body.error)});i.length>0&&this.config.loggerProvider.warn(e7(e));var s=this.removeEventsExceedFlushMaxRetries(i);this.scheduleEvents(s)},e.prototype.handlePayloadTooLargeResponse=function(e,t){if(1===t.length)return void this.fulfillRequest(t,e.statusCode,e.body.error);this.config.loggerProvider.warn(e7(e)),this.config.flushQueueSize/=2;var r=this.removeEventsExceedFlushMaxRetries(t);this.scheduleEvents(r)},e.prototype.handleRateLimitResponse=function(e,t){var r=this,n=Object.keys(e.body.exceededDailyQuotaUsers),i=Object.keys(e.body.exceededDailyQuotaDevices),s=e.body.throttledEvents,o=new Set(n),a=new Set(i),l=new Set(s),u=t.filter(function(t,n){return t.event.user_id&&o.has(t.event.user_id)||t.event.device_id&&a.has(t.event.device_id)?void r.fulfillRequest([t],e.statusCode,e.body.error):(l.has(n)&&(t.timeout=r.throttleTimeout),!0)});u.length>0&&this.config.loggerProvider.warn(e7(e));var c=this.removeEventsExceedFlushMaxRetries(u);this.scheduleEvents(c)},e.prototype.handleOtherResponse=function(e){var t=this,r=e.map(function(e){return e.timeout=e.attempts*t.retryTimeout,e}),n=this.removeEventsExceedFlushMaxRetries(r);this.scheduleEvents(n)},e.prototype.fulfillRequest=function(e,t,r){this.removeEvents(e),e.forEach(function(e){return e.callback(eK(e.event,t,r))})},e.prototype.saveEvents=function(){if(this.config.storageProvider){var e=this.queue.map(function(e){return e.event});this.config.storageProvider.set(this.storageKey,e)}},e.prototype.removeEvents=function(e){this.queue=this.queue.filter(function(t){return!e.some(function(e){return e.event.insert_id===t.event.insert_id})}),this.saveEvents()},e}(),tt=function(){function e(){this.productId="",this.quantity=1,this.price=0}return e.prototype.setProductId=function(e){return this.productId=e,this},e.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},e.prototype.setPrice=function(e){return this.price=e,this},e.prototype.setRevenueType=function(e){return this.revenueType=e,this},e.prototype.setCurrency=function(e){return this.currency=e,this},e.prototype.setRevenue=function(e){return this.revenue=e,this},e.prototype.setReceipt=function(e){return this.receipt=e,this},e.prototype.setReceiptSig=function(e){return this.receiptSig=e,this},e.prototype.setEventProperties=function(e){return eF(e)&&(this.properties=e),this},e.prototype.getEventProperties=function(){var e=this.properties?(0,eD.__assign)({},this.properties):{};return e[ev.REVENUE_PRODUCT_ID]=this.productId,e[ev.REVENUE_QUANTITY]=this.quantity,e[ev.REVENUE_PRICE]=this.price,e[ev.REVENUE_TYPE]=this.revenueType,e[ev.REVENUE_CURRENCY]=this.currency,e[ev.REVENUE]=this.revenue,e[ev.RECEIPT]=this.receipt,e[ev.RECEIPT_SIG]=this.receiptSig,e},e}();(M=ev||(ev={})).REVENUE_PRODUCT_ID="$productId",M.REVENUE_QUANTITY="$quantity",M.REVENUE_PRICE="$price",M.REVENUE_TYPE="$revenueType",M.REVENUE_CURRENCY="$currency",M.REVENUE="$revenue",M.RECEIPT="$receipt",M.RECEIPT_SIG="$receiptSig";var tr=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:tn(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),tn=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},ti=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(t){e(t)}),this.queue=[])},e}(),ts=function(){return(ts=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function to(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ta(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}"function"==typeof SuppressedError&&SuppressedError;var tl=function(e,t){var r,n,i=typeof e;if(i!==typeof t)return!1;try{for(var s=to(["string","number","boolean","undefined"]),o=s.next();!o.done;o=s.next())if(o.value===i)return e===t}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;var a=Array.isArray(e),l=Array.isArray(t);if(a!==l)return!1;if(a&&l){for(var u=0;u<e.length;u++)if(!tl(e[u],t[u]))return!1}else{if(!tl(Object.keys(e).sort(),Object.keys(t).sort()))return!1;var c=!0;return Object.keys(e).forEach(function(r){tl(e[r],t[r])||(c=!1)}),c}return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=Array(r);r--;)n[r]=[t[r],e[t[r]]];return n});var tu=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=ts({},this.identity.userProperties),r=ts(ts({},this.identity),{userProperties:t});return{setUserId:function(e){return r.userId=e,this},setDeviceId:function(e){return r.deviceId=e,this},setUserProperties:function(e){return r.userProperties=e,this},setOptOut:function(e){return r.optOut=e,this},updateUserProperties:function(e){var t,n,i,s,o,a,l=r.userProperties||{};try{for(var u=to(Object.entries(e)),c=u.next();!c.done;c=u.next()){var h=ta(c.value,2),d=h[0],p=h[1];switch(d){case"$set":try{for(var f=(i=void 0,to(Object.entries(p))),g=f.next();!g.done;g=f.next()){var m=ta(g.value,2),v=m[0],y=m[1];l[v]=y}}catch(e){i={error:e}}finally{try{g&&!g.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}break;case"$unset":try{for(var b=(o=void 0,to(Object.keys(p))),w=b.next();!w.done;w=b.next()){var v=w.value;delete l[v]}}catch(e){o={error:e}}finally{try{w&&!w.done&&(a=b.return)&&a.call(b)}finally{if(o)throw o.error}}break;case"$clearAll":l={}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return r.userProperties=l,this},commit:function(){return e.setIdentity(r),this}}},e.prototype.getIdentity=function(){return ts({},this.identity)},e.prototype.setIdentity=function(e){var t=ts({},this.identity);this.identity=ts({},e),tl(t,this.identity)||this.listeners.forEach(function(t){t(e)})},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),tc="undefined"!=typeof globalThis?globalThis:e.g,th=function(){function e(){this.identityStore=new tu,this.eventBridge=new ti,this.applicationContextProvider=new tr}return e.getInstance=function(t){return tc.analyticsConnectorInstances||(tc.analyticsConnectorInstances={}),tc.analyticsConnectorInstances[t]||(tc.analyticsConnectorInstances[t]=new e),tc.analyticsConnectorInstances[t]},e}(),td=function(e){return void 0===e&&(e="$default_instance"),th.getInstance(e)},tp=function(e,t){td(t).identityStore.editIdentity().setUserId(e).commit()},tf=function(e,t){td(t).identityStore.editIdentity().setDeviceId(e).commit()},tg=function(e,t){return void 0===t&&(t=Date.now()),Date.now()-t>e},tm=function(){function e(){this.name="identity",this.type="before",this.identityStore=td().identityStore}return e.prototype.execute=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){return(t=e.user_properties)&&this.identityStore.editIdentity().updateUserProperties(t).commit(),[2,e]})})},e.prototype.setup=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return e.instanceName&&(this.identityStore=td(e.instanceName).identityStore),[2]})})},e}(),tv=function(){var e,t=eY();return(null==(e=null==t?void 0:t.location)?void 0:e.search)?t.location.search.substring(1).split("&").filter(Boolean).reduce(function(e,t){var r=t.split("=",2),n=ty(r[0]),i=ty(r[1]);return i&&(e[n]=i),e},{}):{}},ty=function(e){void 0===e&&(e="");try{return decodeURIComponent(e)}catch(e){return""}},tb=function(e,t){return"boolean"==typeof e?e:(null==e?void 0:e[t])!==!1},tw=function(e){return tb(e,"attribution")},t_=function(e){return tb(e,"pageViews")},tS=function(e){return tb(e,"sessions")},tI=function(e){return"object"==typeof e&&(!0===e.networkTracking||"object"==typeof e.networkTracking)},tC=function(e){return"boolean"==typeof e?e:"object"==typeof e&&(!0===e.elementInteractions||"object"==typeof e.elementInteractions)},tE=function(e){if(tC(e.autocapture)&&"object"==typeof e.autocapture&&"object"==typeof e.autocapture.elementInteractions)return e.autocapture.elementInteractions},tk=function(e){if(tI(e.autocapture)){if("object"==typeof e.autocapture&&"object"==typeof e.autocapture.networkTracking)return e.autocapture.networkTracking;else if(e.networkTrackingOptions)return e.networkTrackingOptions}},tx=function(e){var t,r=function(){return!1},n=void 0,i=e.pageCounter;return t_(e.defaultTracking)&&(r=void 0,t=void 0,e.defaultTracking&&"object"==typeof e.defaultTracking&&e.defaultTracking.pageViews&&"object"==typeof e.defaultTracking.pageViews&&("trackOn"in e.defaultTracking.pageViews&&(r=e.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in e.defaultTracking.pageViews&&(n=e.defaultTracking.pageViews.trackHistoryChanges),"eventType"in e.defaultTracking.pageViews&&e.defaultTracking.pageViews.eventType&&(t=e.defaultTracking.pageViews.eventType))),{trackOn:r,trackHistoryChanges:n,eventType:t,pageCounter:i}},tO=function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.name,s=n.args,o=n.resolve,a=e&&e[i];if("function"==typeof a){var l=a.apply(e,s);"function"==typeof o&&o(null==l?void 0:l.promise)}}return e},tR=function(e){return e&&void 0!==e._q},tT=function(){if("undefined"==typeof navigator)return"";var e,t,r,n,i=navigator.userLanguage;return null!=(n=null!=(r=null!=(t=null==(e=navigator.languages)?void 0:e[0])?t:navigator.language)?r:i)?n:""},tA="2.17.8",tM=function(){function e(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="".concat("amplitude-ts","/").concat(tA),"undefined"!=typeof navigator&&(this.userAgent=navigator.userAgent)}return e.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},e.prototype.execute=function(e){var t,r;return(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i,s;return(0,eD.__generator)(this,function(o){return n=new Date().getTime(),i=null!=(t=this.config.lastEventId)?t:-1,s=null!=(r=e.event_id)?r:i+1,this.config.lastEventId=s,e.time||(this.config.lastEventTime=n),[2,(0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:n},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:"Web"}),this.config.trackingOptions.language&&{language:tT()}),this.config.trackingOptions.ipAddress&&{ip:"$remote"}),{insert_id:e$(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:s,library:this.library,user_agent:this.userAgent})]})})},e}(),tP=function(){function e(){this.memoryStorage=new Map}return e.prototype.isEnabled=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,!0]})})},e.prototype.get=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return[2,this.memoryStorage.get(e)]})})},e.prototype.getRaw=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return[4,this.get(e)];case 1:return[2,(t=r.sent())?JSON.stringify(t):void 0]}})})},e.prototype.set=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return this.memoryStorage.set(e,t),[2]})})},e.prototype.remove=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return this.memoryStorage.delete(e),[2]})})},e.prototype.reset=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return this.memoryStorage.clear(),[2]})})},e}(),tN=function(){function e(e){this.options=(0,eD.__assign)({},e)}return e.prototype.isEnabled=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:if(!eY())return[2,!1];e.testValue=String(Date.now()),t=new e(this.options),r="AMP_TEST",n.label=1;case 1:return n.trys.push([1,4,5,7]),[4,t.set(r,e.testValue)];case 2:return n.sent(),[4,t.get(r)];case 3:return[2,n.sent()===e.testValue];case 4:return n.sent(),[2,!1];case 5:return[4,t.remove(r)];case 6:return n.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){var t;return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getRaw(e)];case 1:if(!(r=i.sent()))return[2,void 0];try{if(n=null!=(t=tD(r))?t:tL(r),void 0===n)return console.error("Amplitude Logger [Error]: Failed to decode cookie value for key: ".concat(e,", value: ").concat(r)),[2,void 0];return[2,JSON.parse(n)]}catch(t){return console.error("Amplitude Logger [Error]: Failed to parse cookie value for key: ".concat(e,", value: ").concat(r)),[2,void 0]}}})})},e.prototype.getRaw=function(e){var t,r;return(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,eD.__generator)(this,function(s){return(i=(null!=(r=null==(t=null==(n=eY())?void 0:n.document)?void 0:t.cookie.split("; "))?r:[]).find(function(t){return 0===t.indexOf(e+"=")}))?[2,i.substring(e.length+1)]:[2,void 0]})})},e.prototype.set=function(e,t){var r;return(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,a,l,u;return(0,eD.__generator)(this,function(c){try{n=null!=(r=this.options.expirationDays)?r:0,i=null!==t?n:-1,s=void 0,i&&((o=new Date).setTime(o.getTime()+24*i*36e5),s=o),a="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(t)))),s&&(a+="; expires=".concat(s.toUTCString())),a+="; path=/",this.options.domain&&(a+="; domain=".concat(this.options.domain)),this.options.secure&&(a+="; Secure"),this.options.sameSite&&(a+="; SameSite=".concat(this.options.sameSite)),(l=eY())&&(l.document.cookie=a)}catch(t){u=t instanceof Error?t.message:String(t),console.error("Amplitude Logger [Error]: Failed to set cookie for key: ".concat(e,". Error: ").concat(u))}return[2]})})},e.prototype.remove=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return[4,this.set(e,null)];case 1:return t.sent(),[2]}})})},e.prototype.reset=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2]})})},e}(),tD=function(e){try{return decodeURIComponent(atob(e))}catch(e){return}},tL=function(e){try{return decodeURIComponent(atob(decodeURIComponent(e)))}catch(e){return}},tU=function(e,t,r){return void 0===t&&(t=""),void 0===r&&(r=10),["AMP",t,e.substring(0,r)].filter(Boolean).join("_")},tF=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,r,n,i,s,o,a,l,u,c,h,d,p,f,g,m,v,y,b,w,_,S,I=e.code||0,C=this.buildStatus(I);switch(C){case em.Success:return{status:C,statusCode:I,body:{eventsIngested:null!=(t=e.events_ingested)?t:0,payloadSizeBytes:null!=(r=e.payload_size_bytes)?r:0,serverUploadTime:null!=(n=e.server_upload_time)?n:0}};case em.Invalid:return{status:C,statusCode:I,body:{error:null!=(i=e.error)?i:"",missingField:null!=(s=e.missing_field)?s:"",eventsWithInvalidFields:null!=(o=e.events_with_invalid_fields)?o:{},eventsWithMissingFields:null!=(a=e.events_with_missing_fields)?a:{},eventsWithInvalidIdLengths:null!=(l=e.events_with_invalid_id_lengths)?l:{},epsThreshold:null!=(u=e.eps_threshold)?u:0,exceededDailyQuotaDevices:null!=(c=e.exceeded_daily_quota_devices)?c:{},silencedDevices:null!=(h=e.silenced_devices)?h:[],silencedEvents:null!=(d=e.silenced_events)?d:[],throttledDevices:null!=(p=e.throttled_devices)?p:{},throttledEvents:null!=(f=e.throttled_events)?f:[]}};case em.PayloadTooLarge:return{status:C,statusCode:I,body:{error:null!=(g=e.error)?g:""}};case em.RateLimit:return{status:C,statusCode:I,body:{error:null!=(m=e.error)?m:"",epsThreshold:null!=(v=e.eps_threshold)?v:0,throttledDevices:null!=(y=e.throttled_devices)?y:{},throttledUsers:null!=(b=e.throttled_users)?b:{},exceededDailyQuotaDevices:null!=(w=e.exceeded_daily_quota_devices)?w:{},exceededDailyQuotaUsers:null!=(_=e.exceeded_daily_quota_users)?_:{},throttledEvents:null!=(S=e.throttled_events)?S:[]}};case em.Timeout:default:return{status:C,statusCode:I}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?em.Success:429===e?em.RateLimit:413===e?em.PayloadTooLarge:408===e?em.Timeout:e>=400&&e<500?em.Invalid:e>=500?em.Failed:em.Unknown},e}(),tj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,eD.__extends)(t,e),t.prototype.send=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if("undefined"==typeof fetch)throw Error("FetchTransport is not supported");return[4,fetch(e,{headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(t),method:"POST"})];case 1:return[4,(r=i.sent()).text()];case 2:n=i.sent();try{return[2,this.buildResponse(JSON.parse(n))]}catch(e){return[2,this.buildResponse({code:r.status})]}}})})},t}(tF),tB=function(){function e(e){this.storage=e}return e.prototype.isEnabled=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if(!this.storage)return[2,!1];t=String(Date.now()),r=new e(this.storage),n="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,r.set(n,t)];case 2:return i.sent(),[4,r.get(n)];case 3:return[2,i.sent()===t];case 4:return i.sent(),[2,!1];case 5:return[4,r.remove(n)];case 6:return i.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:if(!(t=r.sent()))return[2,void 0];return[2,JSON.parse(t)];case 2:return r.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},e.prototype.getRaw=function(e){var t;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return[2,(null==(t=this.storage)?void 0:t.getItem(e))||void 0]})})},e.prototype.set=function(e,t){var r;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(n){try{null==(r=this.storage)||r.setItem(e,JSON.stringify(t))}catch(e){}return[2]})})},e.prototype.remove=function(e){var t;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){try{null==(t=this.storage)||t.removeItem(e)}catch(e){}return[2]})})},e.prototype.reset=function(){var e;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){try{null==(e=this.storage)||e.clear()}catch(e){}return[2]})})},e}(),tq=function(e){function t(t){var r,n,i,s=this;try{i=null==(r=eY())?void 0:r.localStorage}catch(e){null==(n=null==t?void 0:t.loggerProvider)||n.debug("Failed to access localStorage. error=".concat(JSON.stringify(e))),i=void 0}return(s=e.call(this,i)||this).loggerProvider=null==t?void 0:t.loggerProvider,s}return(0,eD.__extends)(t,e),t.prototype.set=function(t,r){var n;return(0,eD.__awaiter)(this,void 0,void 0,function(){var i;return(0,eD.__generator)(this,function(s){switch(s.label){case 0:if(!(Array.isArray(r)&&r.length>1e3))return[3,2];return i=r.length-1e3,[4,e.prototype.set.call(this,t,r.slice(0,1e3))];case 1:return s.sent(),null==(n=this.loggerProvider)||n.error("Failed to save ".concat(i," events because the queue length exceeded ").concat(1e3,".")),[3,4];case 2:return[4,e.prototype.set.call(this,t,r)];case 3:s.sent(),s.label=4;case 4:return[2]}})})},t}(tB),tz=function(e){function t(){var t;return e.call(this,null==(t=eY())?void 0:t.sessionStorage)||this}return(0,eD.__extends)(t,e),t}(tB),tV=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={done:4},t}return(0,eD.__extends)(t,e),t.prototype.send=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,eD.__generator)(this,function(n){return[2,new Promise(function(n,i){"undefined"==typeof XMLHttpRequest&&i(Error("XHRTransport is not supported."));var s=new XMLHttpRequest;s.open("POST",e,!0),s.onreadystatechange=function(){if(s.readyState===r.state.done){var e=s.responseText;try{n(r.buildResponse(JSON.parse(e)))}catch(e){n(r.buildResponse({code:s.status}))}}},s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Accept","*/*"),s.send(JSON.stringify(t))})]})})},t}(tF),tW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,eD.__extends)(t,e),t.prototype.send=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,eD.__generator)(this,function(n){return[2,new Promise(function(n,i){var s=eY();if(!(null==s?void 0:s.navigator.sendBeacon))throw Error("SendBeaconTransport is not supported");try{var o=JSON.stringify(t);if(s.navigator.sendBeacon(e,JSON.stringify(t)))return n(r.buildResponse({code:200,events_ingested:t.events.length,payload_size_bytes:o.length,server_upload_time:Date.now()}));return n(r.buildResponse({code:500}))}catch(e){i(e)}})]})})},t}(tF),tG=function(e){var t=parseInt(e,32);if(!isNaN(t))return t},tK=function(e){if(atob&&escape&&e)try{return decodeURIComponent(escape(atob(e)))}catch(e){return}},tY="[Amplitude]",tZ="".concat(tY," Form Started"),t$="".concat(tY," Form Submitted"),tH="".concat(tY," File Downloaded"),tJ="session_start",tX="session_end",tQ="".concat(tY," File Extension"),t0="".concat(tY," File Name"),t1="".concat(tY," Link ID"),t2="".concat(tY," Link Text"),t3="".concat(tY," Link URL"),t4="".concat(tY," Form ID"),t5="".concat(tY," Form Name"),t6="".concat(tY," Form Destination"),t8="cookie",t9=function(e){function t(t,r,n,i,s,o,a,l,u,c,h,d,p,f,g,m,v,y,b,w,_,S,I,C,E,k,x,O,R,T,A,M,P,N,D){void 0===n&&(n=new tP),void 0===i&&(i={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),void 0===l&&(l=1e3),void 0===u&&(u=5),void 0===c&&(c=30),void 0===h&&(h=t8),void 0===m&&(m=new e4),void 0===v&&(v=ep.Warn),void 0===b&&(b=!1),void 0===w&&(w=!1),void 0===I&&(I=""),void 0===C&&(C="US"),void 0===k&&(k=18e5),void 0===x&&(x=new tq({loggerProvider:m})),void 0===O&&(O={ipAddress:!0,language:!0,platform:!0}),void 0===R&&(R="fetch"),void 0===T&&(T=!1),void 0===A&&(A=!0);var L=e.call(this,{apiKey:t,storageProvider:x,transportProvider:re(R)})||this;return L.apiKey=t,L.appVersion=r,L.cookieOptions=i,L.defaultTracking=s,L.autocapture=o,L.flushIntervalMillis=l,L.flushMaxRetries=u,L.flushQueueSize=c,L.identityStorage=h,L.ingestionMetadata=d,L.instanceName=p,L.loggerProvider=m,L.logLevel=v,L.minIdLength=y,L.offline=b,L.partnerId=_,L.plan=S,L.serverUrl=I,L.serverZone=C,L.sessionTimeout=k,L.storageProvider=x,L.trackingOptions=O,L.transport=R,L.useBatch=T,L.fetchRemoteConfig=A,L.networkTrackingOptions=D,L.version=tA,L._optOut=!1,L._cookieStorage=n,L.deviceId=a,L.lastEventId=f,L.lastEventTime=g,L.optOut=w,L.sessionId=E,L.pageCounter=P,L.userId=M,L.debugLogsEnabled=N,L.loggerProvider.enable(N?ep.Debug:L.logLevel),L.networkTrackingOptions=D,L}return(0,eD.__extends)(t,e),Object.defineProperty(t.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(e){this._cookieStorage!==e&&(this._cookieStorage=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceId",{get:function(){return this._deviceId},set:function(e){this._deviceId!==e&&(this._deviceId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},set:function(e){this._userId!==e&&(this._userId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},set:function(e){this._sessionId!==e&&(this._sessionId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut!==e&&(this._optOut=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(e){this._lastEventTime!==e&&(this._lastEventTime=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(e){this._lastEventId!==e&&(this._lastEventId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCounter",{get:function(){return this._pageCounter},set:function(e){this._pageCounter!==e&&(this._pageCounter=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugLogsEnabled",{set:function(e){this._debugLogsEnabled!==e&&(this._debugLogsEnabled=e,this.updateStorage())},enumerable:!1,configurable:!0}),t.prototype.updateStorage=function(){var e={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId,pageCounter:this._pageCounter,debugLogsEnabled:this._debugLogsEnabled};this.cookieStorage.set(tU(this.apiKey),e)},t}(e6),t7=function(e,t){switch(void 0===e&&(e=t8),void 0===t&&(t={}),e){case"localStorage":return new tq;case"sessionStorage":return new tz;case"none":return new tP;default:return new tN((0,eD.__assign)((0,eD.__assign)({},t),{expirationDays:t.expiration}))}},re=function(e){return"xhr"===e?new tV:"beacon"===e?new tW:new tj},rt=function(){var t="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[t]?globalThis[t]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e.g},rr=function(){var e,t=rt();return(null==(e=null==t?void 0:t.location)?void 0:e.search)?t.location.search.substring(1).split("&").filter(Boolean).reduce(function(e,t){var r=t.split("=",2),n=rn(r[0]),i=rn(r[1]);return i&&(e[n]=i),e},{}):{}},rn=function(e){void 0===e&&(e="");try{return decodeURIComponent(e)}catch(e){return""}},ri="dclid",rs="fbclid",ro="gbraid",ra="gclid",rl="ko_click_id",ru="li_fat_id",rc="msclkid",rh="rtd_cid",rd="ttclid",rp="twclid",rf="wbraid",rg={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},rm=function(){function e(){}return e.prototype.parse=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,(0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)({},rg),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var e=rr();return{utm_campaign:e.utm_campaign,utm_content:e.utm_content,utm_id:e.utm_id,utm_medium:e.utm_medium,utm_source:e.utm_source,utm_term:e.utm_term}},e.prototype.getReferrer=function(){var e,t,r={referrer:void 0,referring_domain:void 0};try{r.referrer=document.referrer||void 0,r.referring_domain=null!=(t=null==(e=r.referrer)?void 0:e.split("/")[2])?t:void 0}catch(e){}return r},e.prototype.getClickIds=function(){var e,t=rr();return(e={})[ri]=t[ri],e[rs]=t[rs],e[ro]=t[ro],e[ra]=t[ra],e[rl]=t[rl],e[ru]=t[ru],e[rc]=t[rc],e[rh]=t[rh],e[rd]=t[rd],e[rp]=t[rp],e[rf]=t[rf],e},e}();(P=ey||(ey={})).SET="$set",P.SET_ONCE="$setOnce",P.ADD="$add",P.APPEND="$append",P.PREPEND="$prepend",P.REMOVE="$remove",P.PREINSERT="$preInsert",P.POSTINSERT="$postInsert",P.UNSET="$unset",P.CLEAR_ALL="$clearAll",(N=eb||(eb={})).REVENUE_PRODUCT_ID="$productId",N.REVENUE_QUANTITY="$quantity",N.REVENUE_PRICE="$price",N.REVENUE_TYPE="$revenueType",N.REVENUE_CURRENCY="$currency",N.REVENUE="$revenue",(D=ew||(ew={})).IDENTIFY="$identify",D.GROUP_IDENTIFY="$groupidentify",D.REVENUE="revenue_amount";var rv=function(e){var t={};for(var r in e){var n=e[r];n&&(t[r]=n)}return t},ry=function(e){void 0===e&&(e={});var t,r,n=rt(),i=void 0,s=!1,o=e.trackOn,a=e.trackHistoryChanges,l=e.eventType,u=void 0===l?"[Amplitude] Page Viewed":l,c=function(e){var t=e;try{t=decodeURI(e)}catch(e){null==i||i.error("Malformed URI sequence: ",e)}return t},h=function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return e=c("undefined"!=typeof location&&location.href||""),r={event_type:u},t=[{}],[4,rb()];case 1:return[2,(r.event_properties=eD.__assign.apply(void 0,[eD.__assign.apply(void 0,t.concat([n.sent()])),{"[Amplitude] Page Domain":"undefined"!=typeof location&&location.hostname||"","[Amplitude] Page Location":e,"[Amplitude] Page Path":"undefined"!=typeof location&&c(location.pathname)||"","[Amplitude] Page Title":"undefined"!=typeof document&&document.title||"","[Amplitude] Page URL":e.split("?")[0]}]),r)]}})})},d=function(){return void 0===o||"function"==typeof o&&o()},p="undefined"!=typeof location?location.href:null,f=function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,r,n,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:if(r=r_(a,e=location.href,p||"")&&d(),p=e,!r)return[3,4];if(null==i||i.log("Tracking page view event"),null!=t)return[3,1];return[3,3];case 1:return s=(n=t).track,[4,h()];case 2:s.apply(n,[o.sent()]),o.label=3;case 3:o.label=4;case 4:return[2]}})})},g=function(){f()};return{name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(e,o){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var a,l;return(0,eD.__generator)(this,function(u){switch(u.label){case 0:if(t=o,r=e,(i=e.loggerProvider).log("Installing @amplitude/plugin-page-view-tracking-browser"),s=!0,n&&(n.addEventListener("popstate",g),n.history.pushState=new Proxy(n.history.pushState,{apply:function(e,t,r){var n=(0,eD.__read)(r,3),i=n[0],o=n[1],a=n[2];e.apply(t,[i,o,a]),s&&f()}})),!d())return[3,2];return i.log("Tracking page view event"),l=(a=t).track,[4,h()];case 1:l.apply(a,[u.sent()]),u.label=2;case 2:return[2]}})})},execute:function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:if(!("attribution"===o&&rw(e)))return[3,2];return null==i||i.log("Enriching campaign event to page view event with campaign parameters"),[4,h()];case 1:e.event_type=(t=n.sent()).event_type,e.event_properties=(0,eD.__assign)((0,eD.__assign)({},e.event_properties),t.event_properties),n.label=2;case 2:return r&&e.event_type===u&&(r.pageCounter=r.pageCounter?r.pageCounter+1:1,e.event_properties=(0,eD.__assign)((0,eD.__assign)({},e.event_properties),{"[Amplitude] Page Counter":r.pageCounter})),[2,e]}})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return n&&(n.removeEventListener("popstate",g),s=!1),[2]})})}}},rb=function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return e=rv,[4,new rm().parse()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})},rw=function(e){if("$identify"===e.event_type&&e.user_properties){var t=e.user_properties,r=t[ey.SET]||{},n=t[ey.UNSET]||{},i=(0,eD.__spreadArray)((0,eD.__spreadArray)([],(0,eD.__read)(Object.keys(r)),!1),(0,eD.__read)(Object.keys(n)),!1);return Object.keys(rg).every(function(e){return i.includes(e)})}return!1},r_=function(e,t,r){if("pathOnly"!==e)return t!==r;if(""==r)return!0;var n=new URL(t),i=new URL(r);return n.origin+n.pathname!==i.origin+i.pathname},rS=function(){var e,t=[],r=function(e,r,n){e.addEventListener(r,n),t.push({element:e,type:r,handler:n})},n=function(){t.forEach(function(e){var t=e.element,r=e.type,n=e.handler;null==t||t.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-form-interaction-tracking-browser",type:"enrichment",setup:function(t,n){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var i,s;return(0,eD.__generator)(this,function(o){return i=function(){if(!n)return void t.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.");if("undefined"!=typeof document){var i=function(e){var t=!1;r(e,"change",function(){var r,i=rC(e);t||n.track(tZ,((r={})[t4]=rI(e.id),r[t5]=rI(e.name),r[t6]=i,r)),t=!0}),r(e,"submit",function(){var r,i,s=rC(e);t||n.track(tZ,((r={})[t4]=rI(e.id),r[t5]=rI(e.name),r[t6]=s,r)),n.track(t$,((i={})[t4]=rI(e.id),i[t5]=rI(e.name),i[t6]=s,i)),t=!1})};Array.from(document.getElementsByTagName("form")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"FORM"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("form")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}},"complete"===document.readyState?i():(s=eY())?s.addEventListener("load",i):t.loggerProvider.debug("Form interaction tracking is not installed because global is undefined."),[2]})})},execute:function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return null==e||e.disconnect(),n(),[2]})})}}},rI=function(e){if("string"==typeof e)return e},rC=function(e){var t=e.getAttribute("action");try{t=new URL(encodeURI(null!=t?t:""),window.location.href).href}catch(e){}return t},rE=function(){var e,t=[],r=function(e,r,n){e.addEventListener(r,n),t.push({element:e,type:r,handler:n})},n=function(){t.forEach(function(e){var t=e.element,r=e.type,n=e.handler;null==t||t.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-file-download-tracking-browser",type:"enrichment",setup:function(t,n){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var i,s;return(0,eD.__generator)(this,function(o){return i=function(){if(!n)return void t.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.");if("undefined"!=typeof document){var i=function(e){try{t=new URL(e.href,window.location.href)}catch(e){return}var t,i=s.exec(t.href),o=null==i?void 0:i[1];o&&r(e,"click",function(){var r;o&&n.track(tH,((r={})[tQ]=o,r[t0]=t.pathname,r[t1]=e.id,r[t2]=e.text,r[t3]=e.href,r))})},s=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)(\?.+)?$/;Array.from(document.getElementsByTagName("a")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"A"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("a")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}},"complete"===document.readyState?i():(s=eY())?s.addEventListener("load",i):t.loggerProvider.debug("File download tracking is not installed because global is undefined."),[2]})})},execute:function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return null==e||e.disconnect(),n(),[2]})})}}},rk=!1,rx=function(e){rk||void 0!==e.defaultTracking||(e.loggerProvider.warn("`options.defaultTracking` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to `options.defaultTracking`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:\n\namplitude.init(<YOUR_API_KEY>, {\n  defaultTracking: true,\n});\n\nVisit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details."),rk=!0)},rO=function(){var e=eY(),t=[],r=function(r,n){e&&(e.addEventListener(r,n),t.push({type:r,handler:n}))},n=function(){t.forEach(function(t){var r=t.type,n=t.handler;e&&e.removeEventListener(r,n)}),t=[]};return{name:"@amplitude/plugin-network-checker-browser",type:"before",setup:function(e,t){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(n){return"undefined"==typeof navigator?(e.loggerProvider.debug("Network connectivity checker plugin is disabled because navigator is not available."),e.offline=!1):(e.offline=!navigator.onLine,r("online",function(){e.loggerProvider.debug("Network connectivity changed to online."),e.offline=!1,setTimeout(function(){t.flush()},e.flushIntervalMillis)}),r("offline",function(){e.loggerProvider.debug("Network connectivity changed to offline."),e.offline=!0})),[2]})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return n(),[2]})})}}};(L=e_||(e_={})).US="US",L.EU="EU",(U=eS||(eS={})).Unknown="unknown",U.Skipped="skipped",U.Success="success",U.RateLimit="rate_limit",U.PayloadTooLarge="payload_too_large",U.Invalid="invalid",U.Failed="failed",U.Timeout="Timeout",U.SystemError="SystemError";var rR="Remote config fetch rejected due to timeout after 5 seconds",rT="Unexpected error occurred",rA=function(){function e(e){var t=e.localConfig,r=e.configKeys,n=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteConfig=function(e,t,r){return(0,eD.__awaiter)(n,void 0,void 0,function(){var n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:return n=Date.now(),[4,this.fetchWithTimeout(r)];case 1:if((i=o.sent())&&(s=i.configs&&i.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-n,[2,s[t]];return this.metrics.fetchTimeAPIFail=Date.now()-n,[2,void 0]}})})},this.fetchWithTimeout=function(e){return(0,eD.__awaiter)(n,void 0,void 0,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return t=new AbortController,r=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return n=i.sent(),clearTimeout(r),[2,n]}})})},this.fetchRemoteConfig=function(e,t){return(0,eD.__awaiter)(n,void 0,void 0,function(){var r,n,i,s,o,a,l,u,c,h,d;return(0,eD.__generator)(this,function(p){switch(p.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:rR})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0);p.label=1;case 1:p.trys.push([1,3,,4]),r=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=(n=(0,eD.__values)(this.configKeys)).next();!i.done;i=n.next())s=i.value,r.append("config_keys",s)}catch(e){c={error:e}}finally{try{i&&!i.done&&(h=n.return)&&h.call(n)}finally{if(c)throw c.error}}return t&&r.set("session_id",String(t)),o={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(r.toString()),this.attempts+=1,[4,fetch(a,(0,eD.__assign)((0,eD.__assign)({},o),{signal:e}))];case 2:if(null===(l=p.sent()))return[2,this.completeRequest({err:rT})];switch(new tF().buildStatus(l.status)){case eS.Success:return this.attempts=0,[2,this.parseAndStoreConfig(l)];case eS.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}case 3:if(u=p.sent(),e.aborted)return[2,this.completeRequest({err:rR})];return[2,this.completeRequest({err:null!=(d=u.message)?d:rT})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,eD.__awaiter)(n,void 0,void 0,function(){var r=this;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return[4,new Promise(function(e){return setTimeout(e,r.attempts*r.retryTimeout)})];case 1:return n.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e){return(0,eD.__awaiter)(n,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return[4,e.json()];case 1:return t=r.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}})})},this.localConfig=t,this.configKeys=r}return e.prototype.getServerUrl=function(){return this.localConfig.serverZone===e_.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===e_.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,r=e.success;if(t)throw Error(t);r&&this.localConfig.loggerProvider.log(r)},e}(),rM=function(e){var t=e.localConfig,r=e.configKeys;return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,new rA({localConfig:t,configKeys:r})]})})},rP=function(){function e(e){this.config=e,this.config.loggerProvider.debug("Local configuration before merging with remote config",JSON.stringify(this.config,null,2))}return e.prototype.initialize=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return e=this,[4,rM({localConfig:this.config,configKeys:["analyticsSDK"]})];case 1:return e.remoteConfigFetch=t.sent(),[2]}})})},e.prototype.generateJoinedConfig=function(){var e,t,r,n,i;return(0,eD.__awaiter)(this,void 0,void 0,function(){var s,o,a,l,u,c,h,d,p,f,g,m;return(0,eD.__generator)(this,function(v){switch(v.label){case 0:if(v.trys.push([0,3,,4]),!(o=this.remoteConfigFetch))return[3,2];return[4,this.remoteConfigFetch.getRemoteConfig("analyticsSDK","browserSDK",this.config.sessionId)];case 1:o=v.sent(),v.label=2;case 2:if(s=o,this.config.loggerProvider.debug("Remote configuration:",JSON.stringify(s,null,2)),s&&"autocapture"in s){if("boolean"==typeof s.autocapture&&(this.config.autocapture=s.autocapture),"object"==typeof s.autocapture){if(a=(0,eD.__assign)({},s.autocapture),void 0===this.config.autocapture&&(this.config.autocapture=s.autocapture),"object"==typeof s.autocapture.elementInteractions&&(null==(e=s.autocapture.elementInteractions.pageUrlAllowlistRegex)?void 0:e.length)){a.elementInteractions=(0,eD.__assign)({},s.autocapture.elementInteractions),u=null!=(t=(l=a.elementInteractions).pageUrlAllowlist)?t:[],c=[];try{for(d=(h=(0,eD.__values)(s.autocapture.elementInteractions.pageUrlAllowlistRegex)).next();!d.done;d=h.next()){p=d.value;try{c.push(new RegExp(p))}catch(e){this.config.loggerProvider.warn("Invalid regex pattern: ".concat(p),e)}}}catch(e){g={error:e}}finally{try{d&&!d.done&&(m=h.return)&&m.call(h)}finally{if(g)throw g.error}}l.pageUrlAllowlist=u.concat(c),delete l.pageUrlAllowlistRegex}"boolean"==typeof this.config.autocapture&&(this.config.autocapture=(0,eD.__assign)({attribution:this.config.autocapture,fileDownloads:this.config.autocapture,formInteractions:this.config.autocapture,pageViews:this.config.autocapture,sessions:this.config.autocapture,elementInteractions:this.config.autocapture},a)),"object"==typeof this.config.autocapture&&(this.config.autocapture=(0,eD.__assign)((0,eD.__assign)({},this.config.autocapture),a))}this.config.defaultTracking=this.config.autocapture}return this.config.loggerProvider.debug("Joined configuration: ",JSON.stringify(this.config,null,2)),null!=(i=this.config).requestMetadata||(i.requestMetadata=new e9),(null==(r=this.remoteConfigFetch)?void 0:r.metrics.fetchTimeAPISuccess)&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_success",this.remoteConfigFetch.metrics.fetchTimeAPISuccess),(null==(n=this.remoteConfigFetch)?void 0:n.metrics.fetchTimeAPIFail)&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_fail",this.remoteConfigFetch.metrics.fetchTimeAPIFail),[3,4];case 3:return f=v.sent(),this.config.loggerProvider.error("Failed to fetch remote configuration because of error: ",f),[3,4];case 4:return[2,this.config]}})})},e}(),rN=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],rD="data-amp-track-",rL=["div","span","h1","h2","h3","h4","h5","h6"],rU="[Amplitude] Element Clicked",rF="[Amplitude] Element Tag",rj="[Amplitude] Element Text",rB="[Amplitude] Page URL",rq="https://app.amplitude.com",rz={US:rq,EU:"https://app.eu.amplitude.com",STAGING:"https://apps.stag2.amplitude.com"},rV=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function rW(e){return"function"==typeof e}function rG(e){return rW(null==e?void 0:e.then)}function rK(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var rY=rK(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function rZ(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var r$=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,r,n,i,s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var o=(0,eD.__values)(s),a=o.next();!a.done;a=o.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else s.remove(this);var l=this.initialTeardown;if(rW(l))try{l()}catch(e){i=e instanceof rY?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=(0,eD.__values)(u),h=c.next();!h.done;h=c.next()){var d=h.value;try{rX(d)}catch(e){i=null!=i?i:[],e instanceof rY?i=(0,eD.__spreadArray)((0,eD.__spreadArray)([],(0,eD.__read)(i)),(0,eD.__read)(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}if(i)throw new rY(i)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)rX(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!=(r=this._finalizers)?r:[]).push(e)}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&rZ(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&rZ(r,e),e instanceof t&&e._removeParent(this)},(e=new t).closed=!0,t.EMPTY=e,t}(),rH=r$.EMPTY;function rJ(e){return e instanceof r$||e&&"closed"in e&&rW(e.remove)&&rW(e.add)&&rW(e.unsubscribe)}function rX(e){rW(e)?e():e.unsubscribe()}var rQ=void 0,r0={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r0.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,eD.__spreadArray)([e,t],(0,eD.__read)(r))):setTimeout.apply(void 0,(0,eD.__spreadArray)([e,t],(0,eD.__read)(r)))},clearTimeout:function(e){var t=r0.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function r1(e){r0.setTimeout(function(){!1;throw e})}function r2(){}var r3=r4("C",void 0,void 0);function r4(e,t,r){return{kind:e,value:t,error:r}}var r5=null;function r6(e){var t,r,n,i;1;e()}var r8=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,rJ(t)&&t.add(r)):r.destination=ni,r}return(0,eD.__extends)(t,e),t.create=function(e,t,r){return new nt(e,t,r)},t.prototype.next=function(e){this.isStopped?nn(r4("N",e,void 0),this):this._next(e)},t.prototype.error=function(e){this.isStopped?nn(r4("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?nn(r3,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(r$),r9=Function.prototype.bind;function r7(e,t){return r9.call(e,t)}var ne=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){nr(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){nr(e)}else nr(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){nr(e)}},e}(),nt=function(e){function t(t,r,n){var i,s,o=e.call(this)||this;return rW(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:i=t,o.destination=new ne(i),o}return(0,eD.__extends)(t,e),t}(r8);function nr(e){1;r1(e)}function nn(e,t){}var ni={closed:!0,next:r2,error:function(e){throw e},complete:r2},ns="function"==typeof Symbol&&Symbol.observable||"@@observable";function no(e){return e}var na=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this,i=!function(e){return e&&e instanceof r8||e&&rW(e.next)&&rW(e.error)&&rW(e.complete)&&rJ(e)}(e)?new nt(e,t,r):e;return r6(function(){var e=n.operator,t=n.source;i.add(e?e.call(i,t):t?n._subscribe(i):n._trySubscribe(i))}),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=nl(t))(function(t,n){var i=new nt({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null==(t=this.source)?void 0:t.subscribe(e)},e.prototype[ns]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===e.length?no:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=nl(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();function nl(e){var t;return null!=(t=null!=e?e:rQ)?t:Promise}function nu(e){return Symbol.asyncIterator&&rW(null==e?void 0:e[Symbol.asyncIterator])}function nc(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var nh="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function nd(e){return rW(null==e?void 0:e[nh])}function np(e){return(0,eD.__asyncGenerator)(this,arguments,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,eD.__await)(t.read())];case 3:if(n=(r=i.sent()).value,!r.done)return[3,5];return[4,(0,eD.__await)(void 0)];case 4:return[2,i.sent()];case 5:return[4,(0,eD.__await)(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function nf(e){return rW(null==e?void 0:e.getReader)}function ng(e){if(e instanceof na)return e;if(null!=e){var t,r,n,i;if(rW(e[ns])){return t=e,new na(function(e){var r=t[ns]();if(rW(r.subscribe))return r.subscribe(e);throw TypeError("Provided object does not correctly implement Symbol.observable")})}if(rV(e)){return r=e,new na(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}if(rG(e)){return n=e,new na(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,r1)})}if(nu(e))return nm(e);if(nd(e)){return i=e,new na(function(e){var t,r;try{for(var n=(0,eD.__values)(i),s=n.next();!s.done;s=n.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}if(nf(e))return nm(np(e))}throw nc(e)}function nm(e){return new na(function(t){(function(e,t){var r,n,i,s;return(0,eD.__awaiter)(this,void 0,void 0,function(){var o;return(0,eD.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),r=(0,eD.__asyncValues)(e),a.label=1;case 1:return[4,r.next()];case 2:if((n=a.sent()).done)return[3,4];if(o=n.value,t.next(o),t.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i={error:a.sent()},[3,11];case 6:if(a.trys.push([6,,9,10]),!(n&&!n.done&&(s=r.return)))return[3,8];return[4,s.call(r)];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function nv(e){return function(t){if(rW(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}function ny(e,t,r,n,i){return new nb(e,t,r,n,i)}var nb=function(e){function t(t,r,n,i,s,o){var a=e.call(this,t)||this;return a.onFinalize=s,a.shouldUnsubscribe=o,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,eD.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),r||null==(t=this.onFinalize)||t.call(this)}},t}(r8);function nw(e,t){return nv(function(r,n){var i=0;r.subscribe(ny(n,function(r){n.next(e.call(t,r,i++))}))})}function n_(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var s=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(s),!i)return s}function nS(e,t,r){return(void 0===r&&(r=1/0),rW(t))?nS(function(r,n){return nw(function(e,i){return t(r,e,n,i)})(ng(e(r,n)))},r):("number"==typeof t&&(r=t),nv(function(t,n){var i,s,o,a,l,u,c,h;return i=r,s=[],o=0,a=0,l=!1,u=function(){!l||s.length||o||n.complete()},c=function(e){return o<i?h(e):s.push(e)},h=function(t){o++;var r=!1;ng(e(t,a++)).subscribe(ny(n,function(e){n.next(e)},function(){r=!0},void 0,function(){if(r)try{for(o--;s.length&&o<i;)!function(){var e=s.shift();h(e)}();u()}catch(e){n.error(e)}}))},t.subscribe(ny(n,c,function(){l=!0,u()})),function(){}}))}var nI=Array.isArray,nC=["addListener","removeListener"],nE=["addEventListener","removeEventListener"],nk=["on","off"];function nx(e,t,r,n){if(rW(r)&&(n=r,r=void 0),n){return nx(e,t,r).pipe((i=n,nw(function(e){return nI(e)?i.apply(void 0,(0,eD.__spreadArray)([],(0,eD.__read)(e))):i(e)})))}var i,s,o,a,l=(0,eD.__read)(rW((s=e).addEventListener)&&rW(s.removeEventListener)?nE.map(function(n){return function(i){return e[n](t,i,r)}}):rW((o=e).addListener)&&rW(o.removeListener)?nC.map(nO(e,t)):rW((a=e).on)&&rW(a.off)?nk.map(nO(e,t)):[],2),u=l[0],c=l[1];if(!u&&rV(e))return nS(function(e){return nx(e,t,r)})(ng(e));if(!u)throw TypeError("Invalid event target");return new na(function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return u(t),function(){return c(t)}})}function nO(e,t){return function(r){return function(n){return e[r](t,n)}}}var nR=rK(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),nT=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,eD.__extends)(t,e),t.prototype.lift=function(e){var t=new nA(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new nR},t.prototype.next=function(e){var t=this;r6(function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,eD.__values)(t.currentObservers),s=i.next();!s.done;s=i.next())s.value.next(e)}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}})},t.prototype.error=function(e){var t=this;r6(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}})},t.prototype.complete=function(){var e=this;r6(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null==(e=this.observers)?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this.hasError,n=this.isStopped,i=this.observers;return r||n?rH:(this.currentObservers=null,i.push(e),new r$(function(){t.currentObservers=null,rZ(i,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,r=this.thrownError,n=this.isStopped;t?e.error(r):n&&e.complete()},t.prototype.asObservable=function(){var e=new na;return e.source=this,e},t.create=function(e,t){return new nA(e,t)},t}(na),nA=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,eD.__extends)(t,e),t.prototype.next=function(e){var t,r;null==(r=null==(t=this.destination)?void 0:t.next)||r.call(t,e)},t.prototype.error=function(e){var t,r;null==(r=null==(t=this.destination)?void 0:t.error)||r.call(t,e)},t.prototype.complete=function(){var e,t;null==(t=null==(e=this.destination)?void 0:e.complete)||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!=(r=null==(t=this.source)?void 0:t.subscribe(e))?r:rH},t}(nT);function nM(e){void 0===e&&(e={});var t=e.connector,r=void 0===t?function(){return new nT}:t,n=e.resetOnError,i=void 0===n||n,s=e.resetOnComplete,o=void 0===s||s,a=e.resetOnRefCountZero,l=void 0===a||a;return function(e){var t,n,s,a=0,u=!1,c=!1,h=function(){null==n||n.unsubscribe(),n=void 0},d=function(){h(),t=s=void 0,u=c=!1},p=function(){var e=t;d(),null==e||e.unsubscribe()};return nv(function(e,f){a++,c||u||h();var g=s=null!=s?s:r();f.add(function(){0!=--a||c||u||(n=nP(p,l))}),g.subscribe(f),!t&&a>0&&(t=new nt({next:function(e){return g.next(e)},error:function(e){c=!0,h(),n=nP(d,i,e),g.error(e)},complete:function(){u=!0,h(),n=nP(d,o),g.complete()}}),ng(e).subscribe(t))})(e)}}function nP(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!0===t)return void e();if(!1!==t){var i=new nt({next:function(){i.unsubscribe(),e()}});return ng(t.apply(void 0,(0,eD.__spreadArray)([],(0,eD.__read)(r)))).subscribe(i)}}var nN=["input","select","textarea"],nD=function(e,t){return function(r,n){var i,s,o,a=e.pageUrlAllowlist,l=e.shouldTrackEventResolver,u=null==(s=null==(i=null==n?void 0:n.tagName)?void 0:i.toLowerCase)?void 0:s.call(i);if(!u)return!1;if(l)return l(r,n);if(!nj(window.location.href,a))return!1;var c=String(null==n?void 0:n.getAttribute("type"))||"";if("string"==typeof c)switch(c.toLowerCase()){case"hidden":case"password":return!1}if(t&&!t.some(function(e){var t;return!!(null==(t=null==n?void 0:n.matches)?void 0:t.call(n,e))}))return!1;switch(u){case"input":case"select":case"textarea":return"change"===r||"click"===r;default:var h=null==(o=null==window?void 0:window.getComputedStyle)?void 0:o.call(window,n);if(h&&"pointer"===h.getPropertyValue("cursor")&&"click"===r)return!0;return"click"===r}}},nL=function(e){if(null==e)return!1;if("string"==typeof e&&(/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((e||"").replace(/[- ]/g,""))||/(^\d{3}-?\d{2}-?\d{4}$)/.test(e)))return!1;return!0},nU=function(e){var t,r,n,i=null==(r=null==(t=null==e?void 0:e.tagName)?void 0:t.toLowerCase)?void 0:r.call(t),s=e instanceof HTMLElement&&(null==(n=e.getAttribute("contenteditable"))?void 0:n.toLowerCase())==="true";return!nN.includes(i)&&!s},nF=function(e){var t="";return nU(e)&&e.childNodes&&e.childNodes.length&&e.childNodes.forEach(function(e){var r="";e&&3===e.nodeType?e.textContent&&(r=e.textContent):r=nF(e),t+=r.split(/(\s+)/).filter(nL).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}),t},nj=function(e,t){return!t||!t.length||t.some(function(t){return"string"==typeof t?e===t:e.match(t)})},nB=function(e){return Object.keys(e).reduce(function(t,r){var n=e[r];return null!=n&&("object"!=typeof n||0!==Object.keys(n).length)&&("string"!=typeof n||0!==n.trim().length)&&(t[r]=n),t},{})},nq=function(e){var t,r=e.parentElement;if(!r)return"";try{t=r.querySelector(":scope>span,h1,h2,h3,h4,h5,h6")}catch(e){t=null}if(t){var n=t.textContent||"";return nL(n)?n:""}return nq(r)},nz=function(e,t){return e?t.some(function(t){var r;return null==(r=null==e?void 0:e.matches)?void 0:r.call(e,t)})?e:nz(null==e?void 0:e.parentElement,t):null},nV=function(e){if(!e)return{};var t,r,n,i=null==(n=null==(r=null==e?void 0:e.tagName)?void 0:r.toLowerCase)?void 0:n.call(r);return nB(((t={})[rF]=i,t[rj]=nF(e),t[rB]=window.location.href.split("?")[0],t))},nW=function(e){return null!==e.event.target&&!!e.closestTrackedAncestor},nG=function(){function e(e){var t=(void 0===e?{}:e).origin,r=this;this.endpoint=rq,this.requestCallbacks={},this.onSelect=function(e){r.notify({action:"element-selected",data:e})},this.onTrack=function(e,t){"selector-mode-changed"===e?r.notify({action:"track-selector-mode-changed",data:t}):"selector-moved"===e&&r.notify({action:"track-selector-moved",data:t})},this.endpoint=void 0===t?rq:t}return e.prototype.notify=function(e){var t,r,n,i;null==(r=null==(t=this.logger)?void 0:t.debug)||r.call(t,"Message sent: ",JSON.stringify(e)),null==(i=null==(n=window.opener)?void 0:n.postMessage)||i.call(n,e,this.endpoint)},e.prototype.sendRequest=function(e,t,r){var n=this;void 0===r&&(r={timeout:15e3});var i="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),s={id:i,action:e,args:t};return new Promise(function(t,o){n.requestCallbacks[i]={resolve:t,reject:o},n.notify(s),(null==r?void 0:r.timeout)>0&&setTimeout(function(){o(Error("".concat(e," timed out (id: ").concat(i,")"))),delete n.requestCallbacks[i]},r.timeout)})},e.prototype.handleResponse=function(e){var t;if(!this.requestCallbacks[e.id]){null==(t=this.logger)||t.warn("No callback found for request id: ".concat(e.id));return}this.requestCallbacks[e.id].resolve(e.responseData),delete this.requestCallbacks[e.id]},e.prototype.setup=function(e){var t=this,r=void 0===e?{}:e,n=r.logger,i=r.endpoint,s=r.isElementSelectable,o=r.cssSelectorAllowlist,a=r.actionClickAllowlist;this.logger=n,i&&this.endpoint===rq&&(this.endpoint=i);var l=null;window.addEventListener("message",function(e){if(null==(n=null==(r=t.logger)?void 0:r.debug)||n.call(r,"Message received: ",JSON.stringify(e)),t.endpoint===e.origin){var r,n,i,u,c,h=null==e?void 0:e.data,d=null==h?void 0:h.action;if(d)if("id"in h)null==(u=null==(i=t.logger)?void 0:i.debug)||u.call(i,"Received Response to previous request: ",JSON.stringify(e)),t.handleResponse(h);else if("ping"===d)t.notify({action:"pong"});else if("initialize-visual-tagging-selector"===d){var p,f=null==h?void 0:h.data;(p="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",new Promise(function(e,t){var r;try{var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=p,n.addEventListener("load",function(){e({status:!0})},{once:!0}),n.addEventListener("error",function(){t({status:!1,message:"Failed to load the script ".concat(p)})}),null==(r=document.head)||r.appendChild(n)}catch(e){t(e)}})).then(function(){var e;l=null==(e=null==window?void 0:window.amplitudeVisualTaggingSelector)?void 0:e.call(window,{getEventTagProps:nV,isElementSelectable:function(e){return!s||s((null==f?void 0:f.actionType)||"click",e)},onTrack:t.onTrack,onSelect:t.onSelect,visualHighlightClass:"amp-visual-tagging-selector-highlight",messenger:t,cssSelectorAllowlist:o,actionClickAllowlist:a}),t.notify({action:"selector-loaded"})}).catch(function(){var e;null==(e=t.logger)||e.warn("Failed to initialize visual tagging selector")})}else"close-visual-tagging-selector"===d&&(null==(c=null==l?void 0:l.close)||c.call(l))}}),this.notify({action:"page-loaded"})},e}(),nK=["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot"],nY=["type"],nZ=["svg","path","g"],n$=["password","hidden"],nH=function(e){return e?function(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];if(null===i)r+=4;else{var s=function e(t,r){void 0===r&&(r=!1);try{if(null==t){if(r)return"None";return null}if("string"==typeof t){if(r){if((t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")).includes('"'))return"'".concat(t,"'");if(t.includes("'"))return'"'.concat(t.replace(/'/g,"\\'"),'"');return"'".concat(t,"'")}return t}if("boolean"==typeof t)return t?"True":"False";else if(Array.isArray(t)){var n=t.map(function(t){return e(t,!0)});return"[".concat(n.join(", "),"]")}else if("object"==typeof t){var i=Object.entries(t).filter(function(e){var t=(0,eD.__read)(e,1)[0];return null!=t}).map(function(t){var r=(0,eD.__read)(t,2),n=r[0],i=r[1];return"".concat(String(e(n,!0)),": ").concat(String(e(i,!0)))}),s="{".concat(i.join(", "),"}");return s.includes("\\'")&&(s=s.replace(/'/g,"'").replace(/'/g,"\\'")),s}return t.toString()}catch(e){return null}}(i);r+=s?Array.from(s).length:4}if(r>1024)return e.slice(0,n)}return e}((function(e){var t=[];if(!e)return t;t.push(e);for(var r=e.parentElement;r&&"HTML"!==r.tagName;)t.push(r),r=r.parentElement;return t})(e).map(function(e){return function(e){if(null===e)return null;var t,r,n,i,s,o,a=String(e.tagName).toLowerCase(),l={tag:a},u=Array.from(null!=(i=null==(n=e.parentElement)?void 0:n.children)?i:[]);u.length&&(l.index=u.indexOf(e),l.indexOfType=u.filter(function(t){return t.tagName===e.tagName}).indexOf(e));var c=null==(o=null==(s=e.previousElementSibling)?void 0:s.tagName)?void 0:o.toLowerCase();c&&(l.prevSib=String(c));var h=e.getAttribute("id");h&&(l.id=String(h));var d=Array.from(e.classList);d.length&&(l.classes=d);var p={},f=Array.from(e.attributes).filter(function(e){return!nK.includes(e.name)}),g=!nU(e);if(!n$.includes(String(e.getAttribute("type")))&&!nZ.includes(a))try{for(var m=(0,eD.__values)(f),v=m.next();!v.done;v=m.next()){var y=v.value;(!g||nY.includes(y.name))&&(p[y.name]=String(y.value).substring(0,128))}}catch(e){t={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(t)throw t.error}}return Object.keys(p).length&&(l.attrs=p),l}(e)}),1024):[]};function nJ(e,t){return nv(function(r,n){var i=0;r.subscribe(ny(n,function(r){return e.call(t,r,i++)&&n.next(r)}))})}var nX=function(e){function t(t,r){return e.call(this)||this}return(0,eD.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(r$),nQ={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=nQ.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,(0,eD.__spreadArray)([e,t],(0,eD.__read)(r))):setInterval.apply(void 0,(0,eD.__spreadArray)([e,t],(0,eD.__read)(r)))},clearInterval:function(e){var t=nQ.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},n0=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,eD.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r,n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=null!=(r=this.id)?r:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),nQ.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&nQ.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,rZ(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(nX),n1={now:function(){return(n1.delegate||Date).now()},delegate:void 0},n2=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=n1.now,e}(),n3=new(function(e){function t(t,r){void 0===r&&(r=n2.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,eD.__extends)(t,e),t.prototype.flush=function(e){var t,r=this.actions;if(this._active)return void r.push(e);this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=r.shift())if(this._active=!1,t){for(;e=r.shift();)e.unsubscribe();throw t}},t}(n2))(n0);function n4(e){return void 0===e&&(e=1/0),nS(no,e)}var n5=new na(function(e){return e.complete()});function n6(e){return e&&rW(e.schedule)}function n8(e){return e[e.length-1]}function n9(e){return n6(n8(e))?e.pop():void 0}function n7(e,t){return void 0===t&&(t=0),nv(function(r,n){r.subscribe(ny(n,function(r){return n_(n,e,function(){return n.next(r)},t)},function(){return n_(n,e,function(){return n.complete()},t)},function(r){return n_(n,e,function(){return n.error(r)},t)}))})}function ie(e,t){return void 0===t&&(t=0),nv(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function it(e,t){if(!e)throw Error("Iterable cannot be null");return new na(function(r){n_(r,t,function(){var n=e[Symbol.asyncIterator]();n_(r,t,function(){n.next().then(function(e){e.done?r.complete():r.next(e.value)})},0,!0)})})}function ir(e,t){return t?function(e,t){if(null!=e){if(rW(e[ns]))return ng(e).pipe(ie(t),n7(t));if(rV(e))return new na(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})});if(rG(e))return ng(e).pipe(ie(t),n7(t));if(nu(e))return it(e,t);if(nd(e))return new na(function(r){var n;return n_(r,t,function(){n=e[nh](),n_(r,t,function(){var e,t,i;try{t=(e=n.next()).value,i=e.done}catch(e){r.error(e);return}i?r.complete():r.next(t)},0,!0)}),function(){return rW(null==n?void 0:n.return)&&n.return()}});if(nf(e))return it(np(e),t)}throw nc(e)}(e,t):ng(e)}function ii(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=n9(t),i=(e=1/0,"number"==typeof n8(t)?t.pop():e);return t.length?1===t.length?ng(t[0]):n4(i)(ir(t,n)):n5}function is(e){return e<=0?function(){return n5}:nv(function(t,r){var n=0;t.subscribe(ny(r,function(t){++n<=e&&(r.next(t),e<=n&&r.complete())}))})}function io(e){return e instanceof Date&&!isNaN(e)}var ia=rK(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function il(e){throw new ia(e)}(F=eI||(eI={})).ClickObservable="clickObservable",F.ChangeObservable="changeObservable",F.NavigateObservable="navigateObservable",F.MutationObservable="mutationObservable";var iu=function(e){void 0===e&&(e={});var t,r,n,i=e.dataAttributePrefix,s=void 0===i?rD:i,o=e.visualTaggingOptions,a=void 0===o?{enabled:!0,messenger:new nG}:o;e.cssSelectorAllowlist=null!=(t=e.cssSelectorAllowlist)?t:rN,e.actionClickAllowlist=null!=(r=e.actionClickAllowlist)?r:rL,e.debounceTime=null!=(n=e.debounceTime)?n:0;var l="@amplitude/plugin-autocapture-browser",u=[],c=function(){var e,t,r=nx(document,"click",{capture:!0}).pipe(nw(function(e){return d(e,"click")}),nM()),n=nx(document,"change",{capture:!0}).pipe(nw(function(e){return d(e,"change")}),nM());window.navigation&&(t=nx(window.navigation,"navigate").pipe(nw(function(e){return d(e,"navigate")}),nM()));var i=new na(function(e){var t=new MutationObserver(function(t){e.next(t)});return t.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return t.disconnect()}}).pipe(nw(function(e){return d(e,"mutation")}),nM());return(e={})[eI.ClickObservable]=r,e[eI.ChangeObservable]=n,e[eI.NavigateObservable]=t,e[eI.MutationObservable]=i,e},h=function(e,t){var r,n,i,o=null==(i=null==(n=null==t?void 0:t.tagName)?void 0:n.toLowerCase)?void 0:i.call(n),a="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:null,top:null},l=t.getAttribute("aria-label"),u=t.getAttributeNames().reduce(function(e,r){if(r.startsWith(s)){var n=r.replace(s,""),i=t.getAttribute(r);n&&(e[n]=i||"")}return e},{}),c=nq(t),h=((r={})["[Amplitude] Element ID"]=t.getAttribute("id")||"",r["[Amplitude] Element Class"]=t.getAttribute("class"),r["[Amplitude] Element Hierarchy"]=nH(t),r[rF]=o,r[rj]=nF(t),r["[Amplitude] Element Position Left"]=null==a.left?null:Math.round(a.left),r["[Amplitude] Element Position Top"]=null==a.top?null:Math.round(a.top),r["[Amplitude] Element Aria Label"]=l,r["[Amplitude] Element Attributes"]=u,r["[Amplitude] Element Parent Label"]=c,r[rB]=window.location.href.split("?")[0],r["[Amplitude] Page Title"]="undefined"!=typeof document&&document.title||"",r["[Amplitude] Viewport Height"]=window.innerHeight,r["[Amplitude] Viewport Width"]=window.innerWidth,r);return"a"===o&&"click"===e&&t instanceof HTMLAnchorElement&&(h["[Amplitude] Element Href"]=t.href),nB(h)},d=function(t,r){var n={event:t,timestamp:Date.now(),type:r};if(("click"===n.type||"change"===n.type)&&null!==n.event.target){var i=nz(n.event.target,e.cssSelectorAllowlist);i&&(n.closestTrackedAncestor=i,n.targetElementProperties=h(n.type,i))}return n};return{name:l,type:"enrichment",setup:function(t,r){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var n,i,s,o,d,p,f,g,m,v;return(0,eD.__generator)(this,function(y){var b,w,_,S,I,C,E,k,x,O,R,T,A,M,P,N,D,L,U,F,j,B,q,z,V,W,G,K,Y,Z,$,H,J,X;return"undefined"==typeof document?[2]:(n=nD(e,e.cssSelectorAllowlist),i=nD(e,e.actionClickAllowlist),w=(b={allObservables:s=c(),options:e,amplitude:r,shouldTrackEvent:n}).amplitude,_=b.allObservables,S=b.options,I=b.shouldTrackEvent,x=ii((C=_.clickObservable).pipe(nv(function(e,t){var r,n=!1;e.subscribe(ny(t,function(e){var i=r;r=e,n&&t.next([i,e]),n=!0}))}),nJ(function(e){var t=(0,eD.__read)(e,2),r=t[0],n=t[1],i=r.event.target!==n.event.target,s=20>=Math.abs(n.event.screenX-r.event.screenX)&&20>=Math.abs(n.event.screenY-r.event.screenY);return i&&!s})),C.pipe((E=S.debounceTime,void 0===k&&(k=n3),nv(function(e,t){var r=null,n=null,i=null,s=function(){if(r){r.unsubscribe(),r=null;var e=n;n=null,t.next(e)}};function o(){var e=i+E,n=k.now();if(n<e){r=this.schedule(void 0,e-n),t.add(r);return}s()}e.subscribe(ny(t,function(e){n=e,i=k.now(),r||(r=k.schedule(o,E),t.add(r))},function(){s(),t.complete()},void 0,function(){n=r=null}))})),nw(function(){return"timeout"}))),o=C.pipe((void 0===O&&(O=n3),R=0,T=O,void 0===R&&(R=0),void 0===A&&(A=n3),M=-1,null!=T&&(n6(T)?A=T:M=T),P=new na(function(e){var t=io(R)?R-A.now():R;t<0&&(t=0);var r=0;return A.schedule(function(){e.closed||(e.next(r++),0<=M?this.schedule(void 0,M):e.complete())},t)}),function e(t,r){return r?function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n4(1)(ir(e,n9(e)))}(r.pipe(is(1),nv(function(e,t){e.subscribe(ny(t,r2))})),n.pipe(e(t)))}:nS(function(e,r){return ng(t(e,r)).pipe(is(1),nw(function(){return e}))})}(function(){return P})),nJ(nW),nJ(function(e){return I("click",e.closestTrackedAncestor)}),nv(function(e,t){var r=[];return e.subscribe(ny(t,function(e){return r.push(e)},function(){t.next(r),t.complete()})),ng(x).subscribe(ny(t,function(){var e=r;r=[],t.next(e)},r2)),function(){r=null}})).subscribe(function(e){var t,r,n=(e.length,rU);try{for(var i=(0,eD.__values)(e),s=i.next();!s.done;s=i.next()){var o=s.value;null==w||w.track(n,o.targetElementProperties)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}),u.push(o),D=(N={allObservables:s,getEventProperties:h,amplitude:r,shouldTrackEvent:n}).amplitude,L=N.allObservables,U=N.getEventProperties,F=N.shouldTrackEvent,d=L.changeObservable.pipe(nJ(nW),nJ(function(e){return F("change",e.closestTrackedAncestor)})).subscribe(function(e){null==D||D.track("[Amplitude] Element Changed",U("change",e.closestTrackedAncestor))}),u.push(d),B=(j={allObservables:s,options:e,getEventProperties:h,amplitude:r,shouldTrackEvent:n,shouldTrackActionClick:i}).amplitude,q=j.allObservables,z=j.options,V=j.getEventProperties,W=j.shouldTrackEvent,G=j.shouldTrackActionClick,K=q.clickObservable,Y=q.mutationObservable,Z=q.navigateObservable,$=K.pipe(nJ(function(e){return!W("click",e.closestTrackedAncestor)}),nw(function(e){var t=nz(e.event.target,z.actionClickAllowlist);return e.closestTrackedAncestor=t,null!==e.closestTrackedAncestor&&(e.targetElementProperties=V(e.type,e.closestTrackedAncestor)),e}),nJ(nW),nJ(function(e){return G("click",e.closestTrackedAncestor)})),H=[Y],Z&&H.push(Z),J=ii.apply(void 0,(0,eD.__spreadArray)([],(0,eD.__read)(H),!1)),p=$.pipe((X=function(e){return J.pipe(is(1),function(e,t){var r=io(e)?{first:e}:"number"==typeof e?{each:e}:e,n=r.first,i=r.each,s=r.with,o=void 0===s?il:s,a=r.scheduler,l=void 0===a?n3:a,u=r.meta,c=void 0===u?null:u;if(null==n&&null==i)throw TypeError("No timeout provided.");return nv(function(e,t){var r,s,a=null,u=0,h=function(e){s=n_(t,l,function(){try{r.unsubscribe(),ng(o({meta:c,lastValue:a,seen:u})).subscribe(t)}catch(e){t.error(e)}},e)};r=e.subscribe(ny(t,function(e){null==s||s.unsubscribe(),u++,t.next(a=e),i>0&&h(i)},void 0,void 0,function(){(null==s?void 0:s.closed)||null==s||s.unsubscribe(),a=null})),u||h(null!=n?"number"==typeof n?n:n-l.now():i)})}({first:500,with:function(){return n5}}),nw(function(){return e}))},nv(function(e,t){var r=null,n=0,i=!1,s=function(){return i&&!r&&t.complete()};e.subscribe(ny(t,function(e){null==r||r.unsubscribe(),ng(X(e,n++)).subscribe(r=ny(t,function(e){return t.next(e)},function(){r=null,s()}))},function(){i=!0,s()}))}))).subscribe(function(e){null==B||B.track(rU,V("click",e.closestTrackedAncestor))}),u.push(p),null==(m=null==t?void 0:t.loggerProvider)||m.log("".concat(l," has been successfully added.")),window.opener&&a.enabled&&(f=e.cssSelectorAllowlist,g=e.actionClickAllowlist,null==(v=a.messenger)||v.setup((0,eD.__assign)((0,eD.__assign)({logger:null==t?void 0:t.loggerProvider},(null==t?void 0:t.serverZone)&&{endpoint:rz[t.serverZone]}),{isElementSelectable:nD(e,(0,eD.__spreadArray)((0,eD.__spreadArray)([],(0,eD.__read)(f),!1),(0,eD.__read)(g),!1)),cssSelectorAllowlist:f,actionClickAllowlist:g}))),[2])})})},execute:function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,n;return(0,eD.__generator)(this,function(i){try{for(t=(e=(0,eD.__values)(u)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){r={error:e}}finally{try{t&&!t.done&&(n=e.return)&&n.call(e)}finally{if(r)throw r.error}}return[2]})})}}},ic=function(){function e(e){this.request=e}return Object.defineProperty(e.prototype,"headers",{get:function(){if(this._headers)return this._headers;var e=this.request.headers;if(Array.isArray(e))this._headers=e.reduce(function(e,t){var r=(0,eD.__read)(t,2),n=r[0],i=r[1];return e[n]=i,e},{});else if(e instanceof Headers){var t={};e.forEach(function(e,r){t[r]=e}),this._headers=t}else"object"==typeof e&&(this._headers=e);return this._headers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodySize",{get:function(){if("number"==typeof this._bodySize)return this._bodySize;var e=eY();if(null==e?void 0:e.TextEncoder){var t=this.request.body;return this._bodySize=id(t,100),this._bodySize}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this.request.method},enumerable:!1,configurable:!0}),e}(),ih=function(){function e(e){this.body=e}return Object.defineProperty(e.prototype,"bodySize",{get:function(){return id(this.body,100)},enumerable:!1,configurable:!0}),e}();function id(e,t){var r,n,i,s,o=eY(),a=null==o?void 0:o.TextEncoder;if(a){if("string"==typeof e)s=e,i=new a().encode(s).length;else if(e instanceof Blob)i=(s=e).size;else if(e instanceof URLSearchParams)s=e,i=new a().encode(s.toString()).length;else if(ArrayBuffer.isView(e))i=(s=e).byteLength;else if(e instanceof ArrayBuffer)i=(s=e).byteLength;else if(e instanceof FormData){var l=0,u=0;try{for(var c=(0,eD.__values)(e.entries()),h=c.next();!h.done;h=c.next()){var d=(0,eD.__read)(h.value,2),p=d[0],f=d[1];if(l+=p.length,"string"==typeof f)l+=new a().encode(f).length;else{if(!(f instanceof Blob))return;l+=f.size}if(++u>=t)return}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}i=l}else if(e instanceof ReadableStream){s=e;return}return i}}var ip=function(){function e(e){this.response=e}return Object.defineProperty(e.prototype,"headers",{get:function(){var e;if(this._headers)return this._headers;if(this.response.headers instanceof Headers){var t=this.response.headers,r={};return null==(e=null==t?void 0:t.forEach)||e.call(t,function(e,t){r[t]=e}),this._headers=r,r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodySize",{get:function(){if(void 0!==this._bodySize)return this._bodySize;var e,t,r=null==(t=null==(e=this.response.headers)?void 0:e.get)?void 0:t.call(e,"content-length"),n=r?parseInt(r,10):void 0;return this._bodySize=n,n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.response.status},enumerable:!1,configurable:!0}),e}(),ig=function(){function e(e,t,r){this.statusCode=e,this.headersString=t,this.size=r}return Object.defineProperty(e.prototype,"bodySize",{get:function(){return this.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.statusCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){if(this.headersString){var e,t,r={},n=this.headersString.split("\r\n");try{for(var i=(0,eD.__values)(n),s=i.next();!s.done;s=i.next()){var o=s.value,a=(0,eD.__read)(o.split(": "),2),l=a[0],u=a[1];l&&u&&(r[l]=u)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}},enumerable:!1,configurable:!0}),e}(),im=function(){function e(e,t,r,n,i,s,o,a,l,u,c){void 0===o&&(o=0),this.type=e,this.method=t,this.timestamp=r,this.startTime=n,this.url=i,this.requestWrapper=s,this.status=o,this.duration=a,this.responseWrapper=l,this.error=u,this.endTime=c}return e.prototype.toSerializable=function(){var e,t,r,n;return Object.fromEntries(Object.entries({type:this.type,method:this.method,url:this.url,timestamp:this.timestamp,status:this.status,duration:this.duration,error:this.error,startTime:this.startTime,endTime:this.endTime,requestHeaders:null==(e=this.requestWrapper)?void 0:e.headers,requestBodySize:null==(t=this.requestWrapper)?void 0:t.bodySize,responseHeaders:null==(r=this.responseWrapper)?void 0:r.headers,responseBodySize:null==(n=this.responseWrapper)?void 0:n.bodySize}).filter(function(e){var t=(0,eD.__read)(e,2);return void 0!==(t[0],t[1])}))},e}(),iv=function(e,t){void 0===t&&(t=e$()),this.callback=e,this.id=t},iy=new(function(){function e(t){this.eventCallbacks=new Map,this.isObserving=!1,this.logger=t;var r=eY();e.isSupported()&&(this.globalScope=r)}return e.isSupported=function(){var e=eY();return!!e&&!!e.fetch},e.prototype.subscribe=function(e,t){var r,n,i,s,o,a,l;if(this.logger||(this.logger=t),this.eventCallbacks.set(e.id,e),!this.isObserving){var u=null==(i=null==(n=null==(r=this.globalScope)?void 0:r.XMLHttpRequest)?void 0:n.prototype)?void 0:i.open,c=null==(a=null==(o=null==(s=this.globalScope)?void 0:s.XMLHttpRequest)?void 0:o.prototype)?void 0:a.send;u&&c&&this.observeXhr(u,c);var h=null==(l=this.globalScope)?void 0:l.fetch;h&&this.observeFetch(h),this.isObserving=!0}},e.prototype.unsubscribe=function(e){this.eventCallbacks.delete(e.id)},e.prototype.triggerEventCallbacks=function(e){var t=this;this.eventCallbacks.forEach(function(r){var n;try{r.callback(e)}catch(e){null==(n=t.logger)||n.debug("an unexpected error occurred while triggering event callbacks",e)}})},e.prototype.handleNetworkRequestEvent=function(e,t,r,n,i,s,o){if(void 0!==s&&void 0!==o){var a,l,u,c,h="GET";"object"==typeof t&&null!==t&&"url"in t&&"method"in t?(l=t.url,h=t.method):l=null==(a=null==t?void 0:t.toString)?void 0:a.call(t),h=(null==r?void 0:r.method)||h,n&&(u=n.status),i&&(c={name:i.name||"UnknownError",message:i.message||"An unknown error occurred"},u=0);var d=Math.floor(performance.now()-o),p=Math.floor(s+d),f=new im(e,h,s,s,l,r,u,d,n,c,p);this.triggerEventCallbacks(f)}},e.prototype.getTimestamps=function(){var e,t;return{startTime:null==(e=Date.now)?void 0:e.call(Date),durationStart:null==(t=null==performance?void 0:performance.now)?void 0:t.call(performance)}},e.prototype.observeFetch=function(e){var t=this;this.globalScope&&e&&(this.globalScope.fetch=function(r,n){return(0,eD.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,a;return(0,eD.__generator)(this,function(l){switch(l.label){case 0:try{t=this.getTimestamps()}catch(e){null==(o=this.logger)||o.debug("an unexpected error occurred while retrieving timestamps",e)}l.label=1;case 1:return l.trys.push([1,3,,4]),[4,e(r,n)];case 2:return i=l.sent(),[3,4];case 3:return s=l.sent(),[3,4];case 4:try{this.handleNetworkRequestEvent("fetch",r,n?new ic(n):void 0,i?new ip(i):void 0,s,null==t?void 0:t.startTime,null==t?void 0:t.durationStart)}catch(e){null==(a=this.logger)||a.debug("an unexpected error occurred while handling fetch",e)}if(i)return[2,i];throw s}})})})},e.prototype.observeXhr=function(e,t){if(this.globalScope&&e&&t){var r=this.globalScope.XMLHttpRequest.prototype,n=this;r.open=function(){for(var t,r,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var o=(0,eD.__read)(i,2),a=o[0],l=o[1];try{this.$$AmplitudeAnalyticsEvent=(0,eD.__assign)({method:a,url:null==(t=null==l?void 0:l.toString)?void 0:t.call(l)},n.getTimestamps())}catch(e){null==(r=n.logger)||r.debug("an unexpected error occurred while calling xhr open",e)}return e.apply(this,i)},r.send=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this,s=e[0],o=i.$$AmplitudeAnalyticsEvent;return i.addEventListener("loadend",function(){var e;try{var t=i.getAllResponseHeaders(),r=i.getResponseHeader("content-length"),a=new ig(i.status,t,r?parseInt(r,10):void 0),l=new ih(s);o.status=i.status,n.handleNetworkRequestEvent("xhr",{url:o.url,method:o.method},l,a,void 0,o.startTime,o.durationStart)}catch(t){null==(e=n.logger)||e.debug("an unexpected error occurred while handling xhr send",t)}}),t.apply(i,e)}}},e}()),ib="500-599";function iw(e,t){return RegExp("^"+t.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".*")+"$").test(e)}function i_(e,t){var r,n,i=t.split(",");try{for(var s=(0,eD.__values)(i),o=s.next();!o.done;o=s.next()){var a=o.value,l=(0,eD.__read)(a.split("-").map(Number),2),u=l[0],c=l[1];if(e===u&&void 0===c||e>=u&&e<=c)return!0}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1}function iS(e){var t;if(e)try{var r=null==(t=eY())?void 0:t.location.href,n=new URL(e,r),i=n.searchParams.toString(),s=n.hash.replace("#",""),o=n.href,a=n.host;n.hash="",n.search="";var l=n.href;return{query:i,fragment:s,href:o,hrefWithoutQueryOrHash:l,host:a}}catch(e){return}}(eC||(eC={})).NetworkObservable="networkObservable";var iI=function(e){void 0===e&&(e={});var t,r="@amplitude/plugin-network-capture-browser",n=[],i=function(){var e,r=new na(function(e){var r=new iv(function(t){var r={event:t,timestamp:Date.now(),type:"network"};e.next(r)});return iy.subscribe(r,t),function(){iy.unsubscribe(r)}});return(e={})[eC.NetworkObservable]=r,e};return{name:r,type:"enrichment",setup:function(s,o){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var a;return(0,eD.__generator)(this,function(l){var u,c,h,d;return"undefined"==typeof document?[2]:(c=(u={allObservables:i(),networkTrackingOptions:e,amplitude:o}).allObservables,h=u.networkTrackingOptions,d=u.amplitude,a=c.networkObservable.pipe(nJ(function(e){return function(e,t){void 0===t&&(t={});var r,n,i=iS(e.url);if(!i)return!1;var s=i.host;return!(!1!==t.ignoreAmplitudeRequests&&(iw(s,"*.amplitude.com")||iw(s,"amplitude.com"))||(null==(r=t.ignoreHosts)?void 0:r.find(function(e){return iw(s,e)})))&&(!!t.captureRules||void 0===e.status||!!i_(e.status,ib))&&(!t.captureRules||((0,eD.__spreadArray)([],(0,eD.__read)(t.captureRules),!1).reverse().find(function(t){return void 0!==(n=function(e,t,r){if(!e.hosts||e.hosts.find(function(e){return iw(t,e)}))return(!r&&0!==r||!!i_(r,e.statusCodeRange||ib))&&!0}(t,s,e.status))}),!!n))&&!0}(e.event,h)})).subscribe(function(e){var t,r,n,i=e.event,s=iS(i.url);if(s){var o=null==(r=i.responseWrapper)?void 0:r.bodySize,a=null==(n=i.requestWrapper)?void 0:n.bodySize,l=((t={})["[Amplitude] URL"]=s.hrefWithoutQueryOrHash,t["[Amplitude] URL Query"]=s.query,t["[Amplitude] URL Fragment"]=s.fragment,t["[Amplitude] Request Method"]=i.method,t["[Amplitude] Status Code"]=i.status,t["[Amplitude] Start Time"]=i.startTime,t["[Amplitude] Completion Time"]=i.endTime,t["[Amplitude] Duration"]=i.duration,t["[Amplitude] Request Body Size"]=a,t["[Amplitude] Response Body Size"]=o,t["[Amplitude] Request Type"]=i.type,t);null==d||d.track("[Amplitude] Network Request",l)}}),n.push(a),null==(t=null==s?void 0:s.loggerProvider)||t.log("".concat(r," has been successfully added.")),[2])})})},execute:function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,i;return(0,eD.__generator)(this,function(s){try{for(t=(e=(0,eD.__values)(n)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]})})}}},iC="dclid",iE="fbclid",ik="gbraid",ix="gclid",iO="ko_click_id",iR="li_fat_id",iT="msclkid",iA="rtd_cid",iM="ttclid",iP="twclid",iN="wbraid",iD={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},iL=function(e){var t=e.split(".");return t.length<=2?e:t.slice(t.length-2,t.length).join(".")},iU=function(e,t,r,n,i){void 0===i&&(i=!0),e.referrer;var s=e.referring_domain,o=(0,eD.__rest)(e,["referrer","referring_domain"]),a=t||{},l=(a.referrer,a.referring_domain),u=(0,eD.__rest)(a,["referrer","referring_domain"]);if(iF(r.excludeReferrers,e.referring_domain))return n.debug("This is not a new campaign because ".concat(e.referring_domain," is in the exclude referrer list.")),!1;if(!i&&Object.values(e).every(function(e){return!e})&&t)return n.debug("This is not a new campaign because this is a direct traffic in the same session."),!1;var c=JSON.stringify(o)!==JSON.stringify(u),h=iL(s||"")!==iL(l||""),d=!t||c||h;return d?n.debug("This is a new campaign. An $identify event will be sent."):n.debug("This is not a new campaign because it's the same as the previous one."),d},iF=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=""),e.some(function(e){return e instanceof RegExp?e.test(t):e===t})},ij=function(e){var t=e;return t?(t.startsWith(".")&&(t=t.substring(1)),[new RegExp("".concat(t.replace(".","\\."),"$"))]):[]},iB=function(){function e(){}return e.prototype.parse=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,(0,eD.__assign)((0,eD.__assign)((0,eD.__assign)((0,eD.__assign)({},iD),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var e=tv();return{utm_campaign:e.utm_campaign,utm_content:e.utm_content,utm_id:e.utm_id,utm_medium:e.utm_medium,utm_source:e.utm_source,utm_term:e.utm_term}},e.prototype.getReferrer=function(){var e,t,r={referrer:void 0,referring_domain:void 0};try{r.referrer=document.referrer||void 0,r.referring_domain=null!=(t=null==(e=r.referrer)?void 0:e.split("/")[2])?t:void 0}catch(e){}return r},e.prototype.getClickIds=function(){var e,t=tv();return(e={})[iC]=t[iC],e[iE]=t[iE],e[ik]=t[ik],e[ix]=t[ix],e[iO]=t[iO],e[iR]=t[iR],e[iT]=t[iT],e[iA]=t[iA],e[iM]=t[iM],e[iP]=t[iP],e[iN]=t[iN],e},e}(),iq=function(){function e(e,t){var r,n,i;this.shouldTrackNewCampaign=!1,this.options=(0,eD.__assign)({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:ij(null==(r=t.cookieOptions)?void 0:r.domain)},e),this.storage=t.cookieStorage,this.storageKey=(n=t.apiKey,void 0===i&&(i=10),["AMP","MKTG",n.substring(0,i)].filter(Boolean).join("_")),this.currentCampaign=iD,this.sessionTimeout=t.sessionTimeout,this.lastEventTime=t.lastEventTime,this.logger=t.loggerProvider,t.loggerProvider.log("Installing web attribution tracking.")}return e.prototype.init=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return[4,this.fetchCampaign()];case 1:if(t=eD.__read.apply(void 0,[r.sent(),2]),this.currentCampaign=t[0],this.previousCampaign=t[1],e=!this.lastEventTime||tg(this.sessionTimeout,this.lastEventTime),!iU(this.currentCampaign,this.previousCampaign,this.options,this.logger,e))return[3,3];return this.shouldTrackNewCampaign=!0,[4,this.storage.set(this.storageKey,this.currentCampaign)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.fetchCampaign=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([new iB().parse(),this.storage.get(this.storageKey)])];case 1:return[2,e.sent()]}})})},e.prototype.generateCampaignEvent=function(e){this.shouldTrackNewCampaign=!1;var t,r,n=(t=this.currentCampaign,r=this.options,eJ(Object.entries((0,eD.__assign)((0,eD.__assign)({},iD),t)).reduce(function(e,t){var n,i=(0,eD.__read)(t,2),s=i[0],o=i[1];return(e.setOnce("initial_".concat(s),null!=(n=null!=o?o:r.initialEmptyValue)?n:"EMPTY"),o)?e.set(s,o):e.unset(s)},new eB)));return e&&(n.event_id=e),n},e.prototype.shouldSetSessionIdOnNewCampaign=function(){return this.shouldTrackNewCampaign&&!!this.options.resetSessionOnNewCampaign},e}();let iz={init:eG((j=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,eD.__extends)(t,e),t.prototype.init=function(e,t,r){var n,i;return void 0===e&&(e=""),arguments.length>2?(n=t,i=r):"string"==typeof t?(n=t,i=void 0):(n=null==t?void 0:t.userId,i=t),e0(this._init((0,eD.__assign)((0,eD.__assign)({},i),{userId:n,apiKey:e})))},t.prototype._init=function(t){var r,n,i;return(0,eD.__awaiter)(this,void 0,void 0,function(){var s,o,a,l,u,c=this;return(0,eD.__generator)(this,function(h){var d,p,f,g,m;switch(h.label){case 0:if(this.initializing)return[2];return this.initializing=!0,[4,(d=t.apiKey,p=t,f=this,void 0===p&&(p={}),(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,n,i,s,o,a,l,u,c,h,g,m,v,y,b,w,_,S,I,C,E,k,x,O,R,T,A,M,P,N,D,L,U,F,j,B,q,z,V,W,G;return(0,eD.__generator)(this,function(K){switch(K.label){case 0:if(e=p.identityStorage||t8,_={},e===t8)return[3,1];return r="",[3,5];case 1:if(null==(I=null==(S=p.cookieOptions)?void 0:S.domain))return[3,2];return n=I,[3,4];case 2:return[4,(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:return[4,new tN().isEnabled()];case 1:if(!o.sent()||"undefined"==typeof location||!location.hostname)return[2,""];for(e=(0,location.hostname).split("."),t=[],r="AMP_TLDTEST",n=e.length-2;n>=0;--n)t.push(e.slice(n).join("."));n=0,o.label=2;case 2:if(!(n<t.length))return[3,7];return[4,(s=new tN({domain:"."+(i=t[n])})).set(r,1)];case 3:return o.sent(),[4,s.get(r)];case 4:if(!o.sent())return[3,6];return[4,s.remove(r)];case 5:return o.sent(),[2,"."+i];case 6:return n++,[3,2];case 7:return[2,""]}})})];case 3:n=K.sent(),K.label=4;case 4:r=n,K.label=5;case 5:var Y,Z;return t=eD.__assign.apply(void 0,[(_.domain=r,_.expiration=365,_.sameSite="Lax",_.secure=!1,_.upgrade=!0,_),p.cookieOptions]),[4,(Y=i=t7(p.identityStorage,t),void 0===(Z=null==(E=null==(C=p.cookieOptions)?void 0:C.upgrade)||E)&&(Z=!0),(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,n,i,s,o,a,l;return(0,eD.__generator)(this,function(u){switch(u.label){case 0:return e="".concat("amp","_").concat(d.substring(0,6)),[4,Y.getRaw(e)];case 1:if(!(t=u.sent()))return[2,{optOut:!1}];if(!Z)return[3,3];return[4,Y.remove(e)];case 2:u.sent(),u.label=3;case 3:return n=(r=(0,eD.__read)(t.split("."),6))[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],[2,{deviceId:n,userId:tK(i),sessionId:tG(o),lastEventId:tG(l),lastEventTime:tG(a),optOut:!!s}]}})}))];case 6:return s=K.sent(),[4,i.get(tU(d))];case 7:return o=K.sent(),a=tv(),l=null!=(T=null!=(R=null!=(O=null!=(x=null!=(k=p.deviceId)?k:a.ampDeviceId)?x:a.deviceId)?O:null==o?void 0:o.deviceId)?R:s.deviceId)?T:e$(),u=null!=(A=null==o?void 0:o.lastEventId)?A:s.lastEventId,c=null!=(M=null==o?void 0:o.lastEventTime)?M:s.lastEventTime,h=null!=(N=null!=(P=p.optOut)?P:null==o?void 0:o.optOut)?N:s.optOut,g=null!=(D=null==o?void 0:o.sessionId)?D:s.sessionId,m=null!=(U=null!=(L=p.userId)?L:null==o?void 0:o.userId)?U:s.userId,f.previousSessionDeviceId=null!=(F=null==o?void 0:o.deviceId)?F:s.deviceId,f.previousSessionUserId=null!=(j=null==o?void 0:o.userId)?j:s.userId,v={ipAddress:null==(q=null==(B=p.trackingOptions)?void 0:B.ipAddress)||q,language:null==(V=null==(z=p.trackingOptions)?void 0:z.language)||V,platform:null==(G=null==(W=p.trackingOptions)?void 0:W.platform)||G},y=null==o?void 0:o.pageCounter,b=null==o?void 0:o.debugLogsEnabled,void 0!==p.autocapture&&(p.defaultTracking=p.autocapture),[4,(w=new t9(d,p.appVersion,i,t,p.defaultTracking,p.autocapture,l,p.flushIntervalMillis,p.flushMaxRetries,p.flushQueueSize,e,p.ingestionMetadata,p.instanceName,u,c,p.loggerProvider,p.logLevel,p.minIdLength,p.offline,h,p.partnerId,p.plan,p.serverUrl,p.serverZone,g,p.sessionTimeout,p.storageProvider,v,p.transport,p.useBatch,p.fetchRemoteConfig,m,y,b,p.networkTrackingOptions)).storageProvider.isEnabled()];case 8:return K.sent()||(w.loggerProvider.warn("Storage provider ".concat(w.storageProvider.constructor.name," is not enabled. Falling back to MemoryStorage.")),w.storageProvider=new tP),[2,w]}})}))];case 1:if(!(s=h.sent()).fetchRemoteConfig)return[3,4];return[4,(g=s,(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return[4,(e=new rP(g)).initialize()];case 1:return t.sent(),[2,e]}})}))];case 2:return[4,h.sent().generateJoinedConfig()];case 3:s=h.sent(),h.label=4;case 4:return[4,e.prototype._init.call(this,s)];case 5:if(h.sent(),this.logBrowserOptions(s),!tw(this.config.defaultTracking))return[3,7];return o=tw((m=this.config).defaultTracking)&&m.defaultTracking&&"object"==typeof m.defaultTracking&&m.defaultTracking.attribution&&"object"==typeof m.defaultTracking.attribution?(0,eD.__assign)({},m.defaultTracking.attribution):{},this.webAttribution=new iq(o,this.config),[4,this.webAttribution.init()];case 6:h.sent(),h.label=7;case 7:if(l=Number.isNaN(Number((a=tv()).ampSessionId))?void 0:Number(a.ampSessionId),this.setSessionId(null!=(i=null!=(n=null!=(r=t.sessionId)?r:l)?n:this.config.sessionId)?i:Date.now()),(u=td(t.instanceName)).identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),null===this.config.offline)return[3,9];return[4,this.add(rO()).promise];case 8:h.sent(),h.label=9;case 9:return[4,this.add(new te).promise];case 10:return h.sent(),[4,this.add(new tM).promise];case 11:return h.sent(),[4,this.add(new tm).promise];case 12:if(h.sent(),rx(this.config),!tb(this.config.defaultTracking,"fileDownloads"))return[3,14];return this.config.loggerProvider.debug("Adding file download tracking plugin"),[4,this.add(rE()).promise];case 13:h.sent(),h.label=14;case 14:if(!tb(this.config.defaultTracking,"formInteractions"))return[3,16];return this.config.loggerProvider.debug("Adding form interaction plugin"),[4,this.add(rS()).promise];case 15:h.sent(),h.label=16;case 16:if(!t_(this.config.defaultTracking))return[3,18];return this.config.loggerProvider.debug("Adding page view tracking plugin"),[4,this.add(ry(tx(this.config))).promise];case 17:h.sent(),h.label=18;case 18:if(!tC(this.config.autocapture))return[3,20];return this.config.loggerProvider.debug("Adding user interactions plugin (autocapture plugin)"),[4,this.add(iu(tE(this.config))).promise];case 19:h.sent(),h.label=20;case 20:if(!tI(this.config.autocapture))return[3,22];return this.config.loggerProvider.debug("Adding network tracking plugin"),[4,this.add(iI(tk(this.config))).promise];case 21:h.sent(),h.label=22;case 22:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 23:return h.sent(),u.eventBridge.setEventReceiver(function(e){c.track(e.eventType,e.eventProperties)}),[2]}})})},t.prototype.getUserId=function(){var e;return null==(e=this.config)?void 0:e.userId},t.prototype.setUserId=function(e){this.config?(this.config.loggerProvider.debug("function setUserId: ",e),(e!==this.config.userId||void 0===e)&&(this.config.userId=e,this.timeline.onIdentityChanged({userId:e}),tp(e,this.config.instanceName))):this.q.push(this.setUserId.bind(this,e))},t.prototype.getDeviceId=function(){var e;return null==(e=this.config)?void 0:e.deviceId},t.prototype.setDeviceId=function(e){this.config?(this.config.loggerProvider.debug("function setDeviceId: ",e),e!==this.config.deviceId&&(this.config.deviceId=e,this.timeline.onIdentityChanged({deviceId:e}),tf(e,this.config.instanceName))):this.q.push(this.setDeviceId.bind(this,e))},t.prototype.reset=function(){this.setDeviceId(e$()),this.setUserId(void 0)},t.prototype.getSessionId=function(){var e;return null==(e=this.config)?void 0:e.sessionId},t.prototype.setSessionId=function(e){var t,r=[];if(!this.config)return this.q.push(this.setSessionId.bind(this,e)),e0(Promise.resolve());if(e===this.config.sessionId)return e0(Promise.resolve());this.config.loggerProvider.debug("function setSessionId: ",e);var n=this.getSessionId();n!==e&&this.timeline.onSessionIdChanged(e);var i=this.config.lastEventTime,s=null!=(t=this.config.lastEventId)?t:-1;this.config.sessionId=e,this.config.lastEventTime=void 0,this.config.pageCounter=0,tS(this.config.defaultTracking)&&(n&&i&&r.push(this.track(tX,void 0,{device_id:this.previousSessionDeviceId,event_id:++s,session_id:n,time:i+1,user_id:this.previousSessionUserId}).promise),this.config.lastEventTime=this.config.sessionId);var o=this.trackCampaignEventIfNeeded(++s,r);return tS(this.config.defaultTracking)&&r.push(this.track(tJ,void 0,{event_id:o?++s:s,session_id:this.config.sessionId,time:this.config.lastEventTime}).promise),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId,e0(Promise.all(r))},t.prototype.extendSession=function(){this.config?this.config.lastEventTime=Date.now():this.q.push(this.extendSession.bind(this))},t.prototype.setTransport=function(e){this.config?this.config.transportProvider=re(e):this.q.push(this.setTransport.bind(this,e))},t.prototype.identify=function(t,r){if(tR(t)){var n=t._q;t._q=[],t=tO(new eB,n)}return(null==r?void 0:r.user_id)&&this.setUserId(r.user_id),(null==r?void 0:r.device_id)&&this.setDeviceId(r.device_id),e.prototype.identify.call(this,t,r)},t.prototype.groupIdentify=function(t,r,n,i){if(tR(n)){var s=n._q;n._q=[],n=tO(new eB,s)}return e.prototype.groupIdentify.call(this,t,r,n,i)},t.prototype.revenue=function(t,r){if(tR(t)){var n=t._q;t._q=[],t=tO(new tt,n)}return e.prototype.revenue.call(this,t,r)},t.prototype.trackCampaignEventIfNeeded=function(e,t){if(!this.webAttribution||!this.webAttribution.shouldTrackNewCampaign)return!1;var r=this.webAttribution.generateCampaignEvent(e);return t?t.push(this.track(r).promise):this.track(r),this.config.loggerProvider.log("Tracking attribution."),!0},t.prototype.process=function(t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n,i;return(0,eD.__generator)(this,function(s){return r=Date.now(),n=tg(this.config.sessionTimeout,this.config.lastEventTime),i=this.webAttribution&&this.webAttribution.shouldSetSessionIdOnNewCampaign(),t.event_type!==tJ&&t.event_type!==tX&&(!t.session_id||t.session_id===this.getSessionId())&&(n||i?(this.setSessionId(r),i&&this.config.loggerProvider.log("Created a new session for new campaign.")):n||this.trackCampaignEventIfNeeded()),[2,e.prototype.process.call(this,t)]})})},t.prototype.logBrowserOptions=function(e){try{var t=(0,eD.__assign)((0,eD.__assign)({},e),{apiKey:e.apiKey.substring(0,10)+"********"});this.config.loggerProvider.debug("Initialized Amplitude with BrowserConfig:",JSON.stringify(t))}catch(e){this.config.loggerProvider.error("Error logging browser config",e)}},t}(e1))).init.bind(j),"init",ez(j),eW(j,["config"])),add:eG(j.add.bind(j),"add",ez(j),eW(j,["config.apiKey","timeline.plugins"])),remove:eG(j.remove.bind(j),"remove",ez(j),eW(j,["config.apiKey","timeline.plugins"])),track:eG(j.track.bind(j),"track",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),logEvent:eG(j.logEvent.bind(j),"logEvent",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),identify:eG(j.identify.bind(j),"identify",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),groupIdentify:eG(j.groupIdentify.bind(j),"groupIdentify",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),setGroup:eG(j.setGroup.bind(j),"setGroup",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),revenue:eG(j.revenue.bind(j),"revenue",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),flush:eG(j.flush.bind(j),"flush",ez(j),eW(j,["config.apiKey","timeline.queue.length"])),getUserId:eG(j.getUserId.bind(j),"getUserId",ez(j),eW(j,["config","config.userId"])),setUserId:eG(j.setUserId.bind(j),"setUserId",ez(j),eW(j,["config","config.userId"])),getDeviceId:eG(j.getDeviceId.bind(j),"getDeviceId",ez(j),eW(j,["config","config.deviceId"])),setDeviceId:eG(j.setDeviceId.bind(j),"setDeviceId",ez(j),eW(j,["config","config.deviceId"])),reset:eG(j.reset.bind(j),"reset",ez(j),eW(j,["config","config.userId","config.deviceId"])),getSessionId:eG(j.getSessionId.bind(j),"getSessionId",ez(j),eW(j,["config"])),setSessionId:eG(j.setSessionId.bind(j),"setSessionId",ez(j),eW(j,["config"])),extendSession:eG(j.extendSession.bind(j),"extendSession",ez(j),eW(j,["config"])),setOptOut:eG(j.setOptOut.bind(j),"setOptOut",ez(j),eW(j,["config"])),setTransport:eG(j.setTransport.bind(j),"setTransport",ez(j),eW(j,["config"]))};e.s([],900613),e.i(900613),(B=eE||(eE={})).US="US",B.EU="EU",B.STAGING="STAGING",e.s(["DEFAULT_ACTION_CLICK_ALLOWLIST",()=>rL,"DEFAULT_CSS_SELECTOR_ALLOWLIST",()=>rN,"DEFAULT_DATA_ATTRIBUTE_PREFIX",()=>rD,"IdentifyOperation",()=>ef,"LogLevel",()=>ep,"OfflineDisabled",()=>null,"RevenueProperty",()=>ev,"ServerZone",()=>eE,"SpecialEventType",()=>eg],508952),e.i(508952);var iV=iz.add,iW=(iz.extendSession,iz.flush,iz.getDeviceId),iG=iz.getSessionId,iK=(iz.getUserId,iz.groupIdentify,iz.identify),iY=iz.init,iZ=(iz.logEvent,iz.remove,iz.reset),i$=(iz.revenue,iz.setDeviceId,iz.setGroup,iz.setOptOut,iz.setSessionId,iz.setTransport,iz.setUserId),iH=iz.track;e.s(["add",()=>iV,"getDeviceId",()=>iW,"getSessionId",()=>iG,"identify",()=>iK,"init",()=>iY,"reset",()=>iZ,"setUserId",()=>i$,"track",()=>iH],540193);var iJ="[Amplitude]",iX="".concat(iJ," Session Replay ID"),iQ=eE.US,i0="".concat(iJ," Session Replay Debug"),i1="amp-mask";(q=ek||(ek={})).GET_SR_PROPS="get-sr-props",q.DEBUG_INFO="debug-info",q.FETCH_REQUEST="fetch-request",q.METADATA="metadata";var i2=function(){function e(e){this.logger=e,this.log=this.getSafeMethod("log"),this.warn=this.getSafeMethod("warn"),this.error=this.getSafeMethod("error"),this.debug=this.getSafeMethod("debug")}return e.prototype.getSafeMethod=function(e){if(!this.logger)return function(){};var t,r=this.logger[e];return"function"==typeof r?(null!=(t=r.__rrweb_original__)?t:r).bind(this.logger):function(){}},e.prototype.enable=function(e){this.logger.enable(e)},e.prototype.disable=function(){this.logger.disable()},e}(),i3=function(){return{flushMaxRetries:2,logLevel:ep.Warn,loggerProvider:new e4,transportProvider:new tj}},i4=function(e){function t(t,r){var n,i=this,s=i3();return(i=e.call(this,(0,eD.__assign)((0,eD.__assign)({transportProvider:s.transportProvider,loggerProvider:new i2(r.loggerProvider||s.loggerProvider)},r),{apiKey:t}))||this).flushMaxRetries=void 0!==r.flushMaxRetries&&r.flushMaxRetries<=s.flushMaxRetries?r.flushMaxRetries:s.flushMaxRetries,i.apiKey=t,i.sampleRate=r.sampleRate||0,i.serverZone=r.serverZone||iQ,i.configServerUrl=r.configServerUrl,i.trackServerUrl=r.trackServerUrl,i.shouldInlineStylesheet=r.shouldInlineStylesheet,i.version=r.version,i.performanceConfig=r.performanceConfig,i.storeType=null!=(n=r.storeType)?n:"idb",r.privacyConfig&&(i.privacyConfig=r.privacyConfig),r.debugMode&&(i.debugMode=r.debugMode),r.experimental&&(i.experimental=r.experimental),i}return(0,eD.__extends)(t,e),t}(e6),i5=e.i(184883),i6=e.i(254725),i8=Object.defineProperty,i9=(e,t,r)=>{let n;return(n="symbol"!=typeof t?t+"":t)in e?i8(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r},i7=Object.defineProperty,se=(e,t,r)=>{let n;return(n="symbol"!=typeof t?t+"":t)in e?i7(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r},st=((z=st||{})[z.Document=0]="Document",z[z.DocumentType=1]="DocumentType",z[z.Element=2]="Element",z[z.Text=3]="Text",z[z.CDATA=4]="CDATA",z[z.Comment=5]="Comment",z);let sr={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},sn={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},si={};function ss(e){if(si[e])return si[e];let t=globalThis[e],r=t.prototype,n=e in sr?sr[e]:void 0,i=!!(n&&n.every(e=>{var t,n;return!!(null==(n=null==(t=Object.getOwnPropertyDescriptor(r,e))?void 0:t.get)?void 0:n.toString().includes("[native code]"))})),s=e in sn?sn[e]:void 0,o=!!(s&&s.every(e=>{var t;return"function"==typeof r[e]&&(null==(t=r[e])?void 0:t.toString().includes("[native code]"))}));if(i&&o&&!globalThis.Zone)return si[e]=t.prototype,t.prototype;try{let n=document.createElement("iframe");document.body.appendChild(n);let i=n.contentWindow;if(!i)return t.prototype;let s=i[e].prototype;if(document.body.removeChild(n),!s)return r;return si[e]=s}catch{return r}}let so={};function sa(e,t,r){var n;let i=`${e}.${String(r)}`;if(so[i])return so[i].call(t);let s=null==(n=Object.getOwnPropertyDescriptor(ss(e),r))?void 0:n.get;return s?(so[i]=s,s.call(t)):t[r]}let sl=function(e){return sa("Node",e,"childNodes")},su=function(e){return sa("Node",e,"parentNode")},sc=function(e){return sa("Node",e,"parentElement")},sh=function(e){return sa("Node",e,"textContent")},sd=function(e){return e&&"shadowRoot"in e?sa("Element",e,"shadowRoot"):null};function sp(e){return e.nodeType===e.ELEMENT_NODE}function sf(e){var t;let r=e&&"host"in e&&"mode"in e&&((t=e)&&"host"in t?sa("ShadowRoot",t,"host"):null)||null;return!!(r&&"shadowRoot"in r&&sd(r)===e)}function sg(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function sm(e){try{var t;let r=e.rules||e.cssRules;if(!r)return null;let n=e.href;return!n&&e.ownerNode&&e.ownerNode.ownerDocument&&(n=e.ownerNode.ownerDocument.location.href),(t=Array.from(r,e=>sv(e,n)).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),t}catch(e){return null}}function sv(e,t){if("styleSheet"in e){let t;try{t=sm(e.styleSheet)||function(e){let{cssText:t}=e;if(t.split('"').length<3)return t;let r=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}(e)}catch(r){t=e.cssText}return e.styleSheet.href?sO(t,e.styleSheet.href):t}{let r=e.cssText;return("selectorText"in e&&e.selectorText.includes(":")&&(r=r.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2")),t)?sO(r,t):r}}class sy{constructor(){se(this,"idNodeMap",new Map),se(this,"nodeMetaMap",new WeakMap)}getId(e){var t;return e?(null==(t=this.getMeta(e))?void 0:t.id)??-1:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){let r=this.getNode(e);if(r){let e=this.nodeMetaMap.get(r);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function sb({element:e,maskInputOptions:t,tagName:r,type:n,value:i,maskInputFn:s}){let o=i||"",a=n&&sw(n);return(t[r.toLowerCase()]||a&&t[a])&&(o=s?s(o,e):"*".repeat(o.length)),o}function sw(e){return e.toLowerCase()}let s_="__rrweb_original__";function sS(e){let t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?sw(t):null}function sI(e,t){let r;try{r=new URL(e,t??window.location.href)}catch(e){return null}let n=r.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==n?void 0:n[1])??null}let sC=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,sE=/^(?:[a-z+]+:)?\/\//i,sk=/^www\..*/i,sx=/^(data:)([^,]*),(.*)/i;function sO(e,t){return(e||"").replace(sC,(e,r,n,i,s,o)=>{let a=n||s||o,l=r||i||"";if(!a)return e;if(sE.test(a)||sk.test(a)||sx.test(a))return`url(${l}${a}${l})`;if("/"===a[0])return`url(${l}${(t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0]).split("?")[0]+a}${l})`;let u=t.split("/"),c=a.split("/");for(let e of(u.pop(),c))if("."===e)continue;else".."===e?u.pop():u.push(e);return`url(${l}${u.join("/")}${l})`})}function sR(e,t=!1){return t?e.replace(/(\/\*[^*]*\*\/)|[\s;]/g,""):e.replace(/(\/\*[^*]*\*\/)|[\s;]/g,"").replace(/0px/g,"0")}let sT=1,sA=RegExp("[^a-z0-9-_:]");function sM(){return sT++}let sP=/^[^ \t\n\r\u000c]+/,sN=/^[, \t\n\r\u000c]+/,sD=new WeakMap;function sL(e,t){return t&&""!==t.trim()?sU(e,t):t}function sU(e,t){let r=sD.get(e);if(r||(r=e.createElement("a"),sD.set(e,r)),t){if(t.startsWith("blob:")||t.startsWith("data:"))return t}else t="";return r.setAttribute("href",t),r.href}function sF(e,t,r,n){if(!n)return n;if("src"===r||"href"===r&&("use"!==t||"#"!==n[0])||"xlink:href"===r&&"#"!==n[0])return sL(e,n);if("background"===r&&("table"===t||"td"===t||"th"===t))return sL(e,n);if("srcset"===r)return function(e,t){if(""===t.trim())return t;let r=0;function n(e){let n,i=e.exec(t.substring(r));return i?(n=i[0],r+=n.length,n):""}let i=[];for(;n(sN),!(r>=t.length);){let s=n(sP);if(","===s.slice(-1))s=sL(e,s.substring(0,s.length-1)),i.push(s);else{let n="";s=sL(e,s);let o=!1;for(;;){let e=t.charAt(r);if(""===e){i.push((s+n).trim());break}if(o)")"===e&&(o=!1);else if(","===e){r+=1,i.push((s+n).trim());break}else"("===e&&(o=!0);n+=e,r+=1}}}return i.join(", ")}(e,n);if("style"===r)return sO(n,sU(e));else if("object"===t&&"data"===r)return sL(e,n);return n}function sj(e,t,r){return("video"===e||"audio"===e)&&"autoplay"===t}function sB(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!r&&sB(su(e),t,r);for(let r=e.classList.length;r--;){let n=e.classList[r];if(t.test(n))return!0}return!!r&&sB(su(e),t,r)}function sq(e,t,r,n){let i;if(sp(e)){if(!sl(i=e).length)return!1}else{if(null===sc(e))return!1;i=sc(e)}try{if("string"==typeof t){if(n){if(i.closest(`.${t}`))return!0}else if(i.classList.contains(t))return!0}else if(sB(i,t,n))return!0;if(r){if(n){if(i.closest(r))return!0}else if(i.matches(r))return!0}}catch(e){}return!1}function sz(e){return null==e?"":e.toLowerCase()}function sV(e,n){let i,{doc:s,mirror:o,blockClass:a,blockSelector:l,maskTextClass:u,maskTextSelector:c,skipChild:h=!1,inlineStylesheet:d=!0,maskInputOptions:p={},maskTextFn:f,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v={},inlineImages:y=!1,recordCanvas:b=!1,onSerialize:w,onIframeLoad:_,iframeLoadTimeout:S=5e3,onStylesheetLoad:I,stylesheetLoadTimeout:C=5e3,keepIframeSrcFn:E=()=>!1,newlyAddedElement:k=!1,cssCaptured:x=!1}=n,{needsMask:O}=n,{preserveWhiteSpace:R=!0}=n;O||(O=sq(e,u,c,void 0===O));let T=function(e,n){let{doc:i,mirror:s,blockClass:o,blockSelector:a,needsMask:l,inlineStylesheet:u,maskInputOptions:c={},maskTextFn:h,maskInputFn:d,dataURLOptions:p={},inlineImages:f,recordCanvas:g,keepIframeSrcFn:m,newlyAddedElement:v=!1,cssCaptured:y=!1}=n,b=function(e,t){if(!t.hasNode(e))return;let r=t.getId(e);return 1===r?void 0:r}(i,s);switch(e.nodeType){case e.DOCUMENT_NODE:if("CSS1Compat"!==e.compatMode)return{type:st.Document,childNodes:[],compatMode:e.compatMode};return{type:st.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:st.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:b};case e.ELEMENT_NODE:return function(e,n){let i,{doc:s,blockClass:o,blockSelector:a,inlineStylesheet:l,maskInputOptions:u={},maskInputFn:c,dataURLOptions:h={},inlineImages:d,recordCanvas:p,keepIframeSrcFn:f,newlyAddedElement:g=!1,rootId:m}=n,v=function(e,t,r){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let r=e.classList.length;r--;){let n=e.classList[r];if(t.test(n))return!0}if(r)return e.matches(r)}catch(e){}return!1}(e,o,a),y=function(e){if(e instanceof HTMLFormElement)return"form";let t=sw(e.tagName);return sA.test(t)?"div":t}(e),b={},w=e.attributes.length;for(let t=0;t<w;t++){let r=e.attributes[t];sj(y,r.name,r.value)||(b[r.name]=sF(s,y,sw(r.name),r.value))}if("link"===y&&l){let t=Array.from(s.styleSheets).find(t=>t.href===e.href),r=null;t&&(r=sm(t)),r&&(delete b.rel,delete b.href,b._cssText=r)}if("style"===y&&e.sheet){let t=sm(e.sheet);t&&(e.childNodes.length>1&&(t=(function(e,t,r=!1){let n=Array.from(t.childNodes),i=[],s=0;if(n.length>1&&e&&"string"==typeof e){let t=sR(e,r),o=t.length/e.length;for(let a=1;a<n.length;a++)if(n[a].textContent&&"string"==typeof n[a].textContent){let l=sR(n[a].textContent,r),u=3;for(;u<l.length&&(l[u].match(/[a-zA-Z0-9]/)||-1!==l.indexOf(l.substring(0,u),1));u++);for(;u<l.length;u++){let c=l.substring(0,u),h=t.split(c),d=-1;if(2===h.length)d=h[0].length;else if(h.length>2&&""===h[0]&&""!==n[a-1].textContent)d=t.indexOf(c,1);else if(1===h.length){if(c=c.substring(0,c.length-1),(h=t.split(c)).length<=1)return i.push(e),i;u=101}else u===l.length-1&&(d=t.indexOf(c));if(h.length>=2&&u>100){let e=n[a-1].textContent;if(e&&"string"==typeof e){let r=sR(e).length;d=t.indexOf(c,r)}-1===d&&(d=h[0].length)}if(-1!==d){let a=Math.floor(d/o);for(;a>0&&a<e.length;){if((s+=1)>50*n.length)return i.push(e),i;let l=sR(e.substring(0,a),r);if(l.length===d){i.push(e.substring(0,a)),e=e.substring(a),t=t.substring(d);break}l.length<d?a+=Math.max(1,Math.floor((d-l.length)/o)):a-=Math.max(1,Math.floor((l.length-d)*o))}break}}}}return i.push(e),i})(t,e).join("/* rr_split */")),b._cssText=t)}if("input"===y||"textarea"===y||"select"===y){let t=e.value,r=e.checked;"radio"!==b.type&&"checkbox"!==b.type&&"submit"!==b.type&&"button"!==b.type&&t?b.value=sb({element:e,type:sS(e),tagName:y,value:t,maskInputOptions:u,maskInputFn:c}):r&&(b.checked=r)}if("option"===y&&(e.selected&&!u.select?b.selected=!0:delete b.selected),"dialog"===y&&e.open&&(b.rr_open_mode=e.matches("dialog:modal")?"modal":"non-modal"),"canvas"===y&&p){if("2d"===e.__context)!function(e){let t=e.getContext("2d");if(!t)return!0;for(let r=0;r<e.width;r+=50)for(let n=0;n<e.height;n+=50){let i=t.getImageData;if(new Uint32Array((s_ in i?i[s_]:i).call(t,r,n,Math.min(50,e.width-r),Math.min(50,e.height-n)).data.buffer).some(e=>0!==e))return!1}return!0}(e)&&(b.rr_dataURL=e.toDataURL(h.type,h.quality));else if(!("__context"in e)){let t=e.toDataURL(h.type,h.quality),r=s.createElement("canvas");r.width=e.width,r.height=e.height,t!==r.toDataURL(h.type,h.quality)&&(b.rr_dataURL=t)}}if("img"===y&&d){t||(r=(t=s.createElement("canvas")).getContext("2d"));let n=e.currentSrc||e.getAttribute("src")||"<unknown-src>",i=e.crossOrigin,o=()=>{e.removeEventListener("load",o);try{t.width=e.naturalWidth,t.height=e.naturalHeight,r.drawImage(e,0,0),b.rr_dataURL=t.toDataURL(h.type,h.quality)}catch(t){if("anonymous"!==e.crossOrigin){e.crossOrigin="anonymous",e.complete&&0!==e.naturalWidth?o():e.addEventListener("load",o);return}console.warn(`Cannot inline img src=${n}! Error: ${t}`)}"anonymous"===e.crossOrigin&&(i?b.crossOrigin=i:e.removeAttribute("crossorigin"))};e.complete&&0!==e.naturalWidth?o():e.addEventListener("load",o)}if("audio"===y||"video"===y){let t=b;t.rr_mediaState=e.paused?"paused":"played",t.rr_mediaCurrentTime=e.currentTime,t.rr_mediaPlaybackRate=e.playbackRate,t.rr_mediaMuted=e.muted,t.rr_mediaLoop=e.loop,t.rr_mediaVolume=e.volume}if(!g&&(e.scrollLeft&&(b.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(b.rr_scrollTop=e.scrollTop)),v){let{width:t,height:r}=e.getBoundingClientRect();b={class:b.class,rr_width:`${t}px`,rr_height:`${r}px`}}"iframe"!==y||f(b.src)||(e.contentDocument||(b.rr_src=b.src),delete b.src);try{customElements.get(y)&&(i=!0)}catch(e){}return{type:st.Element,tagName:y,attributes:b,childNodes:[],isSVG:!!("svg"===e.tagName||e.ownerSVGElement)||void 0,needBlock:v,rootId:m,isCustom:i}}(e,{doc:i,blockClass:o,blockSelector:a,inlineStylesheet:u,maskInputOptions:c,maskInputFn:d,dataURLOptions:p,inlineImages:f,recordCanvas:g,keepIframeSrcFn:m,newlyAddedElement:v,rootId:b});case e.TEXT_NODE:return function(e,t){let{needsMask:r,maskTextFn:n,rootId:i,cssCaptured:s}=t,o=su(e),a=o&&o.tagName,l="",u="STYLE"===a||void 0,c="SCRIPT"===a||void 0;return c?l="SCRIPT_PLACEHOLDER":!s&&(l=sh(e),u&&l&&(l=sO(l,sU(t.doc)))),!u&&!c&&l&&r&&(l=n?n(l,sc(e)):l.replace(/[\S]/g,"*")),{type:st.Text,textContent:l||"",rootId:i}}(e,{doc:i,needsMask:l,maskTextFn:h,rootId:b,cssCaptured:y});case e.CDATA_SECTION_NODE:return{type:st.CDATA,textContent:"",rootId:b};case e.COMMENT_NODE:return{type:st.Comment,textContent:sh(e)||"",rootId:b};default:return!1}}(e,{doc:s,mirror:o,blockClass:a,blockSelector:l,needsMask:O,inlineStylesheet:d,maskInputOptions:p,maskTextFn:f,maskInputFn:g,dataURLOptions:v,inlineImages:y,recordCanvas:b,keepIframeSrcFn:E,newlyAddedElement:k,cssCaptured:x});if(!T)return console.warn(e,"not serialized"),null;i=o.hasNode(e)?o.getId(e):!function(e,t){if(t.comment&&e.type===st.Comment)return!0;if(e.type===st.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&"js"===sI(e.attributes.href)))return!0;else if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(sz(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===sz(e.attributes.name)||"icon"===sz(e.attributes.rel)||"apple-touch-icon"===sz(e.attributes.rel)||"shortcut icon"===sz(e.attributes.rel))))return!0;else if("meta"===e.tagName){if(t.headMetaDescKeywords&&sz(e.attributes.name).match(/^description|keywords$/))return!0;else if(t.headMetaSocial&&(sz(e.attributes.property).match(/^(og|twitter|fb):/)||sz(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===sz(e.attributes.name)))return!0;else if(t.headMetaRobots&&("robots"===sz(e.attributes.name)||"googlebot"===sz(e.attributes.name)||"bingbot"===sz(e.attributes.name)))return!0;else if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;else if(t.headMetaAuthorship&&("author"===sz(e.attributes.name)||"generator"===sz(e.attributes.name)||"framework"===sz(e.attributes.name)||"publisher"===sz(e.attributes.name)||"progid"===sz(e.attributes.name)||sz(e.attributes.property).match(/^article:/)||sz(e.attributes.property).match(/^product:/)))return!0;else if(t.headMetaVerification&&("google-site-verification"===sz(e.attributes.name)||"yandex-verification"===sz(e.attributes.name)||"csrf-token"===sz(e.attributes.name)||"p:domain_verify"===sz(e.attributes.name)||"verify-v1"===sz(e.attributes.name)||"verification"===sz(e.attributes.name)||"shopify-checkout-api-token"===sz(e.attributes.name)))return!0}}return!1}(T,m)&&(R||T.type!==st.Text||T.textContent.replace(/^\s+|\s+$/gm,"").length)?sM():-2;let A=Object.assign(T,{id:i});if(o.add(e,A),-2===i)return null;w&&w(e);let M=!h;if(A.type===st.Element){M=M&&!A.needBlock,delete A.needBlock;let t=sd(e);t&&sg(t)&&(A.isShadowHost=!0)}if((A.type===st.Document||A.type===st.Element)&&M){m.headWhitespace&&A.type===st.Element&&"head"===A.tagName&&(R=!1);let t={doc:s,mirror:o,blockClass:a,blockSelector:l,needsMask:O,maskTextClass:u,maskTextSelector:c,skipChild:h,inlineStylesheet:d,maskInputOptions:p,maskTextFn:f,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:y,recordCanvas:b,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:_,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:C,keepIframeSrcFn:E,cssCaptured:!1};if(A.type===st.Element&&"textarea"===A.tagName&&void 0!==A.attributes.value);else for(let r of(A.type===st.Element&&void 0!==A.attributes._cssText&&"string"==typeof A.attributes._cssText&&(t.cssCaptured=!0),Array.from(sl(e)))){let e=sV(r,t);e&&A.childNodes.push(e)}let r=null;if(sp(e)&&(r=sd(e)))for(let e of Array.from(sl(r))){let n=sV(e,t);n&&(sg(r)&&(n.isShadow=!0),A.childNodes.push(n))}}let P=su(e);return P&&sf(P)&&sg(P)&&(A.isShadow=!0),A.type===st.Element&&"iframe"===A.tagName&&function(e,t,r){let n,i=e.contentWindow;if(!i)return;let s=!1;try{n=i.document.readyState}catch(e){return}if("complete"!==n){let n=setTimeout(()=>{s||(t(),s=!0)},r);e.addEventListener("load",()=>{clearTimeout(n),s=!0,t()});return}let o="about:blank";if(i.location.href!==o||e.src===o||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,()=>{let t=e.contentDocument;if(t&&_){let r=sV(t,{doc:t,mirror:o,blockClass:a,blockSelector:l,needsMask:O,maskTextClass:u,maskTextSelector:c,skipChild:!1,inlineStylesheet:d,maskInputOptions:p,maskTextFn:f,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:y,recordCanvas:b,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:_,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:C,keepIframeSrcFn:E});r&&_(e,r)}},S),A.type===st.Element&&"link"===A.tagName&&"string"==typeof A.attributes.rel&&("stylesheet"===A.attributes.rel||"preload"===A.attributes.rel&&"string"==typeof A.attributes.href&&"css"===sI(A.attributes.href))&&function(e,t,r){let n,i=!1;try{n=e.sheet}catch(e){return}if(n)return;let s=setTimeout(()=>{i||(t(),i=!0)},r);e.addEventListener("load",()=>{clearTimeout(s),i=!0,t()})}(e,()=>{if(I){let t=sV(e,{doc:s,mirror:o,blockClass:a,blockSelector:l,needsMask:O,maskTextClass:u,maskTextSelector:c,skipChild:!1,inlineStylesheet:d,maskInputOptions:p,maskTextFn:f,maskInputFn:g,slimDOMOptions:m,dataURLOptions:v,inlineImages:y,recordCanvas:b,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:_,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:C,keepIframeSrcFn:E});t&&I(e,t)}},C),A}RegExp(/(max|min)-device-(width|height)/.source,"g");var sW={exports:{}},sG=String,sK=function(){return{isColorSupported:!1,reset:sG,bold:sG,dim:sG,italic:sG,underline:sG,inverse:sG,hidden:sG,strikethrough:sG,black:sG,red:sG,green:sG,yellow:sG,blue:sG,magenta:sG,cyan:sG,white:sG,gray:sG,bgBlack:sG,bgRed:sG,bgGreen:sG,bgYellow:sG,bgBlue:sG,bgMagenta:sG,bgCyan:sG,bgWhite:sG}};sW.exports=sK(),sW.exports.createColors=sK;var sY=sW.exports;let sZ=function(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))),s$=class e extends Error{constructor(t,r,n,i,s,o){super(t),this.name="CssSyntaxError",this.reason=t,s&&(this.file=s),i&&(this.source=i),o&&(this.plugin=o),void 0!==r&&void 0!==n&&("number"==typeof r?(this.line=r,this.column=n):(this.line=r.line,this.column=r.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){let t,r;if(!this.source)return"";let n=this.source;null==e&&(e=sY.isColorSupported),sZ&&e&&(n=sZ(n));let i=n.split(/\r?\n/),s=Math.max(this.line-3,0),o=Math.min(this.line+2,i.length),a=String(o).length;if(e){let{bold:e,gray:n,red:i}=sY.createColors(!0);t=t=>e(i(t)),r=e=>n(e)}else t=r=e=>e;return i.slice(s,o).map((e,n)=>{let i=s+1+n,o=" "+(" "+i).slice(-a)+" | ";if(i===this.line){let n=r(o.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return t(">")+r(o)+e+"\n "+n+t("^")}return" "+r(o)+e}).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}};s$.default=s$;var sH={};sH.isClean=Symbol("isClean"),sH.my=Symbol("my");let sJ={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1},sX=class{constructor(e){this.builder=e}atrule(e,t){let r="@"+e.name,n=e.params?this.rawValue(e,"params"):"";if(void 0!==e.raws.afterName?r+=e.raws.afterName:n&&(r+=" "),e.nodes)this.block(e,r+n);else{let i=(e.raws.between||"")+(t?";":"");this.builder(r+n+i,e)}}beforeAfter(e,t){let r;r="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let n=e.parent,i=0;for(;n&&"root"!==n.type;)i+=1,n=n.parent;if(r.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<i;e++)r+=t}return r}block(e,t){let r,n=this.raw(e,"between","beforeOpen");this.builder(t+n+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),r=this.raw(e,"after")):r=this.raw(e,"after","emptyBody"),r&&this.builder(r),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let r=this.raw(e,"semicolon");for(let n=0;n<e.nodes.length;n++){let i=e.nodes[n],s=this.raw(i,"before");s&&this.builder(s),this.stringify(i,t!==n||r)}}comment(e){let t=this.raw(e,"left","commentLeft"),r=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+r+"*/",e)}decl(e,t){let r=this.raw(e,"between","colon"),n=e.prop+r+this.rawValue(e,"value");e.important&&(n+=e.raws.important||" !important"),t&&(n+=";"),this.builder(n,e)}document(e){this.body(e)}raw(e,t,r){let n;if(r||(r=t),t&&void 0!==(n=e.raws[t]))return n;let i=e.parent;if("before"===r&&(!i||"root"===i.type&&i.first===e||i&&"document"===i.type))return"";if(!i)return sJ[r];let s=e.root();if(s.rawCache||(s.rawCache={}),void 0!==s.rawCache[r])return s.rawCache[r];if("before"===r||"after"===r)return this.beforeAfter(e,r);{var o;let i="raw"+((o=r)[0].toUpperCase()+o.slice(1));this[i]?n=this[i](s,e):s.walk(e=>{if(void 0!==(n=e.raws[t]))return!1})}return void 0===n&&(n=sJ[r]),s.rawCache[r]=n,n}rawBeforeClose(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length>0&&void 0!==e.raws.after)return(t=e.raws.after).includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let r;return e.walkComments(e=>{if(void 0!==e.raws.before)return(r=e.raws.before).includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(t,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(e,t){let r;return e.walkDecls(e=>{if(void 0!==e.raws.before)return(r=e.raws.before).includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(t,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeOpen(e){let t;return e.walk(e=>{if("decl"!==e.type&&void 0!==(t=e.raws.between))return!1}),t}rawBeforeRule(e){let t;return e.walk(r=>{if(r.nodes&&(r.parent!==e||e.first!==r)&&void 0!==r.raws.before)return(t=r.raws.before).includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(e=>{if(void 0!==e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(e=>{if(e.nodes&&0===e.nodes.length&&void 0!==(t=e.raws.after))return!1}),t}rawIndent(e){let t;return e.raws.indent?e.raws.indent:(e.walk(r=>{let n=r.parent;if(n&&n!==e&&n.parent&&n.parent===e&&void 0!==r.raws.before){let e=r.raws.before.split("\n");return t=(t=e[e.length-1]).replace(/\S/g,""),!1}}),t)}rawSemicolon(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&void 0!==(t=e.raws.semicolon))return!1}),t}rawValue(e,t){let r=e[t],n=e.raws[t];return n&&n.value===r?n.raw:r}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};function sQ(e,t){new sX(t).stringify(e)}sX.default=sX,sQ.default=sQ;let{isClean:s0,my:s1}=sH,s2=class{constructor(e={}){for(let t in this.raws={},this[s0]=!1,this[s1]=!0,e)if("nodes"===t)for(let r of(this.nodes=[],e[t]))"function"==typeof r.clone?this.append(r.clone()):this.append(r);else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=function e(t,r){let n=new t.constructor;for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i)||"proxyCache"===i)continue;let s=t[i],o=typeof s;"parent"===i&&"object"===o?r&&(n[i]=r):"source"===i?n[i]=s:Array.isArray(s)?n[i]=s.map(t=>e(t,n)):("object"===o&&null!==s&&(s=e(s)),n[i]=s)}return n}(this);for(let r in e)t[r]=e[r];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:r,start:n}=this.rangeBy(t);return this.source.input.error(e,{column:n.column,line:n.line},{column:r.column,line:r.line},t)}return new s$(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,r)=>e[t]===r||(e[t]=r,("prop"===t||"value"===t||"name"===t||"params"===t||"important"===t||"text"===t)&&e.markDirty(),!0)}}markDirty(){if(this[s0]){this[s0]=!1;let e=this;for(;e=e.parent;)e[s0]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let r=this.source.start;if(e.index)r=this.positionInside(e.index,t);else if(e.word){let n=(t=this.toString()).indexOf(e.word);-1!==n&&(r=this.positionInside(n,t))}return r}positionInside(e,t){let r=t||this.toString(),n=this.source.start.column,i=this.source.start.line;for(let t=0;t<e;t++)"\n"===r[t]?(n=1,i+=1):n+=1;return{column:n,line:i}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},r=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let n=this.toString(),i=n.indexOf(e.word);-1!==i&&(t=this.positionInside(i,n),r=this.positionInside(i+e.word.length,n))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?r={column:e.end.column,line:e.end.line}:"number"==typeof e.endIndex?r=this.positionInside(e.endIndex):e.index&&(r=this.positionInside(e.index+1));return(r.line<t.line||r.line===t.line&&r.column<=t.column)&&(r={column:t.column+1,line:t.line}),{end:r,start:t}}raw(e,t){return new sX().raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,r=!1;for(let n of e)n===this?r=!0:r?(this.parent.insertAfter(t,n),t=n):this.parent.insertBefore(t,n);r||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let r={},n=null==t;t=t||new Map;let i=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e)||"parent"===e||"proxyCache"===e)continue;let n=this[e];if(Array.isArray(n))r[e]=n.map(e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e);else if("object"==typeof n&&n.toJSON)r[e]=n.toJSON(null,t);else if("source"===e){let s=t.get(n.input);null==s&&(s=i,t.set(n.input,i),i++),r[e]={end:n.end,inputId:s,start:n.start}}else r[e]=n}return n&&(r.inputs=[...t.keys()].map(e=>e.toJSON())),r}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=sQ){e.stringify&&(e=e.stringify);let t="";return e(this,e=>{t+=e}),t}warn(e,t,r){let n={node:this};for(let e in r)n[e]=r[e];return e.warn(t,n)}get proxyOf(){return this}};s2.default=s2;let s3=s2,s4=class extends s3{constructor(e){e&&void 0!==e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};s4.default=s4;let{SourceMapConsumer:s5,SourceMapGenerator:s6}=sZ,{existsSync:s8,readFileSync:s9}=sZ,{dirname:s7,join:oe}=sZ,ot=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let r=t.map?t.map.prev:void 0,n=this.loadMap(t.from,r);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=s7(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new s5(this.text)),this.consumerCache}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e)){var t;return t=e.substr(RegExp.lastMatch.length),i5.Buffer.from(t,"base64").toString()}throw Error("Unsupported source map encoding "+e.match(/data:application\/json;([^,]+),/)[1])}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let r=e.lastIndexOf(t.pop()),n=e.indexOf("*/",r);r>-1&&n>-1&&(this.annotation=this.getAnnotationURL(e.substring(r,n)))}loadFile(e){if(this.root=s7(e),s8(e))return this.mapFile=e,s9(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t)if("string"==typeof t)return t;else if("function"==typeof t){let r=t(e);if(r){let e=this.loadFile(r);if(!e)throw Error("Unable to load previous source map: "+r.toString());return e}}else if(t instanceof s5)return s6.fromSourceMap(t).toString();else if(t instanceof s6)return t.toString();else if(this.isMap(t))return JSON.stringify(t);else throw Error("Unsupported previous source map format: "+t.toString());else if(this.inline)return this.decodeInline(this.annotation);else if(this.annotation){let t=this.annotation;return e&&(t=oe(s7(e),t)),this.loadFile(t)}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};ot.default=ot;let{SourceMapConsumer:or,SourceMapGenerator:on}=sZ,{fileURLToPath:oi,pathToFileURL:os}=sZ,{isAbsolute:oo,resolve:oa}=sZ,{nanoid:ol}={nanoid:(e=21)=>{let t="",r=e;for(;r--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t},customAlphabet:(e,t=21)=>(r=t)=>{let n="",i=r;for(;i--;)n+=e[Math.random()*e.length|0];return n}},ou=Symbol("fromOffsetCache"),oc=!!(or&&on),oh=!!(oa&&oo),od=class{constructor(e,t={}){if(null==e||"object"==typeof e&&!e.toString)throw Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\uFEFF"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!oh||/^\w+:\/\//.test(t.from)||oo(t.from)?this.file=t.from:this.file=oa(t.from)),oh&&oc){let e=new ot(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+ol(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,r,n={}){let i,s,o;if(t&&"object"==typeof t){let e=t,n=r;if("number"==typeof e.offset){let n=this.fromOffset(e.offset);t=n.line,r=n.col}else t=e.line,r=e.column;if("number"==typeof n.offset){let e=this.fromOffset(n.offset);s=e.line,o=e.col}else s=n.line,o=n.column}else if(!r){let e=this.fromOffset(t);t=e.line,r=e.col}let a=this.origin(t,r,s,o);return(i=a?new s$(e,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,n.plugin):new s$(e,void 0===s?t:{column:r,line:t},void 0===s?r:{column:o,line:s},this.css,this.file,n.plugin)).input={column:r,endColumn:o,endLine:s,line:t,source:this.css},this.file&&(os&&(i.input.url=os(this.file).toString()),i.input.file=this.file),i}fromOffset(e){let t,r;if(this[ou])r=this[ou];else{let e=this.css.split("\n");r=Array(e.length);let t=0;for(let n=0,i=e.length;n<i;n++)r[n]=t,t+=e[n].length+1;this[ou]=r}t=r[r.length-1];let n=0;if(e>=t)n=r.length-1;else{let t,i=r.length-2;for(;n<i;)if(e<r[t=n+(i-n>>1)])i=t-1;else if(e>=r[t+1])n=t+1;else{n=t;break}}return{col:e-r[n]+1,line:n+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:oa(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,r,n){let i,s;if(!this.map)return!1;let o=this.map.consumer(),a=o.originalPositionFor({column:t,line:e});if(!a.source)return!1;"number"==typeof r&&(i=o.originalPositionFor({column:n,line:r})),s=oo(a.source)?os(a.source):new URL(a.source,this.map.consumer().sourceRoot||os(this.map.mapFile));let l={column:a.column,endColumn:i&&i.column,endLine:i&&i.line,line:a.line,url:s.toString()};if("file:"===s.protocol)if(oi)l.file=oi(s);else throw Error("file: protocol is not available in this PostCSS build");let u=o.sourceContentFor(a.source);return u&&(l.source=u),l}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};od.default=od,sZ&&sZ.registerInput&&sZ.registerInput(od);let{SourceMapConsumer:op,SourceMapGenerator:of}=sZ,{dirname:og,relative:om,resolve:ov,sep:oy}=sZ,{pathToFileURL:ob}=sZ,ow=!!(op&&of),o_=!!(og&&ov&&om&&oy),oS=class{constructor(e,t,r,n){this.stringify=e,this.mapOpts=r.map||{},this.root=t,this.opts=r,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t,r=this.toUrl(this.path(e.file)),n=e.root||og(e.file);!1===this.mapOpts.sourcesContent?(t=new op(e.text)).sourcesContent&&(t.sourcesContent=null):t=e.consumer(),this.map.applySourceMap(t,r,this.toUrl(this.path(n)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)"comment"===(e=this.root.nodes[t]).type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),o_&&ow&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=of.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new of({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return(this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline())?[this.css]:[this.css,this.map]}generateString(){let e,t;this.css="",this.map=new of({file:this.outputFile(),ignoreInvalidMapping:!0});let r=1,n=1,i="<no source>",s={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(o,a,l)=>{if(this.css+=o,a&&"end"!==l&&(s.generated.line=r,s.generated.column=n-1,a.source&&a.source.start?(s.source=this.sourcePath(a),s.original.line=a.source.start.line,s.original.column=a.source.start.column-1):(s.source=i,s.original.line=1,s.original.column=0),this.map.addMapping(s)),(e=o.match(/\n/g))?(r+=e.length,t=o.lastIndexOf("\n"),n=o.length-t):n+=o.length,a&&"start"!==l){let e=a.parent||{raws:{}};(!("decl"===a.type||"atrule"===a.type&&!a.nodes)||a!==e.last||e.raws.semicolon)&&(a.source&&a.source.end?(s.source=this.sourcePath(a),s.original.line=a.source.end.line,s.original.column=a.source.end.column-1,s.generated.line=r,s.generated.column=n-2):(s.source=i,s.original.line=1,s.original.column=0,s.generated.line=r,s.generated.column=n-1),this.map.addMapping(s))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(e=>e.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(void 0===e||!0===e)&&(!this.previous().length||this.previous().some(e=>e.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(e=>e.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||60===e.charCodeAt(0)||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let r=this.opts.to?og(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(r=og(ov(r,this.mapOpts.annotation)));let n=om(r,e);return this.memoizedPaths.set(e,n),n}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new od(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let r=t.source.input.from;if(r&&!e[r]){e[r]=!0;let n=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(n,t.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return i5.Buffer.from(e).toString("base64")}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(ob){let t=ob(e).toString();return this.memoizedFileURLs.set(e,t),t}throw Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===oy&&(e=e.replace(/\\/g,"/"));let r=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,r),r}},oI=s2,oC=class extends oI{constructor(e){super(e),this.type="comment"}};oC.default=oC;let{isClean:oE,my:ok}=sH,ox=s2,oO=class e extends ox{append(...e){for(let t of e)for(let e of this.normalize(t,this.last))this.proxyOf.nodes.push(e);return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){let t,r;if(!this.proxyOf.nodes)return;let n=this.getIterator();for(;this.indexes[n]<this.proxyOf.nodes.length&&(t=this.indexes[n],!1!==(r=e(this.proxyOf.nodes[t],t)));)this.indexes[n]+=1;return delete this.indexes[n],r}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get(e,t){if("proxyOf"===t)return e;if(!e[t])return e[t];if("each"===t||"string"==typeof t&&t.startsWith("walk"))return(...r)=>e[t](...r.map(e=>"function"==typeof e?(t,r)=>e(t.toProxy(),r):e));if("every"===t||"some"===t)return r=>e[t]((e,...t)=>r(e.toProxy(),...t));if("root"===t)return()=>e.root().toProxy();else if("nodes"===t)return e.nodes.map(e=>e.toProxy());else if("first"===t||"last"===t)return e[t].toProxy();else return e[t]},set:(e,t,r)=>e[t]===r||(e[t]=r,("name"===t||"params"===t||"selector"===t)&&e.markDirty(),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let r,n=this.index(e),i=this.normalize(t,this.proxyOf.nodes[n]).reverse();for(let t of(n=this.index(e),i))this.proxyOf.nodes.splice(n+1,0,t);for(let e in this.indexes)n<(r=this.indexes[e])&&(this.indexes[e]=r+i.length);return this.markDirty(),this}insertBefore(e,t){let r,n=this.index(e),i=0===n&&"prepend",s=this.normalize(t,this.proxyOf.nodes[n],i).reverse();for(let t of(n=this.index(e),s))this.proxyOf.nodes.splice(n,0,t);for(let e in this.indexes)n<=(r=this.indexes[e])&&(this.indexes[e]=r+s.length);return this.markDirty(),this}normalize(t,r){if("string"==typeof t)t=function e(t){return t.map(t=>(t.nodes&&(t.nodes=e(t.nodes)),delete t.source,t))}(n(t).nodes);else if(void 0===t)t=[];else if(Array.isArray(t))for(let e of t=t.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if("root"===t.type&&"document"!==this.type)for(let e of t=t.nodes.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if(t.type)t=[t];else if(t.prop){if(void 0===t.value)throw Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new s4(t)]}else if(t.selector)t=[new i(t)];else if(t.name)t=[new s(t)];else if(t.text)t=[new oC(t)];else throw Error("Unknown node type in node creation");return t.map(t=>(t[ok]||e.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[oE]&&function e(t){if(t[oE]=!1,t.proxyOf.nodes)for(let r of t.proxyOf.nodes)e(r)}(t),void 0===t.raws.before&&r&&void 0!==r.raws.before&&(t.raws.before=r.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...e){for(let t of e=e.reverse()){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;for(let r in e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1),this.indexes)(t=this.indexes[r])>=e&&(this.indexes[r]=t-1);return this.markDirty(),this}replaceValues(e,t,r){return r||(r=t,t={}),this.walkDecls(n=>{t.props&&!t.props.includes(n.prop)||(!t.fast||n.value.includes(t.fast))&&(n.value=n.value.replace(e,r))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,r)=>{let n;try{n=e(t,r)}catch(e){throw t.addToError(e)}return!1!==n&&t.walk&&(n=t.walk(e)),n})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("atrule"===r.type&&e.test(r.name))return t(r,n)}):this.walk((r,n)=>{if("atrule"===r.type&&r.name===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("atrule"===e.type)return t(e,r)}))}walkComments(e){return this.walk((t,r)=>{if("comment"===t.type)return e(t,r)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("decl"===r.type&&e.test(r.prop))return t(r,n)}):this.walk((r,n)=>{if("decl"===r.type&&r.prop===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("decl"===e.type)return t(e,r)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("rule"===r.type&&e.test(r.selector))return t(r,n)}):this.walk((r,n)=>{if("rule"===r.type&&r.selector===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("rule"===e.type)return t(e,r)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};oO.registerParse=e=>{n=e},oO.registerRule=e=>{i=e},oO.registerAtRule=e=>{s=e},oO.registerRoot=e=>{o=e},oO.default=oO,oO.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,s.prototype):"rule"===e.type?Object.setPrototypeOf(e,i.prototype):"decl"===e.type?Object.setPrototypeOf(e,s4.prototype):"comment"===e.type?Object.setPrototypeOf(e,oC.prototype):"root"===e.type&&Object.setPrototypeOf(e,o.prototype),e[ok]=!0,e.nodes&&e.nodes.forEach(e=>{oO.rebuild(e)})};let oR=oO,oT=class extends oR{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new a(new l,this,e).stringify()}};oT.registerLazyResult=e=>{a=e},oT.registerProcessor=e=>{l=e},oT.default=oT;let oA=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};oA.default=oA;let oM=class{constructor(e,t,r){this.processor=e,this.messages=[],this.root=t,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){!t.plugin&&this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let r=new oA(e,t);return this.messages.push(r),r}warnings(){return this.messages.filter(e=>"warning"===e.type)}get content(){return this.css}};oM.default=oM;let oP=/[\t\n\f\r "#'()/;[\\\]{}]/g,oN=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,oD=/.[\r\n"'(/\\]/,oL=/[\da-f]/i,oU=oO,oF=class extends oU{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};oF.default=oF,oU.registerAtRule(oF);let oj=oO,oB=class extends oj{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,r){let n=super.normalize(e);if(t){if("prepend"===r)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of n)e.raws.before=t.raws.before}return n}removeChild(e,t){let r=this.index(e);return!t&&0===r&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(e)}toResult(e={}){return new u(new c,this,e).stringify()}};oB.registerLazyResult=e=>{u=e},oB.registerProcessor=e=>{c=e},oB.default=oB,oj.registerRoot(oB);let oq={comma:e=>oq.split(e,[","],!0),space:e=>oq.split(e,[" ","\n","	"]),split(e,t,r){let n=[],i="",s=!1,o=0,a=!1,l="",u=!1;for(let r of e)u?u=!1:"\\"===r?u=!0:a?r===l&&(a=!1):'"'===r||"'"===r?(a=!0,l=r):"("===r?o+=1:")"===r?o>0&&(o-=1):0===o&&t.includes(r)&&(s=!0),s?(""!==i&&n.push(i.trim()),i="",s=!1):i+=r;return(r||""!==i)&&n.push(i.trim()),n}};oq.default=oq;let oz=oO,oV=class extends oz{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return oq.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,r=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(r)}};oV.default=oV,oz.registerRule(oV);let oW=function(e,t={}){let r,n,i,s,o,a,l,u,c,h,d=e.css.valueOf(),p=t.ignoreErrors,f=d.length,g=0,m=[],v=[];function y(t){throw e.error("Unclosed "+t,g)}return{back:function(e){v.push(e)},endOfFile:function(){return 0===v.length&&g>=f},nextToken:function(e){if(v.length)return v.pop();if(g>=f)return;let t=!!e&&e.ignoreUnclosed;switch(r=d.charCodeAt(g)){case 10:case 32:case 9:case 13:case 12:n=g;do n+=1,r=d.charCodeAt(n);while(32===r||10===r||9===r||13===r||12===r)h=["space",d.slice(g,n)],g=n-1;break;case 91:case 93:case 123:case 125:case 58:case 59:case 41:{let e=String.fromCharCode(r);h=[e,e,g];break}case 40:if(u=m.length?m.pop()[1]:"",c=d.charCodeAt(g+1),"url"===u&&39!==c&&34!==c&&32!==c&&10!==c&&9!==c&&12!==c&&13!==c){n=g;do{if(a=!1,-1===(n=d.indexOf(")",n+1)))if(p||t){n=g;break}else y("bracket");for(l=n;92===d.charCodeAt(l-1);)l-=1,a=!a}while(a)h=["brackets",d.slice(g,n+1),g,n],g=n}else n=d.indexOf(")",g+1),s=d.slice(g,n+1),-1===n||oD.test(s)?h=["(","(",g]:(h=["brackets",s,g,n],g=n);break;case 39:case 34:i=39===r?"'":'"',n=g;do{if(a=!1,-1===(n=d.indexOf(i,n+1)))if(p||t){n=g+1;break}else y("string");for(l=n;92===d.charCodeAt(l-1);)l-=1,a=!a}while(a)h=["string",d.slice(g,n+1),g,n],g=n;break;case 64:oP.lastIndex=g+1,oP.test(d),n=0===oP.lastIndex?d.length-1:oP.lastIndex-2,h=["at-word",d.slice(g,n+1),g,n],g=n;break;case 92:for(n=g,o=!0;92===d.charCodeAt(n+1);)n+=1,o=!o;if(r=d.charCodeAt(n+1),o&&47!==r&&32!==r&&10!==r&&9!==r&&13!==r&&12!==r&&(n+=1,oL.test(d.charAt(n)))){for(;oL.test(d.charAt(n+1));)n+=1;32===d.charCodeAt(n+1)&&(n+=1)}h=["word",d.slice(g,n+1),g,n],g=n;break;default:47===r&&42===d.charCodeAt(g+1)?(0===(n=d.indexOf("*/",g+2)+1)&&(p||t?n=d.length:y("comment")),h=["comment",d.slice(g,n+1),g,n]):(oN.lastIndex=g+1,oN.test(d),n=0===oN.lastIndex?d.length-1:oN.lastIndex-2,h=["word",d.slice(g,n+1),g,n],m.push(h)),g=n}return g++,h},position:function(){return g}}},oG={empty:!0,space:!0},oK=class{constructor(e){this.input=e,this.root=new oB,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t,r,n,i=new oF;i.name=e[1].slice(1),""===i.name&&this.unnamedAtrule(i,e),this.init(i,e[2]);let s=!1,o=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if("("===(t=(e=this.tokenizer.nextToken())[0])||"["===t?l.push("("===t?")":"]"):"{"===t&&l.length>0?l.push("}"):t===l[l.length-1]&&l.pop(),0===l.length)if(";"===t){i.source.end=this.getPosition(e[2]),i.source.end.offset++,this.semicolon=!0;break}else if("{"===t){o=!0;break}else if("}"===t){if(a.length>0){for(n=a.length-1,r=a[n];r&&"space"===r[0];)r=a[--n];r&&(i.source.end=this.getPosition(r[3]||r[2]),i.source.end.offset++)}this.end(e);break}else a.push(e);else a.push(e);if(this.tokenizer.endOfFile()){s=!0;break}}i.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(i.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(i,"params",a),s&&(e=a[a.length-1],i.source.end=this.getPosition(e[3]||e[2]),i.source.end.offset++,this.spaces=i.raws.between,i.raws.between="")):(i.raws.afterName="",i.params=""),o&&(i.nodes=[],this.current=i)}checkMissedSemicolon(e){let t,r=this.colon(e);if(!1===r)return;let n=0;for(let i=r-1;i>=0&&("space"===(t=e[i])[0]||2!==(n+=1));i--);throw this.input.error("Missed semicolon","word"===t[0]?t[3]+1:t[2])}colon(e){let t,r,n=0;for(let[i,s]of e.entries()){if("("===(t=s[0])&&(n+=1),")"===t&&(n-=1),0===n&&":"===t)if(r)if("word"===r[0]&&"progid"===r[1])continue;else return i;else this.doubleColon(s);r=s}return!1}comment(e){let t=new oC;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let r=e[1].slice(2,-2);if(/^\s*$/.test(r))t.text="",t.raws.left=r,t.raws.right="";else{let e=r.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=oW(this.input)}decl(e,t){let r,n,i=new s4;this.init(i,e[0][2]);let s=e[e.length-1];for(";"===s[0]&&(this.semicolon=!0,e.pop()),i.source.end=this.getPosition(s[3]||s[2]||function(e){for(let t=e.length-1;t>=0;t--){let r=e[t],n=r[3]||r[2];if(n)return n}}(e)),i.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),i.raws.before+=e.shift()[1];for(i.source.start=this.getPosition(e[0][2]),i.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;i.prop+=e.shift()[1]}for(i.raws.between="";e.length;){if(":"===(r=e.shift())[0]){i.raws.between+=r[1];break}"word"===r[0]&&/\w/.test(r[1])&&this.unknownWord([r]),i.raws.between+=r[1]}("_"===i.prop[0]||"*"===i.prop[0])&&(i.raws.before+=i.prop[0],i.prop=i.prop.slice(1));let o=[];for(;e.length&&("space"===(n=e[0][0])||"comment"===n);)o.push(e.shift());this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if("!important"===(r=e[t])[1].toLowerCase()){i.important=!0;let r=this.stringFrom(e,t);" !important"!==(r=this.spacesFromEnd(e)+r)&&(i.raws.important=r);break}if("important"===r[1].toLowerCase()){let r=e.slice(0),n="";for(let e=t;e>0;e--){let t=r[e][0];if(0===n.trim().indexOf("!")&&"space"!==t)break;n=r.pop()[1]+n}0===n.trim().indexOf("!")&&(i.important=!0,i.raws.important=n,e=r)}if("space"!==r[0]&&"comment"!==r[0])break}e.some(e=>"space"!==e[0]&&"comment"!==e[0])&&(i.raws.between+=o.map(e=>e[1]).join(""),o=[]),this.raw(i,"value",o.concat(e),t),i.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new oV;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,r=null,n=!1,i=null,s=[],o=e[1].startsWith("--"),a=[],l=e;for(;l;){if(r=l[0],a.push(l),"("===r||"["===r)i||(i=l),s.push("("===r?")":"]");else if(o&&n&&"{"===r)i||(i=l),s.push("}");else if(0===s.length)if(";"===r)if(n)return void this.decl(a,o);else break;else if("{"===r)return void this.rule(a);else if("}"===r){this.tokenizer.back(a.pop()),t=!0;break}else":"===r&&(n=!0);else r===s[s.length-1]&&(s.pop(),0===s.length&&(i=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),s.length>0&&this.unclosedBracket(i),t&&n){if(!o)for(;a.length&&("space"===(l=a[a.length-1][0])||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,o)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch((e=this.tokenizer.nextToken())[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,r,n){let i,s,o,a,l=r.length,u="",c=!0;for(let e=0;e<l;e+=1)"space"!==(s=(i=r[e])[0])||e!==l-1||n?"comment"===s?(a=r[e-1]?r[e-1][0]:"empty",o=r[e+1]?r[e+1][0]:"empty",oG[a]||oG[o]||","===u.slice(-1)?c=!1:u+=i[1]):u+=i[1]:c=!1;if(!c){let n=r.reduce((e,t)=>e+t[1],"");e.raws[t]={raw:n,value:u}}e[t]=u}rule(e){e.pop();let t=new oV;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,r="";for(;e.length&&("space"===(t=e[e.length-1][0])||"comment"===t);)r=e.pop()[1]+r;return r}spacesAndCommentsFromStart(e){let t,r="";for(;e.length&&("space"===(t=e[0][0])||"comment"===t);)r+=e.shift()[1];return r}spacesFromEnd(e){let t="";for(;e.length&&"space"===e[e.length-1][0];)t=e.pop()[1]+t;return t}stringFrom(e,t){let r="";for(let n=t;n<e.length;n++)r+=e[n][1];return e.splice(t,e.length-t),r}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}};function oY(e,t){let r=new oK(new od(e,t));try{r.parse()}catch(e){throw e}return r.root}oY.default=oY,oO.registerParse(oY);let{isClean:oZ,my:o$}=sH,oH={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},oJ={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},oX={Once:!0,postcssPlugin:!0,prepare:!0};function oQ(e){return"object"==typeof e&&"function"==typeof e.then}function o0(e){let t=!1,r=oH[e.type];return("decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append)?[r,r+"-"+t,0,r+"Exit",r+"Exit-"+t]:t?[r,r+"-"+t,r+"Exit",r+"Exit-"+t]:e.append?[r,0,r+"Exit"]:[r,r+"Exit"]}function o1(e){return{eventIndex:0,events:"document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:o0(e),iterator:0,node:e,visitorIndex:0,visitors:[]}}function o2(e){return e[oZ]=!1,e.nodes&&e.nodes.forEach(e=>o2(e)),e}let o3={},o4=class e{constructor(t,r,n){let i;if(this.stringified=!1,this.processed=!1,"object"==typeof r&&null!==r&&("root"===r.type||"document"===r.type))i=o2(r);else if(r instanceof e||r instanceof oM)i=o2(r.root),r.map&&(void 0===n.map&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=r.map);else{let e=oY;n.syntax&&(e=n.syntax.parse),n.parser&&(e=n.parser),e.parse&&(e=e.parse);try{i=e(r,n)}catch(e){this.processed=!0,this.error=e}i&&!i[o$]&&oO.rebuild(i)}this.result=new oM(t,i,n),this.helpers={...o3,postcss:o3,result:this.result},this.plugins=this.processor.plugins.map(e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let r=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin?r.postcssVersion:(e.plugin=r.postcssPlugin,e.setMessage())}catch(e){console&&console.error&&console.error(e)}return e}prepareVisitors(){this.listeners={};let e=(e,t,r)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,r])};for(let t of this.plugins)if("object"==typeof t)for(let r in t){if(!oJ[r]&&/^[A-Z]/.test(r))throw Error(`Unknown event ${r} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!oX[r])if("object"==typeof t[r])for(let n in t[r])e(t,"*"===n?r:r+"-"+n.toLowerCase(),t[r][n]);else"function"==typeof t[r]&&e(t,r,t[r])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],r=this.runOnRoot(t);if(oQ(r))try{await r}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[oZ];){e[oZ]=!0;let t=[o1(e)];for(;t.length>0;){let e=this.visitTick(t);if(oQ(e))try{await e}catch(r){let e=t[t.length-1].node;throw this.handleError(r,e)}}}if(this.listeners.OnceExit)for(let[t,r]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map(e=>r(e,this.helpers));await Promise.all(t)}else await r(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map(t=>e.Once(t,this.helpers));if(oQ(t[0]))return Promise.all(t);return t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=sQ;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let r=new oS(t,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins)if(oQ(this.runOnRoot(e)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[oZ];)e[oZ]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[r,n]of e){let e;this.result.lastPlugin=r;try{e=n(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(oQ(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:r,visitors:n}=t;if("root"!==r.type&&"document"!==r.type&&!r.parent)return void e.pop();if(n.length>0&&t.visitorIndex<n.length){let[e,i]=n[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===n.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return i(r.toProxy(),this.helpers)}catch(e){throw this.handleError(e,r)}}if(0!==t.iterator){let n,i=t.iterator;for(;n=r.nodes[r.indexes[i]];)if(r.indexes[i]+=1,!n[oZ]){n[oZ]=!0,e.push(o1(n));return}t.iterator=0,delete r.indexes[i]}let i=t.events;for(;t.eventIndex<i.length;){let e=i[t.eventIndex];if(t.eventIndex+=1,0===e){r.nodes&&r.nodes.length&&(r[oZ]=!0,t.iterator=r.getIterator());return}if(this.listeners[e]){t.visitors=this.listeners[e];return}}e.pop()}walkSync(e){for(let t of(e[oZ]=!0,o0(e)))if(0===t)e.nodes&&e.each(e=>{e[oZ]||this.walkSync(e)});else{let r=this.listeners[t];if(r&&this.visitSync(r,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};o4.registerPostcss=e=>{o3=e},o4.default=o4,oB.registerLazyResult(o4),oT.registerLazyResult(o4);let o5=class{constructor(e,t,r){let n;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=r,this._map=void 0,this.result=new oM(this._processor,n,this._opts),this.result.css=t;let i=this;Object.defineProperty(this.result,"root",{get:()=>i.root});let s=new oS(sQ,n,this._opts,t);if(s.isMap()){let[e,t]=s.generate();e&&(this.result.css=e),t&&(this.result.map=t)}else s.clearAnnotation(),this.result.css=s.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){let e;if(this._root)return this._root;try{e=oY(this._css,this._opts)}catch(e){this.error=e}if(!this.error)return this._root=e,e;throw this.error}get[Symbol.toStringTag](){return"NoWorkResult"}};o5.default=o5;let o6=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let r of e)if(!0===r.postcss?r=r():r.postcss&&(r=r.postcss),"object"==typeof r&&Array.isArray(r.plugins))t=t.concat(r.plugins);else if("object"==typeof r&&r.postcssPlugin)t.push(r);else if("function"==typeof r)t.push(r);else if("object"==typeof r&&(r.parse||r.stringify));else throw Error(r+" is not a PostCSS plugin");return t}process(e,t={}){return this.plugins.length||t.parser||t.stringifier||t.syntax?new o4(this,e,t):new o5(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};function o8(e,t){if(Array.isArray(e))return e.map(e=>o8(e));let{inputs:r,...n}=e;if(r)for(let e of(t=[],r)){let r={...e,__proto__:od.prototype};r.map&&(r.map={...r.map,__proto__:ot.prototype}),t.push(r)}if(n.nodes&&(n.nodes=e.nodes.map(e=>o8(e,t))),n.source){let{inputId:e,...r}=n.source;n.source=r,null!=e&&(n.source.input=t[e])}if("root"===n.type)return new oB(n);if("decl"===n.type)return new s4(n);if("rule"===n.type)return new oV(n);if("comment"===n.type)return new oC(n);if("atrule"===n.type)return new oF(n);else throw Error("Unknown node type: "+e.type)}function o9(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new o6(e)}o6.default=o6,oB.registerProcessor(o6),oT.registerProcessor(o6),o8.default=o8,o9.plugin=function(e,t){let r,n=!1;function i(...r){console&&console.warn&&!n&&(n=!0,console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),i6.default.env.LANG&&i6.default.env.LANG.startsWith("cn")&&console.warn(e+":  postcss.plugin . :\nhttps://www.w3ctech.com/topic/2226"));let s=t(...r);return s.postcssPlugin=e,s.postcssVersion=new o6().version,s}return Object.defineProperty(i,"postcss",{get:()=>(r||(r=i()),r)}),i.process=function(e,t,r){return o9([i(r)]).process(e,t)},i},o9.stringify=sQ,o9.parse=oY,o9.fromJSON=o8,o9.list=oq,o9.comment=e=>new oC(e),o9.atRule=e=>new oF(e),o9.decl=e=>new s4(e),o9.rule=e=>new oV(e),o9.root=e=>new oB(e),o9.document=e=>new oT(e),o9.CssSyntaxError=s$,o9.Declaration=s4,o9.Container=oO,o9.Processor=o6,o9.Document=oT,o9.Comment=oC,o9.Warning=oA,o9.AtRule=oF,o9.Result=oM,o9.Input=od,o9.Rule=oV,o9.Root=oB,o9.Node=s2,o4.registerPostcss(o9),o9.default=o9;let o7=o9&&o9.__esModule&&Object.prototype.hasOwnProperty.call(o9,"default")?o9.default:o9;o7.stringify,o7.fromJSON,o7.plugin,o7.parse,o7.list,o7.document,o7.comment,o7.atRule,o7.rule,o7.decl,o7.root,o7.CssSyntaxError,o7.Declaration,o7.Container,o7.Processor,o7.Document,o7.Comment,o7.Warning,o7.AtRule,o7.Result,o7.Input,o7.Rule,o7.Root,o7.Node;var ae=Object.defineProperty,at=(e,t,r)=>{let n;return(n="symbol"!=typeof t?t+"":t)in e?ae(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r},ar={exports:{}},an=String,ai=function(){return{isColorSupported:!1,reset:an,bold:an,dim:an,italic:an,underline:an,inverse:an,hidden:an,strikethrough:an,black:an,red:an,green:an,yellow:an,blue:an,magenta:an,cyan:an,white:an,gray:an,bgBlack:an,bgRed:an,bgGreen:an,bgYellow:an,bgBlue:an,bgMagenta:an,bgCyan:an,bgWhite:an}};ar.exports=ai(),ar.exports.createColors=ai;var as=ar.exports;let ao=function(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))),aa=class e extends Error{constructor(t,r,n,i,s,o){super(t),this.name="CssSyntaxError",this.reason=t,s&&(this.file=s),i&&(this.source=i),o&&(this.plugin=o),void 0!==r&&void 0!==n&&("number"==typeof r?(this.line=r,this.column=n):(this.line=r.line,this.column=r.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,e)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(e){let t,r;if(!this.source)return"";let n=this.source;null==e&&(e=as.isColorSupported),ao&&e&&(n=ao(n));let i=n.split(/\r?\n/),s=Math.max(this.line-3,0),o=Math.min(this.line+2,i.length),a=String(o).length;if(e){let{bold:e,gray:n,red:i}=as.createColors(!0);t=t=>e(i(t)),r=e=>n(e)}else t=r=e=>e;return i.slice(s,o).map((e,n)=>{let i=s+1+n,o=" "+(" "+i).slice(-a)+" | ";if(i===this.line){let n=r(o.replace(/\d/g," "))+e.slice(0,this.column-1).replace(/[^\t]/g," ");return t(">")+r(o)+e+"\n "+n+t("^")}return" "+r(o)+e}).join("\n")}toString(){let e=this.showSourceCode();return e&&(e="\n\n"+e+"\n"),this.name+": "+this.message+e}};aa.default=aa;var al={};al.isClean=Symbol("isClean"),al.my=Symbol("my");let au={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1},ac=class{constructor(e){this.builder=e}atrule(e,t){let r="@"+e.name,n=e.params?this.rawValue(e,"params"):"";if(void 0!==e.raws.afterName?r+=e.raws.afterName:n&&(r+=" "),e.nodes)this.block(e,r+n);else{let i=(e.raws.between||"")+(t?";":"");this.builder(r+n+i,e)}}beforeAfter(e,t){let r;r="decl"===e.type?this.raw(e,null,"beforeDecl"):"comment"===e.type?this.raw(e,null,"beforeComment"):"before"===t?this.raw(e,null,"beforeRule"):this.raw(e,null,"beforeClose");let n=e.parent,i=0;for(;n&&"root"!==n.type;)i+=1,n=n.parent;if(r.includes("\n")){let t=this.raw(e,null,"indent");if(t.length)for(let e=0;e<i;e++)r+=t}return r}block(e,t){let r,n=this.raw(e,"between","beforeOpen");this.builder(t+n+"{",e,"start"),e.nodes&&e.nodes.length?(this.body(e),r=this.raw(e,"after")):r=this.raw(e,"after","emptyBody"),r&&this.builder(r),this.builder("}",e,"end")}body(e){let t=e.nodes.length-1;for(;t>0&&"comment"===e.nodes[t].type;)t-=1;let r=this.raw(e,"semicolon");for(let n=0;n<e.nodes.length;n++){let i=e.nodes[n],s=this.raw(i,"before");s&&this.builder(s),this.stringify(i,t!==n||r)}}comment(e){let t=this.raw(e,"left","commentLeft"),r=this.raw(e,"right","commentRight");this.builder("/*"+t+e.text+r+"*/",e)}decl(e,t){let r=this.raw(e,"between","colon"),n=e.prop+r+this.rawValue(e,"value");e.important&&(n+=e.raws.important||" !important"),t&&(n+=";"),this.builder(n,e)}document(e){this.body(e)}raw(e,t,r){let n;if(r||(r=t),t&&void 0!==(n=e.raws[t]))return n;let i=e.parent;if("before"===r&&(!i||"root"===i.type&&i.first===e||i&&"document"===i.type))return"";if(!i)return au[r];let s=e.root();if(s.rawCache||(s.rawCache={}),void 0!==s.rawCache[r])return s.rawCache[r];if("before"===r||"after"===r)return this.beforeAfter(e,r);{var o;let i="raw"+((o=r)[0].toUpperCase()+o.slice(1));this[i]?n=this[i](s,e):s.walk(e=>{if(void 0!==(n=e.raws[t]))return!1})}return void 0===n&&(n=au[r]),s.rawCache[r]=n,n}rawBeforeClose(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length>0&&void 0!==e.raws.after)return(t=e.raws.after).includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawBeforeComment(e,t){let r;return e.walkComments(e=>{if(void 0!==e.raws.before)return(r=e.raws.before).includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(t,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(e,t){let r;return e.walkDecls(e=>{if(void 0!==e.raws.before)return(r=e.raws.before).includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(t,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeOpen(e){let t;return e.walk(e=>{if("decl"!==e.type&&void 0!==(t=e.raws.between))return!1}),t}rawBeforeRule(e){let t;return e.walk(r=>{if(r.nodes&&(r.parent!==e||e.first!==r)&&void 0!==r.raws.before)return(t=r.raws.before).includes("\n")&&(t=t.replace(/[^\n]+$/,"")),!1}),t&&(t=t.replace(/\S/g,"")),t}rawColon(e){let t;return e.walkDecls(e=>{if(void 0!==e.raws.between)return t=e.raws.between.replace(/[^\s:]/g,""),!1}),t}rawEmptyBody(e){let t;return e.walk(e=>{if(e.nodes&&0===e.nodes.length&&void 0!==(t=e.raws.after))return!1}),t}rawIndent(e){let t;return e.raws.indent?e.raws.indent:(e.walk(r=>{let n=r.parent;if(n&&n!==e&&n.parent&&n.parent===e&&void 0!==r.raws.before){let e=r.raws.before.split("\n");return t=(t=e[e.length-1]).replace(/\S/g,""),!1}}),t)}rawSemicolon(e){let t;return e.walk(e=>{if(e.nodes&&e.nodes.length&&"decl"===e.last.type&&void 0!==(t=e.raws.semicolon))return!1}),t}rawValue(e,t){let r=e[t],n=e.raws[t];return n&&n.value===r?n.raw:r}root(e){this.body(e),e.raws.after&&this.builder(e.raws.after)}rule(e){this.block(e,this.rawValue(e,"selector")),e.raws.ownSemicolon&&this.builder(e.raws.ownSemicolon,e,"end")}stringify(e,t){if(!this[e.type])throw Error("Unknown AST node type "+e.type+". Maybe you need to change PostCSS stringifier.");this[e.type](e,t)}};function ah(e,t){new ac(t).stringify(e)}ac.default=ac,ah.default=ah;let{isClean:ad,my:ap}=al,af=class{constructor(e={}){for(let t in this.raws={},this[ad]=!1,this[ap]=!0,e)if("nodes"===t)for(let r of(this.nodes=[],e[t]))"function"==typeof r.clone?this.append(r.clone()):this.append(r);else this[t]=e[t]}addToError(e){if(e.postcssNode=this,e.stack&&this.source&&/\n\s{4}at /.test(e.stack)){let t=this.source;e.stack=e.stack.replace(/\n\s{4}at /,`$&${t.input.from}:${t.start.line}:${t.start.column}$&`)}return e}after(e){return this.parent.insertAfter(this,e),this}assign(e={}){for(let t in e)this[t]=e[t];return this}before(e){return this.parent.insertBefore(this,e),this}cleanRaws(e){delete this.raws.before,delete this.raws.after,e||delete this.raws.between}clone(e={}){let t=function e(t,r){let n=new t.constructor;for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i)||"proxyCache"===i)continue;let s=t[i],o=typeof s;"parent"===i&&"object"===o?r&&(n[i]=r):"source"===i?n[i]=s:Array.isArray(s)?n[i]=s.map(t=>e(t,n)):("object"===o&&null!==s&&(s=e(s)),n[i]=s)}return n}(this);for(let r in e)t[r]=e[r];return t}cloneAfter(e={}){let t=this.clone(e);return this.parent.insertAfter(this,t),t}cloneBefore(e={}){let t=this.clone(e);return this.parent.insertBefore(this,t),t}error(e,t={}){if(this.source){let{end:r,start:n}=this.rangeBy(t);return this.source.input.error(e,{column:n.column,line:n.line},{column:r.column,line:r.line},t)}return new aa(e)}getProxyProcessor(){return{get:(e,t)=>"proxyOf"===t?e:"root"===t?()=>e.root().toProxy():e[t],set:(e,t,r)=>e[t]===r||(e[t]=r,("prop"===t||"value"===t||"name"===t||"params"===t||"important"===t||"text"===t)&&e.markDirty(),!0)}}markDirty(){if(this[ad]){this[ad]=!1;let e=this;for(;e=e.parent;)e[ad]=!1}}next(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e+1]}positionBy(e,t){let r=this.source.start;if(e.index)r=this.positionInside(e.index,t);else if(e.word){let n=(t=this.toString()).indexOf(e.word);-1!==n&&(r=this.positionInside(n,t))}return r}positionInside(e,t){let r=t||this.toString(),n=this.source.start.column,i=this.source.start.line;for(let t=0;t<e;t++)"\n"===r[t]?(n=1,i+=1):n+=1;return{column:n,line:i}}prev(){if(!this.parent)return;let e=this.parent.index(this);return this.parent.nodes[e-1]}rangeBy(e){let t={column:this.source.start.column,line:this.source.start.line},r=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:t.column+1,line:t.line};if(e.word){let n=this.toString(),i=n.indexOf(e.word);-1!==i&&(t=this.positionInside(i,n),r=this.positionInside(i+e.word.length,n))}else e.start?t={column:e.start.column,line:e.start.line}:e.index&&(t=this.positionInside(e.index)),e.end?r={column:e.end.column,line:e.end.line}:"number"==typeof e.endIndex?r=this.positionInside(e.endIndex):e.index&&(r=this.positionInside(e.index+1));return(r.line<t.line||r.line===t.line&&r.column<=t.column)&&(r={column:t.column+1,line:t.line}),{end:r,start:t}}raw(e,t){return new ac().raw(this,e,t)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...e){if(this.parent){let t=this,r=!1;for(let n of e)n===this?r=!0:r?(this.parent.insertAfter(t,n),t=n):this.parent.insertBefore(t,n);r||this.remove()}return this}root(){let e=this;for(;e.parent&&"document"!==e.parent.type;)e=e.parent;return e}toJSON(e,t){let r={},n=null==t;t=t||new Map;let i=0;for(let e in this){if(!Object.prototype.hasOwnProperty.call(this,e)||"parent"===e||"proxyCache"===e)continue;let n=this[e];if(Array.isArray(n))r[e]=n.map(e=>"object"==typeof e&&e.toJSON?e.toJSON(null,t):e);else if("object"==typeof n&&n.toJSON)r[e]=n.toJSON(null,t);else if("source"===e){let s=t.get(n.input);null==s&&(s=i,t.set(n.input,i),i++),r[e]={end:n.end,inputId:s,start:n.start}}else r[e]=n}return n&&(r.inputs=[...t.keys()].map(e=>e.toJSON())),r}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(e=ah){e.stringify&&(e=e.stringify);let t="";return e(this,e=>{t+=e}),t}warn(e,t,r){let n={node:this};for(let e in r)n[e]=r[e];return e.warn(t,n)}get proxyOf(){return this}};af.default=af;let ag=af,am=class extends ag{constructor(e){e&&void 0!==e.value&&"string"!=typeof e.value&&(e={...e,value:String(e.value)}),super(e),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};am.default=am;let{SourceMapConsumer:av,SourceMapGenerator:ay}=ao,{existsSync:ab,readFileSync:aw}=ao,{dirname:a_,join:aS}=ao,aI=class{constructor(e,t){if(!1===t.map)return;this.loadAnnotation(e),this.inline=this.startWith(this.annotation,"data:");let r=t.map?t.map.prev:void 0,n=this.loadMap(t.from,r);!this.mapFile&&t.from&&(this.mapFile=t.from),this.mapFile&&(this.root=a_(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new av(this.text)),this.consumerCache}decodeInline(e){if(/^data:application\/json;charset=utf-?8,/.test(e)||/^data:application\/json,/.test(e))return decodeURIComponent(e.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(e)||/^data:application\/json;base64,/.test(e)){var t;return t=e.substr(RegExp.lastMatch.length),i5.Buffer.from(t,"base64").toString()}throw Error("Unsupported source map encoding "+e.match(/data:application\/json;([^,]+),/)[1])}getAnnotationURL(e){return e.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(e){return"object"==typeof e&&("string"==typeof e.mappings||"string"==typeof e._mappings||Array.isArray(e.sections))}loadAnnotation(e){let t=e.match(/\/\*\s*# sourceMappingURL=/gm);if(!t)return;let r=e.lastIndexOf(t.pop()),n=e.indexOf("*/",r);r>-1&&n>-1&&(this.annotation=this.getAnnotationURL(e.substring(r,n)))}loadFile(e){if(this.root=a_(e),ab(e))return this.mapFile=e,aw(e,"utf-8").toString().trim()}loadMap(e,t){if(!1===t)return!1;if(t)if("string"==typeof t)return t;else if("function"==typeof t){let r=t(e);if(r){let e=this.loadFile(r);if(!e)throw Error("Unable to load previous source map: "+r.toString());return e}}else if(t instanceof av)return ay.fromSourceMap(t).toString();else if(t instanceof ay)return t.toString();else if(this.isMap(t))return JSON.stringify(t);else throw Error("Unsupported previous source map format: "+t.toString());else if(this.inline)return this.decodeInline(this.annotation);else if(this.annotation){let t=this.annotation;return e&&(t=aS(a_(e),t)),this.loadFile(t)}}startWith(e,t){return!!e&&e.substr(0,t.length)===t}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};aI.default=aI;let{SourceMapConsumer:aC,SourceMapGenerator:aE}=ao,{fileURLToPath:ak,pathToFileURL:ax}=ao,{isAbsolute:aO,resolve:aR}=ao,{nanoid:aT}={nanoid:(e=21)=>{let t="",r=e;for(;r--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t},customAlphabet:(e,t=21)=>(r=t)=>{let n="",i=r;for(;i--;)n+=e[Math.random()*e.length|0];return n}},aA=Symbol("fromOffsetCache"),aM=!!(aC&&aE),aP=!!(aR&&aO),aN=class{constructor(e,t={}){if(null==e||"object"==typeof e&&!e.toString)throw Error(`PostCSS received ${e} instead of CSS string`);if(this.css=e.toString(),"\uFEFF"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,t.from&&(!aP||/^\w+:\/\//.test(t.from)||aO(t.from)?this.file=t.from:this.file=aR(t.from)),aP&&aM){let e=new aI(this.css,t);if(e.text){this.map=e;let t=e.consumer().file;!this.file&&t&&(this.file=this.mapResolve(t))}}this.file||(this.id="<input css "+aT(6)+">"),this.map&&(this.map.file=this.from)}error(e,t,r,n={}){let i,s,o;if(t&&"object"==typeof t){let e=t,n=r;if("number"==typeof e.offset){let n=this.fromOffset(e.offset);t=n.line,r=n.col}else t=e.line,r=e.column;if("number"==typeof n.offset){let e=this.fromOffset(n.offset);s=e.line,o=e.col}else s=n.line,o=n.column}else if(!r){let e=this.fromOffset(t);t=e.line,r=e.col}let a=this.origin(t,r,s,o);return(i=a?new aa(e,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,n.plugin):new aa(e,void 0===s?t:{column:r,line:t},void 0===s?r:{column:o,line:s},this.css,this.file,n.plugin)).input={column:r,endColumn:o,endLine:s,line:t,source:this.css},this.file&&(ax&&(i.input.url=ax(this.file).toString()),i.input.file=this.file),i}fromOffset(e){let t,r;if(this[aA])r=this[aA];else{let e=this.css.split("\n");r=Array(e.length);let t=0;for(let n=0,i=e.length;n<i;n++)r[n]=t,t+=e[n].length+1;this[aA]=r}t=r[r.length-1];let n=0;if(e>=t)n=r.length-1;else{let t,i=r.length-2;for(;n<i;)if(e<r[t=n+(i-n>>1)])i=t-1;else if(e>=r[t+1])n=t+1;else{n=t;break}}return{col:e-r[n]+1,line:n+1}}mapResolve(e){return/^\w+:\/\//.test(e)?e:aR(this.map.consumer().sourceRoot||this.map.root||".",e)}origin(e,t,r,n){let i,s;if(!this.map)return!1;let o=this.map.consumer(),a=o.originalPositionFor({column:t,line:e});if(!a.source)return!1;"number"==typeof r&&(i=o.originalPositionFor({column:n,line:r})),s=aO(a.source)?ax(a.source):new URL(a.source,this.map.consumer().sourceRoot||ax(this.map.mapFile));let l={column:a.column,endColumn:i&&i.column,endLine:i&&i.line,line:a.line,url:s.toString()};if("file:"===s.protocol)if(ak)l.file=ak(s);else throw Error("file: protocol is not available in this PostCSS build");let u=o.sourceContentFor(a.source);return u&&(l.source=u),l}toJSON(){let e={};for(let t of["hasBOM","css","file","id"])null!=this[t]&&(e[t]=this[t]);return this.map&&(e.map={...this.map},e.map.consumerCache&&(e.map.consumerCache=void 0)),e}get from(){return this.file||this.id}};aN.default=aN,ao&&ao.registerInput&&ao.registerInput(aN);let{SourceMapConsumer:aD,SourceMapGenerator:aL}=ao,{dirname:aU,relative:aF,resolve:aj,sep:aB}=ao,{pathToFileURL:aq}=ao,az=!!(aD&&aL),aV=!!(aU&&aj&&aF&&aB),aW=class{constructor(e,t,r,n){this.stringify=e,this.mapOpts=r.map||{},this.root=t,this.opts=r,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let e;e=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let t="\n";this.css.includes("\r\n")&&(t="\r\n"),this.css+=t+"/*# sourceMappingURL="+e+" */"}applyPrevMaps(){for(let e of this.previous()){let t,r=this.toUrl(this.path(e.file)),n=e.root||aU(e.file);!1===this.mapOpts.sourcesContent?(t=new aD(e.text)).sourcesContent&&(t.sourcesContent=null):t=e.consumer(),this.map.applySourceMap(t,r,this.toUrl(this.path(n)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let e;for(let t=this.root.nodes.length-1;t>=0;t--)"comment"===(e=this.root.nodes[t]).type&&0===e.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(t)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),aV&&az&&this.isMap())return this.generateMap();{let e="";return this.stringify(this.root,t=>{e+=t}),[e]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let e=this.previous()[0].consumer();e.file=this.outputFile(),this.map=aL.fromSourceMap(e,{ignoreInvalidMapping:!0})}else this.map=new aL({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return(this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline())?[this.css]:[this.css,this.map]}generateString(){let e,t;this.css="",this.map=new aL({file:this.outputFile(),ignoreInvalidMapping:!0});let r=1,n=1,i="<no source>",s={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(o,a,l)=>{if(this.css+=o,a&&"end"!==l&&(s.generated.line=r,s.generated.column=n-1,a.source&&a.source.start?(s.source=this.sourcePath(a),s.original.line=a.source.start.line,s.original.column=a.source.start.column-1):(s.source=i,s.original.line=1,s.original.column=0),this.map.addMapping(s)),(e=o.match(/\n/g))?(r+=e.length,t=o.lastIndexOf("\n"),n=o.length-t):n+=o.length,a&&"start"!==l){let e=a.parent||{raws:{}};(!("decl"===a.type||"atrule"===a.type&&!a.nodes)||a!==e.last||e.raws.semicolon)&&(a.source&&a.source.end?(s.source=this.sourcePath(a),s.original.line=a.source.end.line,s.original.column=a.source.end.column-1,s.generated.line=r,s.generated.column=n-2):(s.source=i,s.original.line=1,s.original.column=0,s.generated.line=r,s.generated.column=n-1),this.map.addMapping(s))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(e=>e.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let e=this.mapOpts.annotation;return(void 0===e||!0===e)&&(!this.previous().length||this.previous().some(e=>e.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(e=>e.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(e){if(this.mapOpts.absolute||60===e.charCodeAt(0)||/^\w+:\/\//.test(e))return e;let t=this.memoizedPaths.get(e);if(t)return t;let r=this.opts.to?aU(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(r=aU(aj(r,this.mapOpts.annotation)));let n=aF(r,e);return this.memoizedPaths.set(e,n),n}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(e=>{if(e.source&&e.source.input.map){let t=e.source.input.map;this.previousMaps.includes(t)||this.previousMaps.push(t)}});else{let e=new aN(this.originalCSS,this.opts);e.map&&this.previousMaps.push(e.map)}return this.previousMaps}setSourcesContent(){let e={};if(this.root)this.root.walk(t=>{if(t.source){let r=t.source.input.from;if(r&&!e[r]){e[r]=!0;let n=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(n,t.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(e){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(e.source.input.from):this.toUrl(this.path(e.source.input.from))}toBase64(e){return i5.Buffer.from(e).toString("base64")}toFileUrl(e){let t=this.memoizedFileURLs.get(e);if(t)return t;if(aq){let t=aq(e).toString();return this.memoizedFileURLs.set(e,t),t}throw Error("`map.absolute` option is not available in this PostCSS build")}toUrl(e){let t=this.memoizedURLs.get(e);if(t)return t;"\\"===aB&&(e=e.replace(/\\/g,"/"));let r=encodeURI(e).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(e,r),r}},aG=af,aK=class extends aG{constructor(e){super(e),this.type="comment"}};aK.default=aK;let{isClean:aY,my:aZ}=al,a$=af,aH=class e extends a${append(...e){for(let t of e)for(let e of this.normalize(t,this.last))this.proxyOf.nodes.push(e);return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let t of this.nodes)t.cleanRaws(e)}each(e){let t,r;if(!this.proxyOf.nodes)return;let n=this.getIterator();for(;this.indexes[n]<this.proxyOf.nodes.length&&(t=this.indexes[n],!1!==(r=e(this.proxyOf.nodes[t],t)));)this.indexes[n]+=1;return delete this.indexes[n],r}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get(e,t){if("proxyOf"===t)return e;if(!e[t])return e[t];if("each"===t||"string"==typeof t&&t.startsWith("walk"))return(...r)=>e[t](...r.map(e=>"function"==typeof e?(t,r)=>e(t.toProxy(),r):e));if("every"===t||"some"===t)return r=>e[t]((e,...t)=>r(e.toProxy(),...t));if("root"===t)return()=>e.root().toProxy();else if("nodes"===t)return e.nodes.map(e=>e.toProxy());else if("first"===t||"last"===t)return e[t].toProxy();else return e[t]},set:(e,t,r)=>e[t]===r||(e[t]=r,("name"===t||"params"===t||"selector"===t)&&e.markDirty(),!0)}}index(e){return"number"==typeof e?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,t){let r,n=this.index(e),i=this.normalize(t,this.proxyOf.nodes[n]).reverse();for(let t of(n=this.index(e),i))this.proxyOf.nodes.splice(n+1,0,t);for(let e in this.indexes)n<(r=this.indexes[e])&&(this.indexes[e]=r+i.length);return this.markDirty(),this}insertBefore(e,t){let r,n=this.index(e),i=0===n&&"prepend",s=this.normalize(t,this.proxyOf.nodes[n],i).reverse();for(let t of(n=this.index(e),s))this.proxyOf.nodes.splice(n,0,t);for(let e in this.indexes)n<=(r=this.indexes[e])&&(this.indexes[e]=r+s.length);return this.markDirty(),this}normalize(t,r){if("string"==typeof t)t=function e(t){return t.map(t=>(t.nodes&&(t.nodes=e(t.nodes)),delete t.source,t))}(h(t).nodes);else if(void 0===t)t=[];else if(Array.isArray(t))for(let e of t=t.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if("root"===t.type&&"document"!==this.type)for(let e of t=t.nodes.slice(0))e.parent&&e.parent.removeChild(e,"ignore");else if(t.type)t=[t];else if(t.prop){if(void 0===t.value)throw Error("Value field is missed in node creation");"string"!=typeof t.value&&(t.value=String(t.value)),t=[new am(t)]}else if(t.selector)t=[new d(t)];else if(t.name)t=[new p(t)];else if(t.text)t=[new aK(t)];else throw Error("Unknown node type in node creation");return t.map(t=>(t[aZ]||e.rebuild(t),(t=t.proxyOf).parent&&t.parent.removeChild(t),t[aY]&&function e(t){if(t[aY]=!1,t.proxyOf.nodes)for(let r of t.proxyOf.nodes)e(r)}(t),void 0===t.raws.before&&r&&void 0!==r.raws.before&&(t.raws.before=r.raws.before.replace(/\S/g,"")),t.parent=this.proxyOf,t))}prepend(...e){for(let t of e=e.reverse()){let e=this.normalize(t,this.first,"prepend").reverse();for(let t of e)this.proxyOf.nodes.unshift(t);for(let t in this.indexes)this.indexes[t]=this.indexes[t]+e.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){let t;for(let r in e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1),this.indexes)(t=this.indexes[r])>=e&&(this.indexes[r]=t-1);return this.markDirty(),this}replaceValues(e,t,r){return r||(r=t,t={}),this.walkDecls(n=>{t.props&&!t.props.includes(n.prop)||(!t.fast||n.value.includes(t.fast))&&(n.value=n.value.replace(e,r))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((t,r)=>{let n;try{n=e(t,r)}catch(e){throw t.addToError(e)}return!1!==n&&t.walk&&(n=t.walk(e)),n})}walkAtRules(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("atrule"===r.type&&e.test(r.name))return t(r,n)}):this.walk((r,n)=>{if("atrule"===r.type&&r.name===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("atrule"===e.type)return t(e,r)}))}walkComments(e){return this.walk((t,r)=>{if("comment"===t.type)return e(t,r)})}walkDecls(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("decl"===r.type&&e.test(r.prop))return t(r,n)}):this.walk((r,n)=>{if("decl"===r.type&&r.prop===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("decl"===e.type)return t(e,r)}))}walkRules(e,t){return t?e instanceof RegExp?this.walk((r,n)=>{if("rule"===r.type&&e.test(r.selector))return t(r,n)}):this.walk((r,n)=>{if("rule"===r.type&&r.selector===e)return t(r,n)}):(t=e,this.walk((e,r)=>{if("rule"===e.type)return t(e,r)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};aH.registerParse=e=>{h=e},aH.registerRule=e=>{d=e},aH.registerAtRule=e=>{p=e},aH.registerRoot=e=>{f=e},aH.default=aH,aH.rebuild=e=>{"atrule"===e.type?Object.setPrototypeOf(e,p.prototype):"rule"===e.type?Object.setPrototypeOf(e,d.prototype):"decl"===e.type?Object.setPrototypeOf(e,am.prototype):"comment"===e.type?Object.setPrototypeOf(e,aK.prototype):"root"===e.type&&Object.setPrototypeOf(e,f.prototype),e[aZ]=!0,e.nodes&&e.nodes.forEach(e=>{aH.rebuild(e)})};let aJ=aH,aX=class extends aJ{constructor(e){super({type:"document",...e}),this.nodes||(this.nodes=[])}toResult(e={}){return new g(new m,this,e).stringify()}};aX.registerLazyResult=e=>{g=e},aX.registerProcessor=e=>{m=e},aX.default=aX;let aQ=class{constructor(e,t={}){if(this.type="warning",this.text=e,t.node&&t.node.source){let e=t.node.rangeBy(t);this.line=e.start.line,this.column=e.start.column,this.endLine=e.end.line,this.endColumn=e.end.column}for(let e in t)this[e]=t[e]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};aQ.default=aQ;let a0=class{constructor(e,t,r){this.processor=e,this.messages=[],this.root=t,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(e,t={}){!t.plugin&&this.lastPlugin&&this.lastPlugin.postcssPlugin&&(t.plugin=this.lastPlugin.postcssPlugin);let r=new aQ(e,t);return this.messages.push(r),r}warnings(){return this.messages.filter(e=>"warning"===e.type)}get content(){return this.css}};a0.default=a0;let a1=/[\t\n\f\r "#'()/;[\\\]{}]/g,a2=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,a3=/.[\r\n"'(/\\]/,a4=/[\da-f]/i,a5=aH,a6=class extends a5{constructor(e){super(e),this.type="atrule"}append(...e){return this.proxyOf.nodes||(this.nodes=[]),super.append(...e)}prepend(...e){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...e)}};a6.default=a6,a5.registerAtRule(a6);let a8=aH,a9=class extends a8{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,t,r){let n=super.normalize(e);if(t){if("prepend"===r)this.nodes.length>1?t.raws.before=this.nodes[1].raws.before:delete t.raws.before;else if(this.first!==t)for(let e of n)e.raws.before=t.raws.before}return n}removeChild(e,t){let r=this.index(e);return!t&&0===r&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(e)}toResult(e={}){return new v(new y,this,e).stringify()}};a9.registerLazyResult=e=>{v=e},a9.registerProcessor=e=>{y=e},a9.default=a9,a8.registerRoot(a9);let a7={comma:e=>a7.split(e,[","],!0),space:e=>a7.split(e,[" ","\n","	"]),split(e,t,r){let n=[],i="",s=!1,o=0,a=!1,l="",u=!1;for(let r of e)u?u=!1:"\\"===r?u=!0:a?r===l&&(a=!1):'"'===r||"'"===r?(a=!0,l=r):"("===r?o+=1:")"===r?o>0&&(o-=1):0===o&&t.includes(r)&&(s=!0),s?(""!==i&&n.push(i.trim()),i="",s=!1):i+=r;return(r||""!==i)&&n.push(i.trim()),n}};a7.default=a7;let le=aH,lt=class extends le{constructor(e){super(e),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return a7.comma(this.selector)}set selectors(e){let t=this.selector?this.selector.match(/,\s*/):null,r=t?t[0]:","+this.raw("between","beforeOpen");this.selector=e.join(r)}};lt.default=lt,le.registerRule(lt);let lr=function(e,t={}){let r,n,i,s,o,a,l,u,c,h,d=e.css.valueOf(),p=t.ignoreErrors,f=d.length,g=0,m=[],v=[];function y(t){throw e.error("Unclosed "+t,g)}return{back:function(e){v.push(e)},endOfFile:function(){return 0===v.length&&g>=f},nextToken:function(e){if(v.length)return v.pop();if(g>=f)return;let t=!!e&&e.ignoreUnclosed;switch(r=d.charCodeAt(g)){case 10:case 32:case 9:case 13:case 12:n=g;do n+=1,r=d.charCodeAt(n);while(32===r||10===r||9===r||13===r||12===r)h=["space",d.slice(g,n)],g=n-1;break;case 91:case 93:case 123:case 125:case 58:case 59:case 41:{let e=String.fromCharCode(r);h=[e,e,g];break}case 40:if(u=m.length?m.pop()[1]:"",c=d.charCodeAt(g+1),"url"===u&&39!==c&&34!==c&&32!==c&&10!==c&&9!==c&&12!==c&&13!==c){n=g;do{if(a=!1,-1===(n=d.indexOf(")",n+1)))if(p||t){n=g;break}else y("bracket");for(l=n;92===d.charCodeAt(l-1);)l-=1,a=!a}while(a)h=["brackets",d.slice(g,n+1),g,n],g=n}else n=d.indexOf(")",g+1),s=d.slice(g,n+1),-1===n||a3.test(s)?h=["(","(",g]:(h=["brackets",s,g,n],g=n);break;case 39:case 34:i=39===r?"'":'"',n=g;do{if(a=!1,-1===(n=d.indexOf(i,n+1)))if(p||t){n=g+1;break}else y("string");for(l=n;92===d.charCodeAt(l-1);)l-=1,a=!a}while(a)h=["string",d.slice(g,n+1),g,n],g=n;break;case 64:a1.lastIndex=g+1,a1.test(d),n=0===a1.lastIndex?d.length-1:a1.lastIndex-2,h=["at-word",d.slice(g,n+1),g,n],g=n;break;case 92:for(n=g,o=!0;92===d.charCodeAt(n+1);)n+=1,o=!o;if(r=d.charCodeAt(n+1),o&&47!==r&&32!==r&&10!==r&&9!==r&&13!==r&&12!==r&&(n+=1,a4.test(d.charAt(n)))){for(;a4.test(d.charAt(n+1));)n+=1;32===d.charCodeAt(n+1)&&(n+=1)}h=["word",d.slice(g,n+1),g,n],g=n;break;default:47===r&&42===d.charCodeAt(g+1)?(0===(n=d.indexOf("*/",g+2)+1)&&(p||t?n=d.length:y("comment")),h=["comment",d.slice(g,n+1),g,n]):(a2.lastIndex=g+1,a2.test(d),n=0===a2.lastIndex?d.length-1:a2.lastIndex-2,h=["word",d.slice(g,n+1),g,n],m.push(h)),g=n}return g++,h},position:function(){return g}}},ln={empty:!0,space:!0},li=class{constructor(e){this.input=e,this.root=new a9,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:e,start:{column:1,line:1,offset:0}}}atrule(e){let t,r,n,i=new a6;i.name=e[1].slice(1),""===i.name&&this.unnamedAtrule(i,e),this.init(i,e[2]);let s=!1,o=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if("("===(t=(e=this.tokenizer.nextToken())[0])||"["===t?l.push("("===t?")":"]"):"{"===t&&l.length>0?l.push("}"):t===l[l.length-1]&&l.pop(),0===l.length)if(";"===t){i.source.end=this.getPosition(e[2]),i.source.end.offset++,this.semicolon=!0;break}else if("{"===t){o=!0;break}else if("}"===t){if(a.length>0){for(n=a.length-1,r=a[n];r&&"space"===r[0];)r=a[--n];r&&(i.source.end=this.getPosition(r[3]||r[2]),i.source.end.offset++)}this.end(e);break}else a.push(e);else a.push(e);if(this.tokenizer.endOfFile()){s=!0;break}}i.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(i.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(i,"params",a),s&&(e=a[a.length-1],i.source.end=this.getPosition(e[3]||e[2]),i.source.end.offset++,this.spaces=i.raws.between,i.raws.between="")):(i.raws.afterName="",i.params=""),o&&(i.nodes=[],this.current=i)}checkMissedSemicolon(e){let t,r=this.colon(e);if(!1===r)return;let n=0;for(let i=r-1;i>=0&&("space"===(t=e[i])[0]||2!==(n+=1));i--);throw this.input.error("Missed semicolon","word"===t[0]?t[3]+1:t[2])}colon(e){let t,r,n=0;for(let[i,s]of e.entries()){if("("===(t=s[0])&&(n+=1),")"===t&&(n-=1),0===n&&":"===t)if(r)if("word"===r[0]&&"progid"===r[1])continue;else return i;else this.doubleColon(s);r=s}return!1}comment(e){let t=new aK;this.init(t,e[2]),t.source.end=this.getPosition(e[3]||e[2]),t.source.end.offset++;let r=e[1].slice(2,-2);if(/^\s*$/.test(r))t.text="",t.raws.left=r,t.raws.right="";else{let e=r.match(/^(\s*)([^]*\S)(\s*)$/);t.text=e[2],t.raws.left=e[1],t.raws.right=e[3]}}createTokenizer(){this.tokenizer=lr(this.input)}decl(e,t){let r,n,i=new am;this.init(i,e[0][2]);let s=e[e.length-1];for(";"===s[0]&&(this.semicolon=!0,e.pop()),i.source.end=this.getPosition(s[3]||s[2]||function(e){for(let t=e.length-1;t>=0;t--){let r=e[t],n=r[3]||r[2];if(n)return n}}(e)),i.source.end.offset++;"word"!==e[0][0];)1===e.length&&this.unknownWord(e),i.raws.before+=e.shift()[1];for(i.source.start=this.getPosition(e[0][2]),i.prop="";e.length;){let t=e[0][0];if(":"===t||"space"===t||"comment"===t)break;i.prop+=e.shift()[1]}for(i.raws.between="";e.length;){if(":"===(r=e.shift())[0]){i.raws.between+=r[1];break}"word"===r[0]&&/\w/.test(r[1])&&this.unknownWord([r]),i.raws.between+=r[1]}("_"===i.prop[0]||"*"===i.prop[0])&&(i.raws.before+=i.prop[0],i.prop=i.prop.slice(1));let o=[];for(;e.length&&("space"===(n=e[0][0])||"comment"===n);)o.push(e.shift());this.precheckMissedSemicolon(e);for(let t=e.length-1;t>=0;t--){if("!important"===(r=e[t])[1].toLowerCase()){i.important=!0;let r=this.stringFrom(e,t);" !important"!==(r=this.spacesFromEnd(e)+r)&&(i.raws.important=r);break}if("important"===r[1].toLowerCase()){let r=e.slice(0),n="";for(let e=t;e>0;e--){let t=r[e][0];if(0===n.trim().indexOf("!")&&"space"!==t)break;n=r.pop()[1]+n}0===n.trim().indexOf("!")&&(i.important=!0,i.raws.important=n,e=r)}if("space"!==r[0]&&"comment"!==r[0])break}e.some(e=>"space"!==e[0]&&"comment"!==e[0])&&(i.raws.between+=o.map(e=>e[1]).join(""),o=[]),this.raw(i,"value",o.concat(e),t),i.value.includes(":")&&!t&&this.checkMissedSemicolon(e)}doubleColon(e){throw this.input.error("Double colon",{offset:e[2]},{offset:e[2]+e[1].length})}emptyRule(e){let t=new lt;this.init(t,e[2]),t.selector="",t.raws.between="",this.current=t}end(e){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(e[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(e)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(e){if(this.spaces+=e[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&"rule"===e.type&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(e){let t=this.input.fromOffset(e);return{column:t.col,line:t.line,offset:e}}init(e,t){this.current.push(e),e.source={input:this.input,start:this.getPosition(t)},e.raws.before=this.spaces,this.spaces="","comment"!==e.type&&(this.semicolon=!1)}other(e){let t=!1,r=null,n=!1,i=null,s=[],o=e[1].startsWith("--"),a=[],l=e;for(;l;){if(r=l[0],a.push(l),"("===r||"["===r)i||(i=l),s.push("("===r?")":"]");else if(o&&n&&"{"===r)i||(i=l),s.push("}");else if(0===s.length)if(";"===r)if(n)return void this.decl(a,o);else break;else if("{"===r)return void this.rule(a);else if("}"===r){this.tokenizer.back(a.pop()),t=!0;break}else":"===r&&(n=!0);else r===s[s.length-1]&&(s.pop(),0===s.length&&(i=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(t=!0),s.length>0&&this.unclosedBracket(i),t&&n){if(!o)for(;a.length&&("space"===(l=a[a.length-1][0])||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,o)}else this.unknownWord(a)}parse(){let e;for(;!this.tokenizer.endOfFile();)switch((e=this.tokenizer.nextToken())[0]){case"space":this.spaces+=e[1];break;case";":this.freeSemicolon(e);break;case"}":this.end(e);break;case"comment":this.comment(e);break;case"at-word":this.atrule(e);break;case"{":this.emptyRule(e);break;default:this.other(e)}this.endFile()}precheckMissedSemicolon(){}raw(e,t,r,n){let i,s,o,a,l=r.length,u="",c=!0;for(let e=0;e<l;e+=1)"space"!==(s=(i=r[e])[0])||e!==l-1||n?"comment"===s?(a=r[e-1]?r[e-1][0]:"empty",o=r[e+1]?r[e+1][0]:"empty",ln[a]||ln[o]||","===u.slice(-1)?c=!1:u+=i[1]):u+=i[1]:c=!1;if(!c){let n=r.reduce((e,t)=>e+t[1],"");e.raws[t]={raw:n,value:u}}e[t]=u}rule(e){e.pop();let t=new lt;this.init(t,e[0][2]),t.raws.between=this.spacesAndCommentsFromEnd(e),this.raw(t,"selector",e),this.current=t}spacesAndCommentsFromEnd(e){let t,r="";for(;e.length&&("space"===(t=e[e.length-1][0])||"comment"===t);)r=e.pop()[1]+r;return r}spacesAndCommentsFromStart(e){let t,r="";for(;e.length&&("space"===(t=e[0][0])||"comment"===t);)r+=e.shift()[1];return r}spacesFromEnd(e){let t="";for(;e.length&&"space"===e[e.length-1][0];)t=e.pop()[1]+t;return t}stringFrom(e,t){let r="";for(let n=t;n<e.length;n++)r+=e[n][1];return e.splice(t,e.length-t),r}unclosedBlock(){let e=this.current.source.start;throw this.input.error("Unclosed block",e.line,e.column)}unclosedBracket(e){throw this.input.error("Unclosed bracket",{offset:e[2]},{offset:e[2]+1})}unexpectedClose(e){throw this.input.error("Unexpected }",{offset:e[2]},{offset:e[2]+1})}unknownWord(e){throw this.input.error("Unknown word",{offset:e[0][2]},{offset:e[0][2]+e[0][1].length})}unnamedAtrule(e,t){throw this.input.error("At-rule without name",{offset:t[2]},{offset:t[2]+t[1].length})}};function ls(e,t){let r=new li(new aN(e,t));try{r.parse()}catch(e){throw e}return r.root}ls.default=ls,aH.registerParse(ls);let{isClean:lo,my:la}=al,ll={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},lu={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},lc={Once:!0,postcssPlugin:!0,prepare:!0};function lh(e){return"object"==typeof e&&"function"==typeof e.then}function ld(e){let t=!1,r=ll[e.type];return("decl"===e.type?t=e.prop.toLowerCase():"atrule"===e.type&&(t=e.name.toLowerCase()),t&&e.append)?[r,r+"-"+t,0,r+"Exit",r+"Exit-"+t]:t?[r,r+"-"+t,r+"Exit",r+"Exit-"+t]:e.append?[r,0,r+"Exit"]:[r,r+"Exit"]}function lp(e){return{eventIndex:0,events:"document"===e.type?["Document",0,"DocumentExit"]:"root"===e.type?["Root",0,"RootExit"]:ld(e),iterator:0,node:e,visitorIndex:0,visitors:[]}}function lf(e){return e[lo]=!1,e.nodes&&e.nodes.forEach(e=>lf(e)),e}let lg={},lm=class e{constructor(t,r,n){let i;if(this.stringified=!1,this.processed=!1,"object"==typeof r&&null!==r&&("root"===r.type||"document"===r.type))i=lf(r);else if(r instanceof e||r instanceof a0)i=lf(r.root),r.map&&(void 0===n.map&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=r.map);else{let e=ls;n.syntax&&(e=n.syntax.parse),n.parser&&(e=n.parser),e.parse&&(e=e.parse);try{i=e(r,n)}catch(e){this.processed=!0,this.error=e}i&&!i[la]&&aH.rebuild(i)}this.result=new a0(t,i,n),this.helpers={...lg,postcss:lg,result:this.result},this.plugins=this.processor.plugins.map(e=>"object"==typeof e&&e.prepare?{...e,...e.prepare(this.result)}:e)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw Error("Use process(css).then(cb) to work with async plugins")}handleError(e,t){let r=this.result.lastPlugin;try{t&&t.addToError(e),this.error=e,"CssSyntaxError"!==e.name||e.plugin?r.postcssVersion:(e.plugin=r.postcssPlugin,e.setMessage())}catch(e){console&&console.error&&console.error(e)}return e}prepareVisitors(){this.listeners={};let e=(e,t,r)=>{this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push([e,r])};for(let t of this.plugins)if("object"==typeof t)for(let r in t){if(!lu[r]&&/^[A-Z]/.test(r))throw Error(`Unknown event ${r} in ${t.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!lc[r])if("object"==typeof t[r])for(let n in t[r])e(t,"*"===n?r:r+"-"+n.toLowerCase(),t[r][n]);else"function"==typeof t[r]&&e(t,r,t[r])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let t=this.plugins[e],r=this.runOnRoot(t);if(lh(r))try{await r}catch(e){throw this.handleError(e)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[lo];){e[lo]=!0;let t=[lp(e)];for(;t.length>0;){let e=this.visitTick(t);if(lh(e))try{await e}catch(r){let e=t[t.length-1].node;throw this.handleError(r,e)}}}if(this.listeners.OnceExit)for(let[t,r]of this.listeners.OnceExit){this.result.lastPlugin=t;try{if("document"===e.type){let t=e.nodes.map(e=>r(e,this.helpers));await Promise.all(t)}else await r(e,this.helpers)}catch(e){throw this.handleError(e)}}}return this.processed=!0,this.stringify()}runOnRoot(e){this.result.lastPlugin=e;try{if("object"==typeof e&&e.Once){if("document"===this.result.root.type){let t=this.result.root.nodes.map(t=>e.Once(t,this.helpers));if(lh(t[0]))return Promise.all(t);return t}return e.Once(this.result.root,this.helpers)}if("function"==typeof e)return e(this.result.root,this.result)}catch(e){throw this.handleError(e)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,t=ah;e.syntax&&(t=e.syntax.stringify),e.stringifier&&(t=e.stringifier),t.stringify&&(t=t.stringify);let r=new aW(t,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins)if(lh(this.runOnRoot(e)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[lo];)e[lo]=!0,this.walkSync(e);if(this.listeners.OnceExit)if("document"===e.type)for(let t of e.nodes)this.visitSync(this.listeners.OnceExit,t);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,t){return this.async().then(e,t)}toString(){return this.css}visitSync(e,t){for(let[r,n]of e){let e;this.result.lastPlugin=r;try{e=n(t,this.helpers)}catch(e){throw this.handleError(e,t.proxyOf)}if("root"!==t.type&&"document"!==t.type&&!t.parent)return!0;if(lh(e))throw this.getAsyncError()}}visitTick(e){let t=e[e.length-1],{node:r,visitors:n}=t;if("root"!==r.type&&"document"!==r.type&&!r.parent)return void e.pop();if(n.length>0&&t.visitorIndex<n.length){let[e,i]=n[t.visitorIndex];t.visitorIndex+=1,t.visitorIndex===n.length&&(t.visitors=[],t.visitorIndex=0),this.result.lastPlugin=e;try{return i(r.toProxy(),this.helpers)}catch(e){throw this.handleError(e,r)}}if(0!==t.iterator){let n,i=t.iterator;for(;n=r.nodes[r.indexes[i]];)if(r.indexes[i]+=1,!n[lo]){n[lo]=!0,e.push(lp(n));return}t.iterator=0,delete r.indexes[i]}let i=t.events;for(;t.eventIndex<i.length;){let e=i[t.eventIndex];if(t.eventIndex+=1,0===e){r.nodes&&r.nodes.length&&(r[lo]=!0,t.iterator=r.getIterator());return}if(this.listeners[e]){t.visitors=this.listeners[e];return}}e.pop()}walkSync(e){for(let t of(e[lo]=!0,ld(e)))if(0===t)e.nodes&&e.each(e=>{e[lo]||this.walkSync(e)});else{let r=this.listeners[t];if(r&&this.visitSync(r,e.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};lm.registerPostcss=e=>{lg=e},lm.default=lm,a9.registerLazyResult(lm),aX.registerLazyResult(lm);let lv=class{constructor(e,t,r){let n;t=t.toString(),this.stringified=!1,this._processor=e,this._css=t,this._opts=r,this._map=void 0,this.result=new a0(this._processor,n,this._opts),this.result.css=t;let i=this;Object.defineProperty(this.result,"root",{get:()=>i.root});let s=new aW(ah,n,this._opts,t);if(s.isMap()){let[e,t]=s.generate();e&&(this.result.css=e),t&&(this.result.map=t)}else s.clearAnnotation(),this.result.css=s.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}sync(){if(this.error)throw this.error;return this.result}then(e,t){return this.async().then(e,t)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){let e;if(this._root)return this._root;try{e=ls(this._css,this._opts)}catch(e){this.error=e}if(!this.error)return this._root=e,e;throw this.error}get[Symbol.toStringTag](){return"NoWorkResult"}};lv.default=lv;let ly=class{constructor(e=[]){this.version="8.4.38",this.plugins=this.normalize(e)}normalize(e){let t=[];for(let r of e)if(!0===r.postcss?r=r():r.postcss&&(r=r.postcss),"object"==typeof r&&Array.isArray(r.plugins))t=t.concat(r.plugins);else if("object"==typeof r&&r.postcssPlugin)t.push(r);else if("function"==typeof r)t.push(r);else if("object"==typeof r&&(r.parse||r.stringify));else throw Error(r+" is not a PostCSS plugin");return t}process(e,t={}){return this.plugins.length||t.parser||t.stringifier||t.syntax?new lm(this,e,t):new lv(this,e,t)}use(e){return this.plugins=this.plugins.concat(this.normalize([e])),this}};function lb(e,t){if(Array.isArray(e))return e.map(e=>lb(e));let{inputs:r,...n}=e;if(r)for(let e of(t=[],r)){let r={...e,__proto__:aN.prototype};r.map&&(r.map={...r.map,__proto__:aI.prototype}),t.push(r)}if(n.nodes&&(n.nodes=e.nodes.map(e=>lb(e,t))),n.source){let{inputId:e,...r}=n.source;n.source=r,null!=e&&(n.source.input=t[e])}if("root"===n.type)return new a9(n);if("decl"===n.type)return new am(n);if("rule"===n.type)return new lt(n);if("comment"===n.type)return new aK(n);if("atrule"===n.type)return new a6(n);else throw Error("Unknown node type: "+e.type)}function lw(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),new ly(e)}ly.default=ly,a9.registerProcessor(ly),aX.registerProcessor(ly),lb.default=lb,lw.plugin=function(e,t){let r,n=!1;function i(...r){console&&console.warn&&!n&&(n=!0,console.warn(e+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),i6.default.env.LANG&&i6.default.env.LANG.startsWith("cn")&&console.warn(e+":  postcss.plugin . :\nhttps://www.w3ctech.com/topic/2226"));let s=t(...r);return s.postcssPlugin=e,s.postcssVersion=new ly().version,s}return Object.defineProperty(i,"postcss",{get:()=>(r||(r=i()),r)}),i.process=function(e,t,r){return lw([i(r)]).process(e,t)},i},lw.stringify=ah,lw.parse=ls,lw.fromJSON=lb,lw.list=a7,lw.comment=e=>new aK(e),lw.atRule=e=>new a6(e),lw.decl=e=>new am(e),lw.rule=e=>new lt(e),lw.root=e=>new a9(e),lw.document=e=>new aX(e),lw.CssSyntaxError=aa,lw.Declaration=am,lw.Container=aH,lw.Processor=ly,lw.Document=aX,lw.Comment=aK,lw.Warning=aQ,lw.AtRule=a6,lw.Result=a0,lw.Input=aN,lw.Rule=lt,lw.Root=a9,lw.Node=af,lm.registerPostcss(lw),lw.default=lw;let l_=lw&&lw.__esModule&&Object.prototype.hasOwnProperty.call(lw,"default")?lw.default:lw;l_.stringify,l_.fromJSON,l_.plugin,l_.parse,l_.list,l_.document,l_.comment,l_.atRule,l_.rule,l_.decl,l_.root,l_.CssSyntaxError,l_.Declaration,l_.Container,l_.Processor,l_.Document,l_.Comment,l_.Warning,l_.AtRule,l_.Result,l_.Input,l_.Rule,l_.Root,l_.Node;var lS=((V=lS||{})[V.Document=0]="Document",V[V.DocumentType=1]="DocumentType",V[V.Element=2]="Element",V[V.Text=3]="Text",V[V.CDATA=4]="CDATA",V[V.Comment=5]="Comment",V);class lI{constructor(...e){at(this,"parentElement",null),at(this,"parentNode",null),at(this,"ownerDocument"),at(this,"firstChild",null),at(this,"lastChild",null),at(this,"previousSibling",null),at(this,"nextSibling",null),at(this,"ELEMENT_NODE",1),at(this,"TEXT_NODE",3),at(this,"nodeType"),at(this,"nodeName"),at(this,"RRNodeType")}get childNodes(){let e=[],t=this.firstChild;for(;t;)e.push(t),t=t.nextSibling;return e}contains(e){if(!(e instanceof lI)||e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}var lC=((W=lC||{})[W.PLACEHOLDER=0]="PLACEHOLDER",W[W.ELEMENT_NODE=1]="ELEMENT_NODE",W[W.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",W[W.TEXT_NODE=3]="TEXT_NODE",W[W.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",W[W.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",W[W.ENTITY_NODE=6]="ENTITY_NODE",W[W.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",W[W.COMMENT_NODE=8]="COMMENT_NODE",W[W.DOCUMENT_NODE=9]="DOCUMENT_NODE",W[W.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",W[W.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE",W);let lE={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},lk={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},lx={};function lO(e){if(lx[e])return lx[e];let t=globalThis[e],r=t.prototype,n=e in lE?lE[e]:void 0,i=!!(n&&n.every(e=>{var t,n;return!!(null==(n=null==(t=Object.getOwnPropertyDescriptor(r,e))?void 0:t.get)?void 0:n.toString().includes("[native code]"))})),s=e in lk?lk[e]:void 0,o=!!(s&&s.every(e=>{var t;return"function"==typeof r[e]&&(null==(t=r[e])?void 0:t.toString().includes("[native code]"))}));if(i&&o&&!globalThis.Zone)return lx[e]=t.prototype,t.prototype;try{let n=document.createElement("iframe");document.body.appendChild(n);let i=n.contentWindow;if(!i)return t.prototype;let s=i[e].prototype;if(document.body.removeChild(n),!s)return r;return lx[e]=s}catch{return r}}let lR={};function lT(e,t,r){var n;let i=`${e}.${String(r)}`;if(lR[i])return lR[i].call(t);let s=null==(n=Object.getOwnPropertyDescriptor(lO(e),r))?void 0:n.get;return s?(lR[i]=s,s.call(t)):t[r]}let lA={};function lM(e,t,r){let n=`${e}.${String(r)}`;if(lA[n])return lA[n].bind(t);let i=lO(e)[r];return"function"!=typeof i?t[r]:(lA[n]=i,i.bind(t))}let lP=function(e){return lT("Node",e,"childNodes")},lN=function(e){return lT("Node",e,"parentNode")},lD=function(e){return lT("Node",e,"parentElement")},lL=function(e){return lT("Node",e,"textContent")},lU=function(e,t){return lM("Node",e,"contains")(t)},lF=function(e){return lM("Node",e,"getRootNode")()},lj=function(e){return e&&"host"in e?lT("ShadowRoot",e,"host"):null},lB=function(e){return e&&"shadowRoot"in e?lT("Element",e,"shadowRoot"):null};function lq(e,t,r=document){let n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}let lz="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",lV={map:{},getId:()=>(console.error(lz),-1),getNode:()=>(console.error(lz),null),removeNodeFromMap(){console.error(lz)},has:()=>(console.error(lz),!1),reset(){console.error(lz)}};function lW(e,t,r={}){let n=null,i=0;return function(...s){let o=Date.now();i||!1!==r.leading||(i=o);let a=t-(o-i),l=this;a<=0||a>t?(n&&(clearTimeout(n),n=null),i=o,e.apply(l,s)):n||!1===r.trailing||(n=setTimeout(()=>{i=!1===r.leading?0:Date.now(),n=null,e.apply(l,s)},a))}}function lG(e,t,r,n,i=window){let s=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,n?r:{set(e){setTimeout(()=>{r.set.call(this,e)},0),s&&s.set&&s.set.call(this,e)}}),()=>lG(e,t,s||{},!0)}function lK(e,t,r){try{if(!(t in e))return()=>{};let n=e[t],i=r(n);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=i,()=>{e[t]=n}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(lV=new Proxy(lV,{get:(e,t,r)=>("map"===t&&console.error(lz),Reflect.get(e,t,r))}));let lY=Date.now;function lZ(e){var t,r,n,i;let s=e.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:s.documentElement.scrollLeft||(null==s?void 0:s.body)&&(null==(t=lD(s.body))?void 0:t.scrollLeft)||(null==(r=null==s?void 0:s.body)?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==s?void 0:s.documentElement.scrollTop)||(null==s?void 0:s.body)&&(null==(n=lD(s.body))?void 0:n.scrollTop)||(null==(i=null==s?void 0:s.body)?void 0:i.scrollTop)||0}}function l$(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function lH(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function lJ(e){return e?e.nodeType===e.ELEMENT_NODE?e:lD(e):null}function lX(e,t,r,n){if(!e)return!1;let i=lJ(e);if(!i)return!1;try{if("string"==typeof t){if(i.classList.contains(t)||n&&null!==i.closest("."+t))return!0}else if(sB(i,t,n))return!0}catch(e){}return!!(r&&(i.matches(r)||n&&null!==i.closest(r)))||!1}function lQ(e,t){return -1!==t.getId(e)}function l0(e,t,r){return"TITLE"===e.tagName&&!!r.headTitleMutations||-2===t.getId(e)}function l1(e,t){if(sf(e))return!1;let r=t.getId(e);if(!t.has(r))return!0;let n=lN(e);return(!n||n.nodeType!==e.DOCUMENT_NODE)&&(!n||l1(n,t))}function l2(e){return!!e.changedTouches}function l3(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach)}function l4(e,t){return!!("IFRAME"===e.nodeName&&t.getMeta(e))}function l5(e,t){return!!("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function l6(e){return!!e&&(e instanceof lI&&"shadowRoot"in e?!!e.shadowRoot:!!lB(e))}/[1-9][0-9]{12}/.test(Date.now().toString())||(lY=()=>new Date().getTime());class l8{constructor(){i9(this,"id",1),i9(this,"styleIDMap",new WeakMap),i9(this,"idStyleMap",new Map)}getId(e){return this.styleIDMap.get(e)??-1}has(e){return this.styleIDMap.has(e)}add(e,t){let r;return this.has(e)?this.getId(e):(r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r)}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function l9(e){var t;let r=null;return"getRootNode"in e&&(null==(t=lF(e))?void 0:t.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&lj(lF(e))&&(r=lj(lF(e))),r}function l7(e){let t,r=e;for(;t=l9(r);)r=t;return r}function ue(e){let t=e.ownerDocument;return!!t&&lU(t,l7(e))}function ut(e){let t=e.ownerDocument;return!!t&&(lU(t,e)||ue(e))}let ur=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:l8,get _mirror(){return lV},closestElementOfNode:lJ,getBaseDimension:function e(t,r){var n,i;let s=null==(i=null==(n=t.ownerDocument)?void 0:n.defaultView)?void 0:i.frameElement;if(!s||s===r)return{x:0,y:0,relativeScale:1,absoluteScale:1};let o=s.getBoundingClientRect(),a=e(s,r),l=o.height/s.clientHeight;return{x:o.x*a.relativeScale+a.x,y:o.y*a.relativeScale+a.y,relativeScale:l,absoluteScale:a.absoluteScale*l}},getNestedRule:function e(t,r){let n=t[r[0]];return 1===r.length?n:e(n.cssRules[r[1]].cssRules,r.slice(2))},getPositionsAndIndex:function(e){let t=[...e],r=t.pop();return{positions:t,index:r}},getRootShadowHost:l7,getShadowHost:l9,getWindowHeight:l$,getWindowScroll:lZ,getWindowWidth:lH,hasShadowRoot:l6,hookSetter:lG,inDom:ut,isAncestorRemoved:l1,isBlocked:lX,isIgnored:l0,isSerialized:lQ,isSerializedIframe:l4,isSerializedStylesheet:l5,iterateResolveTree:function e(t,r){r(t.value);for(let n=t.children.length-1;n>=0;n--)e(t.children[n],r)},legacy_isTouchEvent:l2,get nowTimestamp(){return lY},on:lq,patch:lK,polyfill:l3,queueToResolveTrees:function(e){let t={},r=(e,r)=>{let n={value:e,parent:r,children:[]};return t[e.node.id]=n,n},n=[];for(let i of e){let{nextId:e,parentId:s}=i;if(e&&e in t){let s=t[e];if(s.parent){let e=s.parent.children.indexOf(s);s.parent.children.splice(e,0,r(i,s.parent))}else{let e=n.indexOf(s);n.splice(e,0,r(i,null))}continue}if(s in t){let e=t[s];e.children.push(r(i,e));continue}n.push(r(i,null))}return n},shadowHostInDom:ue,throttle:lW,uniqueTextMutations:function(e){let t=new Set,r=[];for(let n=e.length;n--;){let i=e[n];t.has(i.id)||(r.push(i),t.add(i.id))}return r}},Symbol.toStringTag,{value:"Module"}));var un=((G=un||{})[G.DomContentLoaded=0]="DomContentLoaded",G[G.Load=1]="Load",G[G.FullSnapshot=2]="FullSnapshot",G[G.IncrementalSnapshot=3]="IncrementalSnapshot",G[G.Meta=4]="Meta",G[G.Custom=5]="Custom",G[G.Plugin=6]="Plugin",G),ui=((K=ui||{})[K.Mutation=0]="Mutation",K[K.MouseMove=1]="MouseMove",K[K.MouseInteraction=2]="MouseInteraction",K[K.Scroll=3]="Scroll",K[K.ViewportResize=4]="ViewportResize",K[K.Input=5]="Input",K[K.TouchMove=6]="TouchMove",K[K.MediaInteraction=7]="MediaInteraction",K[K.StyleSheetRule=8]="StyleSheetRule",K[K.CanvasMutation=9]="CanvasMutation",K[K.Font=10]="Font",K[K.Log=11]="Log",K[K.Drag=12]="Drag",K[K.StyleDeclaration=13]="StyleDeclaration",K[K.Selection=14]="Selection",K[K.AdoptedStyleSheet=15]="AdoptedStyleSheet",K[K.CustomElement=16]="CustomElement",K),us=((Y=us||{})[Y.MouseUp=0]="MouseUp",Y[Y.MouseDown=1]="MouseDown",Y[Y.Click=2]="Click",Y[Y.ContextMenu=3]="ContextMenu",Y[Y.DblClick=4]="DblClick",Y[Y.Focus=5]="Focus",Y[Y.Blur=6]="Blur",Y[Y.TouchStart=7]="TouchStart",Y[Y.TouchMove_Departed=8]="TouchMove_Departed",Y[Y.TouchEnd=9]="TouchEnd",Y[Y.TouchCancel=10]="TouchCancel",Y),uo=((Z=uo||{})[Z.Mouse=0]="Mouse",Z[Z.Pen=1]="Pen",Z[Z.Touch=2]="Touch",Z),ua=(($=ua||{})[$["2D"]=0]="2D",$[$.WebGL=1]="WebGL",$[$.WebGL2=2]="WebGL2",$),ul=((H=ul||{})[H.Play=0]="Play",H[H.Pause=1]="Pause",H[H.Seeked=2]="Seeked",H[H.VolumeChange=3]="VolumeChange",H[H.RateChange=4]="RateChange",H),uu=((J=uu||{}).Start="start",J.Pause="pause",J.Resume="resume",J.Resize="resize",J.Finish="finish",J.FullsnapshotRebuilded="fullsnapshot-rebuilded",J.LoadStylesheetStart="load-stylesheet-start",J.LoadStylesheetEnd="load-stylesheet-end",J.SkipStart="skip-start",J.SkipEnd="skip-end",J.MouseInteraction="mouse-interaction",J.EventCast="event-cast",J.CustomEvent="custom-event",J.Flush="flush",J.StateChange="state-change",J.PlayBack="play-back",J.Destroy="destroy",J),uc=((X=uc||{})[X.Document=0]="Document",X[X.DocumentType=1]="DocumentType",X[X.Element=2]="Element",X[X.Text=3]="Text",X[X.CDATA=4]="CDATA",X[X.Comment=5]="Comment",X);class uh{constructor(){i9(this,"length",0),i9(this,"head",null),i9(this,"tail",null)}get(e){if(e>=this.length)throw Error("Position outside of list range");let t=this.head;for(let r=0;r<e;r++)t=(null==t?void 0:t.next)||null;return t}addNode(e){let t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&"__ln"in e.previousSibling){let r=e.previousSibling.__ln.next;t.next=r,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,r&&(r.previous=t)}else if(e.nextSibling&&"__ln"in e.nextSibling&&e.nextSibling.__ln.previous){let r=e.nextSibling.__ln.previous;t.previous=r,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,r&&(r.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){let t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}let ud=(e,t)=>`${e}@${t}`;class up{constructor(){i9(this,"frozen",!1),i9(this,"locked",!1),i9(this,"texts",[]),i9(this,"attributes",[]),i9(this,"attributeMap",new WeakMap),i9(this,"removes",[]),i9(this,"mapRemoves",[]),i9(this,"movedMap",{}),i9(this,"addedSet",new Set),i9(this,"movedSet",new Set),i9(this,"droppedSet",new Set),i9(this,"removesSubTreeCache",new Set),i9(this,"mutationCb"),i9(this,"blockClass"),i9(this,"blockSelector"),i9(this,"maskTextClass"),i9(this,"maskTextSelector"),i9(this,"inlineStylesheet"),i9(this,"maskInputOptions"),i9(this,"maskTextFn"),i9(this,"maskInputFn"),i9(this,"keepIframeSrcFn"),i9(this,"recordCanvas"),i9(this,"inlineImages"),i9(this,"slimDOMOptions"),i9(this,"dataURLOptions"),i9(this,"doc"),i9(this,"mirror"),i9(this,"iframeManager"),i9(this,"stylesheetManager"),i9(this,"shadowDomManager"),i9(this,"canvasManager"),i9(this,"processedNodeManager"),i9(this,"unattachedDoc"),i9(this,"processMutations",e=>{e.forEach(this.processMutation),this.emit()}),i9(this,"emit",()=>{if(this.frozen||this.locked)return;let e=[],t=new Set,r=new uh,n=e=>{let t=e,r=-2;for(;-2===r;)r=(t=t&&t.nextSibling)&&this.mirror.getId(t);return r},i=i=>{let s=lN(i);if(!s||!ut(i))return;let o=!1;if(i.nodeType===Node.TEXT_NODE){let e=s.tagName;if("TEXTAREA"===e)return;"STYLE"===e&&this.addedSet.has(s)&&(o=!0)}let a=sf(s)?this.mirror.getId(l9(i)):this.mirror.getId(s),l=n(i);if(-1===a||-1===l)return r.addNode(i);let u=sV(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{l4(e,this.mirror)&&this.iframeManager.addIframe(e),l5(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),l6(i)&&this.shadowDomManager.addShadowRoot(lB(i),this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)},cssCaptured:o});u&&(e.push({parentId:a,nextId:l,node:u}),t.add(u.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let e of this.movedSet)(!ug(this.removesSubTreeCache,e,this.mirror)||this.movedSet.has(lN(e)))&&i(e);for(let e of this.addedSet)um(this.droppedSet,e)||ug(this.removesSubTreeCache,e,this.mirror)?um(this.movedSet,e)?i(e):this.droppedSet.add(e):i(e);let s=null;for(;r.length;){let e=null;if(s){let t=this.mirror.getId(lN(s.value)),r=n(s.value);-1!==t&&-1!==r&&(e=s)}if(!e){let t=r.tail;for(;t;){let r=t;if(t=t.previous,r){let t=this.mirror.getId(lN(r.value));if(-1===n(r.value))continue;if(-1!==t){e=r;break}{let t=lN(r.value);if(t&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let n=lj(t);if(-1!==this.mirror.getId(n)){e=r;break}}}}}}if(!e){for(;r.head;)r.removeNode(r.head.value);break}s=e.previous,r.removeNode(e.value),i(e.value)}let o={texts:this.texts.map(e=>{let t=e.node,r=lN(t);return r&&"TEXTAREA"===r.tagName&&this.genTextAreaValueMutation(r),{id:this.mirror.getId(t),value:e.value}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>{let{attributes:t}=e;if("string"==typeof t.style){let r=JSON.stringify(e.styleDiff),n=JSON.stringify(e._unchangedStyles);r.length<t.style.length&&(r+n).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(o.texts.length||o.attributes.length||o.removes.length||o.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.removesSubTreeCache=new Set,this.movedMap={},this.mutationCb(o))}),i9(this,"genTextAreaValueMutation",e=>{let t=this.attributeMap.get(e);t||(t={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(t),this.attributeMap.set(e,t));let r=Array.from(lP(e),e=>lL(e)||"").join("");t.attributes.value=sb({element:e,maskInputOptions:this.maskInputOptions,tagName:e.tagName,type:sS(e),value:r,maskInputFn:this.maskInputFn})}),i9(this,"processMutation",e=>{if(!l0(e.target,this.mirror,this.slimDOMOptions))switch(e.type){case"characterData":{let t=lL(e.target);lX(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:sq(e.target,this.maskTextClass,this.maskTextSelector,!0)&&t?this.maskTextFn?this.maskTextFn(t,lJ(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{let t=e.target,r=e.attributeName,n=e.target.getAttribute(r);if("value"===r){let e=sS(t);n=sb({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:e,value:n,maskInputFn:this.maskInputFn})}if(lX(e.target,this.blockClass,this.blockSelector,!1)||n===e.oldValue)return;let i=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===r&&!this.keepIframeSrcFn(n))if(t.contentDocument)return;else r="rr_src";if(i||(i={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i),this.attributeMap.set(e.target,i)),"type"===r&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!sj(t.tagName,r))if(i.attributes[r]=sF(this.doc,sw(t.tagName),sw(r),n),"style"===r){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}let r=this.unattachedDoc.createElement("span");for(let n of(e.oldValue&&r.setAttribute("style",e.oldValue),Array.from(t.style))){let e=t.style.getPropertyValue(n),s=t.style.getPropertyPriority(n);e!==r.style.getPropertyValue(n)||s!==r.style.getPropertyPriority(n)?""===s?i.styleDiff[n]=e:i.styleDiff[n]=[e,s]:i._unchangedStyles[n]=[e,s]}for(let e of Array.from(r.style))""===t.style.getPropertyValue(e)&&(i.styleDiff[e]=!1)}else"open"===r&&"DIALOG"===t.tagName&&(t.matches("dialog:modal")?i.attributes.rr_open_mode="modal":i.attributes.rr_open_mode="non-modal");break}case"childList":if(lX(e.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===e.target.tagName)return void this.genTextAreaValueMutation(e.target);e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{let r=this.mirror.getId(t),n=sf(e.target)?this.mirror.getId(lj(e.target)):this.mirror.getId(e.target);!(lX(e.target,this.blockClass,this.blockSelector,!1)||l0(t,this.mirror,this.slimDOMOptions))&&lQ(t,this.mirror)&&(this.addedSet.has(t)?(uf(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===r||l1(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[ud(r,n)]?uf(this.movedSet,t):(this.removes.push({parentId:n,id:r,isShadow:!!(sf(e.target)&&sg(e.target))||void 0}),function(e,t){let r=[e];for(;r.length;){let e=r.pop();t.has(e)||(t.add(e),lP(e).forEach(e=>r.push(e)))}}(t,this.removesSubTreeCache))),this.mapRemoves.push(t))})}}),i9(this,"genAdds",(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(l0(e,this.mirror,this.slimDOMOptions))return;this.movedSet.add(e);let r=null;t&&this.mirror.hasNode(t)&&(r=this.mirror.getId(t)),r&&-1!==r&&(this.movedMap[ud(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);!lX(e,this.blockClass,this.blockSelector,!1)&&(lP(e).forEach(e=>this.genAdds(e)),l6(e)&&lP(lB(e)).forEach(t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)}))}})}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function uf(e,t){e.delete(t),lP(t).forEach(t=>uf(e,t))}function ug(e,t,r){var n;let i;return 0!==e.size&&(n=e,!!(i=lN(t))&&n.has(i))}function um(e,t){return 0!==e.size&&function e(t,r){let n=lN(r);return!!n&&(!!t.has(n)||e(t,n))}(e,t)}let uv=e=>b?(...t)=>{try{return e(...t)}catch(e){if(b&&!0===b(e))return;throw e}}:e;function uy(e){return(...t)=>{try{return e(...t)}catch(e){try{e._external_=!0}catch{}throw e}}}let ub=[];function uw(e){try{if("composedPath"in e){let t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function u_(e,t){let r=new up;ub.push(r),r.init(e);let n=new(lO("MutationObserver")).constructor(uv(r.processMutations.bind(r)));return n.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),n}function uS({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,sampling:s}){return lq("scroll",uv(lW(uv(s=>{let o=uw(s);if(!o||lX(o,n,i,!0))return;let a=r.getId(o);if(o===t&&t.defaultView){let r=lZ(t.defaultView);e({id:a,x:r.left,y:r.top})}else e({id:a,x:o.scrollLeft,y:o.scrollTop})}),s.scroll||100)),t)}let uI=["INPUT","TEXTAREA","SELECT"],uC=new WeakMap;function uE(e){var t=[];if(uR("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||uR("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||uR("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||uR("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){let r=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(r)}else if(e.parentStyleSheet){let r=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(r)}return t}function uk(e,t,r){let n,i;return e?(e.ownerNode?n=t.getId(e.ownerNode):i=r.getId(e),{styleId:i,id:n}):{}}function ux({mirror:e,stylesheetManager:t},r){var n,i,s;let o=null;o="#document"===r.nodeName?e.getId(r):e.getId(lj(r));let a="#document"===r.nodeName?null==(n=r.defaultView)?void 0:n.Document:null==(s=null==(i=r.ownerDocument)?void 0:i.defaultView)?void 0:s.ShadowRoot,l=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==o&&-1!==o&&a&&l?(Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var e;return null==(e=l.get)?void 0:e.call(this)},set(e){var r;let n=null==(r=l.set)?void 0:r.call(this,e);if(null!==o&&-1!==o)try{t.adoptStyleSheets(e,o)}catch(e){}return n}}),uv(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})})):()=>{}}function uO(e,t={}){let r,n=e.doc.defaultView;if(!n)return()=>{};!function(e,t){let{mutationCb:r,mousemoveCb:n,mouseInteractionCb:i,scrollCb:s,viewportResizeCb:o,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:u,styleDeclarationCb:c,canvasMutationCb:h,fontCb:d,selectionCb:p,customElementCb:f}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),r(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),n(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),i(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),s(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),o(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),l(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),u(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),c(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),h(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),d(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),p(...e)},e.customElementCb=(...e)=>{t.customElement&&t.customElement(...e),f(...e)}}(e,t),e.recordDOM&&(r=u_(e,e.doc));let i=function({mousemoveCb:e,sampling:t,doc:r,mirror:n}){let i;if(!1===t.mousemove)return()=>{};let s="number"==typeof t.mousemove?t.mousemove:50,o="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500,a=[],l=lW(uv(t=>{let r=Date.now()-i;e(a.map(e=>(e.timeOffset-=r,e)),t),a=[],i=null}),o),u=uv(lW(uv(e=>{let t=uw(e),{clientX:r,clientY:s}=l2(e)?e.changedTouches[0]:e;i||(i=lY()),a.push({x:r,y:s,id:n.getId(t),timeOffset:lY()-i}),l("undefined"!=typeof DragEvent&&e instanceof DragEvent?ui.Drag:e instanceof MouseEvent?ui.MouseMove:ui.TouchMove)}),s,{trailing:!1})),c=[lq("mousemove",u,r),lq("touchmove",u,r),lq("drag",u,r)];return uv(()=>{c.forEach(e=>e())})}(e),s=function({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,sampling:s}){if(!1===s.mouseInteraction)return()=>{};let o=!0===s.mouseInteraction||void 0===s.mouseInteraction?{}:s.mouseInteraction,a=[],l=null;return Object.keys(us).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==o[e]).forEach(s=>{let o=sw(s),u=t=>{let o=uw(t);if(lX(o,n,i,!0))return;let a=null,u=s;if("pointerType"in t){switch(t.pointerType){case"mouse":a=uo.Mouse;break;case"touch":a=uo.Touch;break;case"pen":a=uo.Pen}a===uo.Touch?us[s]===us.MouseDown?u="TouchStart":us[s]===us.MouseUp&&(u="TouchEnd"):uo.Pen}else l2(t)&&(a=uo.Touch);null!==a?(l=a,(u.startsWith("Touch")&&a===uo.Touch||u.startsWith("Mouse")&&a===uo.Mouse)&&(a=null)):us[s]===us.Click&&(a=l,l=null);let c=l2(t)?t.changedTouches[0]:t;if(!c)return;let h=r.getId(o),{clientX:d,clientY:p}=c;uv(e)({type:us[u],id:h,x:d,y:p,...null!==a&&{pointerType:a}})};if(window.PointerEvent)switch(us[s]){case us.MouseDown:case us.MouseUp:o=o.replace("mouse","pointer");break;case us.TouchStart:case us.TouchEnd:return}a.push(lq(o,u,t))}),uv(()=>{a.forEach(e=>e())})}(e),o=uS(e),a=function({viewportResizeCb:e},{win:t}){let r=-1,n=-1;return lq("resize",uv(lW(uv(()=>{let t=l$(),i=lH();(r!==t||n!==i)&&(e({width:Number(i),height:Number(t)}),r=t,n=i)}),200)),t)}(e,{win:n}),l=function({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,ignoreClass:s,ignoreSelector:o,maskInputOptions:a,maskInputFn:l,sampling:u,userTriggeredOnInput:c}){function h(e){let r=uw(e),u=e.isTrusted,h=r&&r.tagName;if(r&&"OPTION"===h&&(r=lD(r)),!r||!h||0>uI.indexOf(h)||lX(r,n,i,!0)||r.classList.contains(s)||o&&r.matches(o))return;let p=r.value,f=!1,g=sS(r)||"";"radio"===g||"checkbox"===g?f=r.checked:(a[h.toLowerCase()]||a[g])&&(p=sb({element:r,maskInputOptions:a,tagName:h,type:g,value:p,maskInputFn:l})),d(r,c?{text:p,isChecked:f,userTriggered:u}:{text:p,isChecked:f});let m=r.name;"radio"===g&&m&&f&&t.querySelectorAll(`input[type="radio"][name="${m}"]`).forEach(e=>{if(e!==r){let t=e.value;d(e,c?{text:t,isChecked:!f,userTriggered:!1}:{text:t,isChecked:!f})}})}function d(t,n){let i=uC.get(t);if(!i||i.text!==n.text||i.isChecked!==n.isChecked){uC.set(t,n);let i=r.getId(t);uv(e)({...n,id:i})}}let p=("last"===u.input?["change"]:["input","change"]).map(e=>lq(e,uv(h),t)),f=t.defaultView;if(!f)return()=>{p.forEach(e=>e())};let g=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),m=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&p.push(...m.map(e=>lG(e[0],e[1],{set(){uv(h)({target:this,isTrusted:!1})}},!1,f))),uv(()=>{p.forEach(e=>e())})}(e),u=function({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:i,doc:s}){let o=uv(s=>lW(uv(i=>{let o=uw(i);if(!o||lX(o,t,r,!0))return;let{currentTime:a,volume:l,muted:u,playbackRate:c,loop:h}=o;e({type:s,id:n.getId(o),currentTime:a,volume:l,muted:u,playbackRate:c,loop:h})}),i.media||500)),a=[lq("play",o(ul.Play),s),lq("pause",o(ul.Pause),s),lq("seeked",o(ul.Seeked),s),lq("volumechange",o(ul.VolumeChange),s),lq("ratechange",o(ul.RateChange),s)];return uv(()=>{a.forEach(e=>e())})}(e),c=()=>{},h=()=>{},d=()=>{},p=()=>{};e.recordDOM&&(c=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){let i,s;if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};let o=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:uv((n,i,s)=>{let[o,a]=s,{id:l,styleId:u}=uk(i,t,r.styleMirror);return(l&&-1!==l||u&&-1!==u)&&e({id:l,styleId:u,adds:[{rule:o,index:a}]}),uy(()=>n.apply(i,s))()})}),n.CSSStyleSheet.prototype.addRule=function(e,t,r=this.cssRules.length){let i=`${e} { ${t} }`;return n.CSSStyleSheet.prototype.insertRule.apply(this,[i,r])};let a=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:uv((n,i,s)=>{let[o]=s,{id:a,styleId:l}=uk(i,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,removes:[{index:o}]}),uy(()=>n.apply(i,s))()})}),n.CSSStyleSheet.prototype.removeRule=function(e){return n.CSSStyleSheet.prototype.deleteRule.apply(this,[e])},n.CSSStyleSheet.prototype.replace&&(i=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:uv((n,i,s)=>{let[o]=s,{id:a,styleId:l}=uk(i,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,replace:o}),n.apply(i,s)})})),n.CSSStyleSheet.prototype.replaceSync&&(s=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(s,{apply:uv((n,i,s)=>{let[o]=s,{id:a,styleId:l}=uk(i,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,replaceSync:o}),n.apply(i,s)})}));let l={};uT("CSSGroupingRule")?l.CSSGroupingRule=n.CSSGroupingRule:(uT("CSSMediaRule")&&(l.CSSMediaRule=n.CSSMediaRule),uT("CSSConditionRule")&&(l.CSSConditionRule=n.CSSConditionRule),uT("CSSSupportsRule")&&(l.CSSSupportsRule=n.CSSSupportsRule));let u={};return Object.entries(l).forEach(([n,i])=>{u[n]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=new Proxy(u[n].insertRule,{apply:uv((n,i,s)=>{let[o,a]=s,{id:l,styleId:u}=uk(i.parentStyleSheet,t,r.styleMirror);return(l&&-1!==l||u&&-1!==u)&&e({id:l,styleId:u,adds:[{rule:o,index:[...uE(i),a||0]}]}),n.apply(i,s)})}),i.prototype.deleteRule=new Proxy(u[n].deleteRule,{apply:uv((n,i,s)=>{let[o]=s,{id:a,styleId:l}=uk(i.parentStyleSheet,t,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&e({id:a,styleId:l,removes:[{index:[...uE(i),o]}]}),n.apply(i,s)})})}),uv(()=>{n.CSSStyleSheet.prototype.insertRule=o,n.CSSStyleSheet.prototype.deleteRule=a,i&&(n.CSSStyleSheet.prototype.replace=i),s&&(n.CSSStyleSheet.prototype.replaceSync=s),Object.entries(l).forEach(([e,t])=>{t.prototype.insertRule=u[e].insertRule,t.prototype.deleteRule=u[e].deleteRule})})}(e,{win:n}),h=ux(e,e.doc),d=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:i}){let s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:uv((i,o,a)=>{var l;let[u,c,h]=a;if(r.has(u))return s.apply(o,[u,c,h]);let{id:d,styleId:p}=uk(null==(l=o.parentRule)?void 0:l.parentStyleSheet,t,n.styleMirror);return(d&&-1!==d||p&&-1!==p)&&e({id:d,styleId:p,set:{property:u,value:c,priority:h},index:uE(o.parentRule)}),i.apply(o,a)})});let o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:uv((i,s,a)=>{var l;let[u]=a;if(r.has(u))return o.apply(s,[u]);let{id:c,styleId:h}=uk(null==(l=s.parentRule)?void 0:l.parentStyleSheet,t,n.styleMirror);return(c&&-1!==c||h&&-1!==h)&&e({id:c,styleId:h,remove:{property:u},index:uE(s.parentRule)}),i.apply(s,a)})}),uv(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}(e,{win:n}),e.collectFonts&&(p=function({fontCb:e,doc:t}){let r=t.defaultView;if(!r)return()=>{};let n=[],i=new WeakMap,s=r.FontFace;r.FontFace=function(e,t,r){let n=new s(e,t,r);return i.set(n,{family:e,buffer:"string"!=typeof t,descriptors:r,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),n};let o=lK(t.fonts,"add",function(t){return function(r){return setTimeout(uv(()=>{let t=i.get(r);t&&(e(t),i.delete(r))}),0),t.apply(this,[r])}});return n.push(()=>{r.FontFace=s}),n.push(o),uv(()=>{n.forEach(e=>e())})}(e)));let f=function(e){let{doc:t,mirror:r,blockClass:n,blockSelector:i,selectionCb:s}=e,o=!0,a=uv(()=>{let e=t.getSelection();if(!e||o&&(null==e?void 0:e.isCollapsed))return;o=e.isCollapsed||!1;let a=[],l=e.rangeCount||0;for(let t=0;t<l;t++){let{startContainer:s,startOffset:o,endContainer:l,endOffset:u}=e.getRangeAt(t);lX(s,n,i,!0)||lX(l,n,i,!0)||a.push({start:r.getId(s),startOffset:o,end:r.getId(l),endOffset:u})}s({ranges:a})});return a(),lq("selectionchange",a)}(e),g=function({doc:e,customElementCb:t}){let r=e.defaultView;return r&&r.customElements?lK(r.customElements,"define",function(e){return function(r,n,i){try{t({define:{name:r}})}catch(e){console.warn(`Custom element callback failed for ${r}`)}return e.apply(this,[r,n,i])}}):()=>{}}(e),m=[];for(let t of e.plugins)m.push(t.observer(t.callback,n,t.options));return uv(()=>{ub.forEach(e=>e.reset()),null==r||r.disconnect(),i(),s(),o(),a(),l(),u(),c(),h(),d(),p(),f(),g(),m.forEach(e=>e())})}function uR(e){return void 0!==window[e]}function uT(e){return!!(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class uA{constructor(e){i9(this,"iframeIdToRemoteIdMap",new WeakMap),i9(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=e}getId(e,t,r,n){let i=r||this.getIdToRemoteIdMap(e),s=n||this.getRemoteIdToIdMap(e),o=i.get(t);return o||(o=this.generateIdFn(),i.set(t,o),s.set(o,t)),o}getIds(e,t){let r=this.getIdToRemoteIdMap(e),n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,r,n))}getRemoteId(e,t,r){let n=r||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;let i=n.get(t);return i||-1}getRemoteIds(e,t){let r=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class uM{constructor(e){i9(this,"iframes",new WeakMap),i9(this,"crossOriginIframeMap",new WeakMap),i9(this,"crossOriginIframeMirror",new uA(sM)),i9(this,"crossOriginIframeStyleMirror"),i9(this,"crossOriginIframeRootIdMap",new WeakMap),i9(this,"mirror"),i9(this,"mutationCb"),i9(this,"wrappedEmit"),i9(this,"loadListener"),i9(this,"stylesheetManager"),i9(this,"recordCrossOriginIframes"),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new uA(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var r,n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(r=e.contentWindow)||r.addEventListener("message",this.handleMessage.bind(this))),null==(n=this.loadListener)||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){if("rrweb"!==e.data.type||e.origin!==e.data.origin||!e.source)return;let t=this.crossOriginIframeMap.get(e.source);if(!t)return;let r=this.transformCrossOriginEvent(t,e.data.event);r&&this.wrappedEmit(r,e.data.isCheckout)}transformCrossOriginEvent(e,t){var r;switch(t.type){case un.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);let r=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,r),this.patchRootIdOnNode(t.data.node,r),{timestamp:t.timestamp,type:un.IncrementalSnapshot,data:{source:ui.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case un.Meta:case un.Load:case un.DomContentLoaded:break;case un.Plugin:return t;case un.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case un.IncrementalSnapshot:switch(t.data.source){case ui.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);let r=this.crossOriginIframeRootIdMap.get(e);r&&this.patchRootIdOnNode(t.node,r)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case ui.Drag:case ui.TouchMove:case ui.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case ui.ViewportResize:return!1;case ui.MediaInteraction:case ui.MouseInteraction:case ui.Scroll:case ui.CanvasMutation:case ui.Input:return this.replaceIds(t.data,e,["id"]),t;case ui.StyleSheetRule:case ui.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case ui.Font:return t;case ui.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case ui.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null==(r=t.data.styles)||r.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}return!1}replace(e,t,r,n){for(let i of n)(Array.isArray(t[i])||"number"==typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(r,t[i]):t[i]=e.getId(r,t[i]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}patchRootIdOnNode(e,t){e.type===uc.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach(e=>{this.patchRootIdOnNode(e,t)})}}class uP{constructor(e){i9(this,"shadowDoms",new WeakSet),i9(this,"mutationCb"),i9(this,"scrollCb"),i9(this,"bypassOptions"),i9(this,"mirror"),i9(this,"restoreHandlers",[]),this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!sg(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let r=u_({...this.bypassOptions,doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(uS({...this.bypassOptions,scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(lj(e))),this.restoreHandlers.push(ux({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){let r=this;this.restoreHandlers.push(lK(e.prototype,"attachShadow",function(e){return function(n){let i=e.call(this,n),s=lB(this);return s&&ut(this)&&r.addShadowRoot(s,t),i}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var uN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uD="undefined"==typeof Uint8Array?[]:new Uint8Array(256),uL=0;uL<uN.length;uL++)uD[uN.charCodeAt(uL)]=uL;var uU=function(e){var t,r=new Uint8Array(e),n=r.length,i="";for(t=0;t<n;t+=3)i+=uN[r[t]>>2],i+=uN[(3&r[t])<<4|r[t+1]>>4],i+=uN[(15&r[t+1])<<2|r[t+2]>>6],i+=uN[63&r[t+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i};let uF=new Map,uj=(e,t,r)=>{let n;if(!e||!(uq(e,t)||"object"==typeof e))return;let i=e.constructor.name,s=((n=uF.get(r))||(n=new Map,uF.set(r,n)),n.has(i)||n.set(i,[]),n.get(i)),o=s.indexOf(e);return -1===o&&(o=s.length,s.push(e)),o},uB=(e,t,r)=>e.map(e=>(function e(t,r,n){if(t instanceof Array)return t.map(t=>e(t,r,n));if(null===t);else if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};else if(t instanceof ArrayBuffer)return{rr_type:t.constructor.name,base64:uU(t)};else if(t instanceof DataView)return{rr_type:t.constructor.name,args:[e(t.buffer,r,n),t.byteOffset,t.byteLength]};else if(t instanceof HTMLImageElement){let e=t.constructor.name,{src:r}=t;return{rr_type:e,src:r}}else if(t instanceof HTMLCanvasElement)return{rr_type:"HTMLImageElement",src:t.toDataURL()};else if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[e(t.data,r,n),t.width,t.height]};else if(uq(t,r)||"object"==typeof t)return{rr_type:t.constructor.name,index:uj(t,r,n)};return t})(e,t,r)),uq=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]).find(r=>e instanceof t[r]);function uz(e,t,r,n){let i=[];try{let s=lK(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(i,...s){if(!lX(this,t,r,!0)){let e="experimental-webgl"===i?"webgl":i;if("__context"in this||(this.__context=e),n&&["webgl","webgl2"].includes(e))if(s[0]&&"object"==typeof s[0]){let e=s[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else s.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[i,...s])}});i.push(s)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(e=>e())}}function uV(e,t,r,n,i,s){let o=[];for(let a of Object.getOwnPropertyNames(e))if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(a))try{if("function"!=typeof e[a])continue;let l=lK(e,a,function(e){return function(...o){let l=e.apply(this,o);if(uj(l,s,this),"tagName"in this.canvas&&!lX(this.canvas,n,i,!0)){let e=uB(o,s,this),n={type:t,property:a,args:e};r(this.canvas,n)}return l}});o.push(l)}catch{let n=lG(e,a,{set(e){r(this.canvas,{type:t,property:a,args:[e],setter:!0})}});o.push(n)}return o}let uW="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",uG="undefined"!=typeof window&&window.Blob&&new Blob([Uint8Array.from(atob(uW),e=>e.charCodeAt(0))],{type:"text/javascript;charset=utf-8"});function uK(e){let t;try{if(!(t=uG&&(window.URL||window.webkitURL).createObjectURL(uG)))throw"";let r=new Worker(t,{name:null==e?void 0:e.name});return r.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(t)}),r}catch(t){return new Worker("data:text/javascript;base64,"+uW,{name:null==e?void 0:e.name})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}class uY{constructor(e){i9(this,"pendingCanvasMutations",new Map),i9(this,"rafStamps",{latestId:0,invokeId:null}),i9(this,"mirror"),i9(this,"mutationCb"),i9(this,"resetObservers"),i9(this,"frozen",!1),i9(this,"locked",!1),i9(this,"processMutation",(e,t)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)});const{sampling:t="all",win:r,blockClass:n,blockSelector:i,recordCanvas:s,dataURLOptions:o}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,s&&"all"===t&&this.initCanvasMutationObserver(r,n,i),s&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,n,i,{dataURLOptions:o})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,t,r,n,i){let s,o=uz(t,r,n,!0),a=new Map,l=new uK;l.onmessage=e=>{let{id:t}=e.data;if(a.set(t,!1),!("base64"in e.data))return;let{base64:r,type:n,width:i,height:s}=e.data;this.mutationCb({id:t,type:ua["2D"],commands:[{property:"clearRect",args:[0,0,i,s]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:n}]},0,0]}]})};let u=1e3/e,c=0,h=e=>{let o;if(c&&e-c<u){s=requestAnimationFrame(h);return}c=e,(o=[],t.document.querySelectorAll("canvas").forEach(e=>{lX(e,r,n,!0)||o.push(e)}),o).forEach(async e=>{var t;let r=this.mirror.getId(e);if(a.get(r)||0===e.width||0===e.height)return;if(a.set(r,!0),["webgl","webgl2"].includes(e.__context)){let r=e.getContext(e.__context);(null==(t=null==r?void 0:r.getContextAttributes())?void 0:t.preserveDrawingBuffer)===!1&&r.clear(r.COLOR_BUFFER_BIT)}let n=await createImageBitmap(e);l.postMessage({id:r,bitmap:n,width:e.width,height:e.height,dataURLOptions:i.dataURLOptions},[n])}),s=requestAnimationFrame(h)};s=requestAnimationFrame(h),this.resetObservers=()=>{o(),cancelAnimationFrame(s)}}initCanvasMutationObserver(e,t,r){var n;let i;this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let s=uz(e,t,r,!1),o=function(e,t,r,n){let i=[];for(let s of Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype))try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[s])continue;let o=lK(t.CanvasRenderingContext2D.prototype,s,function(i){return function(...o){return lX(this.canvas,r,n,!0)||setTimeout(()=>{let r=uB(o,t,this);e(this.canvas,{type:ua["2D"],property:s,args:r})},0),i.apply(this,o)}});i.push(o)}catch{let r=lG(t.CanvasRenderingContext2D.prototype,s,{set(t){e(this.canvas,{type:ua["2D"],property:s,args:[t],setter:!0})}});i.push(r)}return()=>{i.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r),a=(n=this.processMutation.bind(this),(i=[]).push(...uV(e.WebGLRenderingContext.prototype,ua.WebGL,n,t,r,e)),void 0!==e.WebGL2RenderingContext&&i.push(...uV(e.WebGL2RenderingContext.prototype,ua.WebGL2,n,t,r,e)),()=>{i.forEach(e=>e())});this.resetObservers=()=>{s(),o(),a()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{let r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;let r=this.pendingCanvasMutations.get(e);if(!r||-1===t)return;let n=r.map(e=>{let{type:t,...r}=e;return r}),{type:i}=r[0];this.mutationCb({id:t,type:i,commands:n}),this.pendingCanvasMutations.delete(e)}}class uZ{constructor(e){i9(this,"trackedLinkElements",new WeakSet),i9(this,"mutationCb"),i9(this,"adoptedStyleSheetCb"),i9(this,"styleMirror",new l8),this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;let r={id:t,styleIds:[]},n=[];for(let t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),n.push({styleId:e,rules:Array.from(t.rules||CSSRule,(e,r)=>({rule:sv(e,t.href),index:r}))})),r.styleIds.push(e)}n.length>0&&(r.styles=n),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class u${constructor(){i9(this,"nodeMap",new WeakMap),i9(this,"active",!1)}inOtherBuffer(e,t){let r=this.nodeMap.get(e);return r&&Array.from(r).some(e=>e!==t)}add(e,t){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}destroy(){}}let uH=!1;try{if(2!==Array.from([1],e=>2*e)[0]){let e=document.createElement("iframe");document.body.appendChild(e),Array.from=(null==(ex=e.contentWindow)?void 0:ex.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}let uJ=new sy;function uX(e={}){let t,{emit:r,checkoutEveryNms:n,checkoutEveryNth:i,blockClass:s="rr-block",blockSelector:o=null,ignoreClass:a="rr-ignore",ignoreSelector:l=null,maskTextClass:u="rr-mask",maskTextSelector:c=null,inlineStylesheet:h=!0,maskAllInputs:d,maskInputOptions:p,slimDOMOptions:f,maskInputFn:g,maskTextFn:m,hooks:v,packFn:y,sampling:I={},dataURLOptions:C={},mousemoveWait:E,recordDOM:k=!0,recordCanvas:x=!1,recordCrossOriginIframes:O=!1,recordAfter:R="DOMContentLoaded"===e.recordAfter?e.recordAfter:"load",userTriggeredOnInput:T=!1,collectFonts:A=!1,inlineImages:M=!1,plugins:P,keepIframeSrcFn:N=()=>!1,ignoreCSSAttributes:D=new Set([]),errorHandler:L}=e;b=L;let U=!O||window.parent===window,F=!1;if(!U)try{window.parent.document&&(F=!1)}catch(e){F=!0}if(U&&!r)throw Error("emit function is required");if(!U&&!F)return()=>{};void 0!==E&&void 0===I.mousemove&&(I.mousemove=E),uJ.reset();let j=!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==p?p:{password:!0},B=!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===f,headMetaDescKeywords:"all"===f,headTitleMutations:"all"===f}:f||{};l3();let q=0,z=e=>{for(let t of P||[])t.eventProcessor&&(e=t.eventProcessor(e));return y&&!F&&(e=y(e)),e};w=(e,s)=>{var o;if(e.timestamp=lY(),(null==(o=ub[0])?void 0:o.isFrozen())&&e.type!==un.FullSnapshot&&(e.type!==un.IncrementalSnapshot||e.data.source!==ui.Mutation)&&ub.forEach(e=>e.unfreeze()),U)null==r||r(z(e),s);else if(F){let t={type:"rrweb",event:z(e),origin:window.location.origin,isCheckout:s};window.parent.postMessage(t,"*")}if(e.type===un.FullSnapshot)t=e,q=0;else if(e.type===un.IncrementalSnapshot){if(e.data.source===ui.Mutation&&e.data.isAttachIframe)return;q++;let r=i&&q>=i,s=n&&e.timestamp-t.timestamp>n;(r||s)&&_(!0)}};let V=e=>{w({type:un.IncrementalSnapshot,data:{source:ui.Mutation,...e}})},W=e=>w({type:un.IncrementalSnapshot,data:{source:ui.Scroll,...e}}),G=e=>w({type:un.IncrementalSnapshot,data:{source:ui.CanvasMutation,...e}}),K=new uZ({mutationCb:V,adoptedStyleSheetCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.AdoptedStyleSheet,...e}})}),Y=new uM({mirror:uJ,mutationCb:V,stylesheetManager:K,recordCrossOriginIframes:O,wrappedEmit:w});for(let e of P||[])e.getMirror&&e.getMirror({nodeMirror:uJ,crossOriginIframeMirror:Y.crossOriginIframeMirror,crossOriginIframeStyleMirror:Y.crossOriginIframeStyleMirror});let Z=new u$;S=new uY({recordCanvas:x,mutationCb:G,win:window,blockClass:s,blockSelector:o,mirror:uJ,sampling:I.canvas,dataURLOptions:C});let $=new uP({mutationCb:V,scrollCb:W,bypassOptions:{blockClass:s,blockSelector:o,maskTextClass:u,maskTextSelector:c,inlineStylesheet:h,maskInputOptions:j,dataURLOptions:C,maskTextFn:m,maskInputFn:g,recordCanvas:x,inlineImages:M,sampling:I,slimDOMOptions:B,iframeManager:Y,stylesheetManager:K,canvasManager:S,keepIframeSrcFn:N,processedNodeManager:Z},mirror:uJ});_=(e=!1)=>{if(!k)return;w({type:un.Meta,data:{href:window.location.href,width:lH(),height:l$()}},e),K.reset(),$.init(),ub.forEach(e=>e.lock());let t=function(e,t){let{mirror:r=new sy,blockClass:n="rr-block",blockSelector:i=null,maskTextClass:s="rr-mask",maskTextSelector:o=null,inlineStylesheet:a=!0,inlineImages:l=!1,recordCanvas:u=!1,maskAllInputs:c=!1,maskTextFn:h,maskInputFn:d,slimDOM:p=!1,dataURLOptions:f,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:b,stylesheetLoadTimeout:w,keepIframeSrcFn:_=()=>!1}=t||{};return sV(e,{doc:e,mirror:r,blockClass:n,blockSelector:i,maskTextClass:s,maskTextSelector:o,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===c?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===c?{password:!0}:c,maskTextFn:h,maskInputFn:d,slimDOMOptions:!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===p,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===p?{}:p,dataURLOptions:f,inlineImages:l,recordCanvas:u,preserveWhiteSpace:g,onSerialize:m,onIframeLoad:v,iframeLoadTimeout:y,onStylesheetLoad:b,stylesheetLoadTimeout:w,keepIframeSrcFn:_,newlyAddedElement:!1})}(document,{mirror:uJ,blockClass:s,blockSelector:o,maskTextClass:u,maskTextSelector:c,inlineStylesheet:h,maskAllInputs:j,maskTextFn:m,maskInputFn:g,slimDOM:B,dataURLOptions:C,recordCanvas:x,inlineImages:M,onSerialize:e=>{l4(e,uJ)&&Y.addIframe(e),l5(e,uJ)&&K.trackLinkElement(e),l6(e)&&$.addShadowRoot(lB(e),document)},onIframeLoad:(e,t)=>{Y.attachIframe(e,t),$.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{K.attachLinkElement(e,t)},keepIframeSrcFn:N});if(!t)return console.warn("Failed to snapshot the document");w({type:un.FullSnapshot,data:{node:t,initialOffset:lZ(window)}},e),ub.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&K.adoptStyleSheets(document.adoptedStyleSheets,uJ.getId(document))};try{let e=[],t=e=>{var t;return uv(uO)({mutationCb:V,mousemoveCb:(e,t)=>w({type:un.IncrementalSnapshot,data:{source:t,positions:e}}),mouseInteractionCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.MouseInteraction,...e}}),scrollCb:W,viewportResizeCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.ViewportResize,...e}}),inputCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.Input,...e}}),mediaInteractionCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.MediaInteraction,...e}}),styleSheetRuleCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.StyleSheetRule,...e}}),styleDeclarationCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.StyleDeclaration,...e}}),canvasMutationCb:G,fontCb:e=>w({type:un.IncrementalSnapshot,data:{source:ui.Font,...e}}),selectionCb:e=>{w({type:un.IncrementalSnapshot,data:{source:ui.Selection,...e}})},customElementCb:e=>{w({type:un.IncrementalSnapshot,data:{source:ui.CustomElement,...e}})},blockClass:s,ignoreClass:a,ignoreSelector:l,maskTextClass:u,maskTextSelector:c,maskInputOptions:j,inlineStylesheet:h,sampling:I,recordDOM:k,recordCanvas:x,inlineImages:M,userTriggeredOnInput:T,collectFonts:A,doc:e,maskInputFn:g,maskTextFn:m,keepIframeSrcFn:N,blockSelector:o,slimDOMOptions:B,dataURLOptions:C,mirror:uJ,iframeManager:Y,stylesheetManager:K,shadowDomManager:$,processedNodeManager:Z,canvasManager:S,ignoreCSSAttributes:D,plugins:(null==(t=null==P?void 0:P.filter(e=>e.observer))?void 0:t.map(e=>({observer:e.observer,options:e.options,callback:t=>w({type:un.Plugin,data:{plugin:e.name,payload:t}})})))||[]},v)};Y.addLoadListener(r=>{try{e.push(t(r.contentDocument))}catch(e){console.warn(e)}});let r=()=>{_(),e.push(t(document)),uH=!0};return"interactive"===document.readyState||"complete"===document.readyState?r():(e.push(lq("DOMContentLoaded",()=>{w({type:un.DomContentLoaded,data:{}}),"DOMContentLoaded"===R&&r()})),e.push(lq("load",()=>{w({type:un.Load,data:{}}),"load"===R&&r()},window))),()=>{e.forEach(e=>e()),Z.destroy(),uH=!1,b=void 0}}catch(e){console.warn(e)}}uX.addCustomEvent=(e,t)=>{if(!uH)throw Error("please add custom event after start recording");w({type:un.Custom,data:{tag:e,payload:t}})},uX.freezePage=()=>{ub.forEach(e=>e.freeze())},uX.takeFullSnapshot=e=>{if(!uH)throw Error("please take full snapshot after start recording");_(e)},uX.mirror=uJ,(Q=eO||(eO={}))[Q.NotStarted=0]="NotStarted",Q[Q.Running=1]="Running",Q[Q.Stopped=2]="Stopped";let{addCustomEvent:uQ}=uX,{freezePage:u0}=uX,{takeFullSnapshot:u1}=uX;(ee=eR||(eR={})).Unknown="unknown",ee.Skipped="skipped",ee.Success="success",ee.RateLimit="rate_limit",ee.PayloadTooLarge="payload_too_large",ee.Invalid="invalid",ee.Failed="failed",ee.Timeout="Timeout",ee.SystemError="SystemError";var u2=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,r,n,i,s,o,a,l,u,c,h,d,p,f,g,m,v,y,b,w,_,S,I=e.code||0,C=this.buildStatus(I);switch(C){case eR.Success:return{status:C,statusCode:I,body:{eventsIngested:null!=(t=e.events_ingested)?t:0,payloadSizeBytes:null!=(r=e.payload_size_bytes)?r:0,serverUploadTime:null!=(n=e.server_upload_time)?n:0}};case eR.Invalid:return{status:C,statusCode:I,body:{error:null!=(i=e.error)?i:"",missingField:null!=(s=e.missing_field)?s:"",eventsWithInvalidFields:null!=(o=e.events_with_invalid_fields)?o:{},eventsWithMissingFields:null!=(a=e.events_with_missing_fields)?a:{},eventsWithInvalidIdLengths:null!=(l=e.events_with_invalid_id_lengths)?l:{},epsThreshold:null!=(u=e.eps_threshold)?u:0,exceededDailyQuotaDevices:null!=(c=e.exceeded_daily_quota_devices)?c:{},silencedDevices:null!=(h=e.silenced_devices)?h:[],silencedEvents:null!=(d=e.silenced_events)?d:[],throttledDevices:null!=(p=e.throttled_devices)?p:{},throttledEvents:null!=(f=e.throttled_events)?f:[]}};case eR.PayloadTooLarge:return{status:C,statusCode:I,body:{error:null!=(g=e.error)?g:""}};case eR.RateLimit:return{status:C,statusCode:I,body:{error:null!=(m=e.error)?m:"",epsThreshold:null!=(v=e.eps_threshold)?v:0,throttledDevices:null!=(y=e.throttled_devices)?y:{},throttledUsers:null!=(b=e.throttled_users)?b:{},exceededDailyQuotaDevices:null!=(w=e.exceeded_daily_quota_devices)?w:{},exceededDailyQuotaUsers:null!=(_=e.exceeded_daily_quota_users)?_:{},throttledEvents:null!=(S=e.throttled_events)?S:[]}};case eR.Timeout:default:return{status:C,statusCode:I}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?eR.Success:429===e?eR.RateLimit:413===e?eR.PayloadTooLarge:408===e?eR.Timeout:e>=400&&e<500?eR.Invalid:e>=500?eR.Failed:eR.Unknown},e}();(et=eT||(eT={})).US="US",et.EU="EU",et.STAGING="STAGING";var u3="Remote config fetch rejected due to timeout after 5 seconds",u4="Unexpected error occurred",u5=function(){function e(e){var t=e.localConfig,r=e.configKeys,n=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteConfig=function(e,t,r){return(0,eD.__awaiter)(n,void 0,void 0,function(){var n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:return n=Date.now(),[4,this.fetchWithTimeout(r)];case 1:if((i=o.sent())&&(s=i.configs&&i.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-n,[2,s[t]];return this.metrics.fetchTimeAPIFail=Date.now()-n,[2,void 0]}})})},this.fetchWithTimeout=function(e){return(0,eD.__awaiter)(n,void 0,void 0,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return t=new AbortController,r=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return n=i.sent(),clearTimeout(r),[2,n]}})})},this.fetchRemoteConfig=function(e,t){return(0,eD.__awaiter)(n,void 0,void 0,function(){var r,n,i,s,o,a,l,u,c,h,d;return(0,eD.__generator)(this,function(p){switch(p.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:u3})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0);p.label=1;case 1:p.trys.push([1,3,,4]),r=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=(n=(0,eD.__values)(this.configKeys)).next();!i.done;i=n.next())s=i.value,r.append("config_keys",s)}catch(e){c={error:e}}finally{try{i&&!i.done&&(h=n.return)&&h.call(n)}finally{if(c)throw c.error}}return t&&r.set("session_id",String(t)),o={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(r.toString()),this.attempts+=1,[4,fetch(a,(0,eD.__assign)((0,eD.__assign)({},o),{signal:e}))];case 2:if(null===(l=p.sent()))return[2,this.completeRequest({err:u4})];switch(new u2().buildStatus(l.status)){case eR.Success:return this.attempts=0,[2,this.parseAndStoreConfig(l)];case eR.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}case 3:if(u=p.sent(),e.aborted)return[2,this.completeRequest({err:u3})];return[2,this.completeRequest({err:null!=(d=u.message)?d:u4})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,eD.__awaiter)(n,void 0,void 0,function(){var r=this;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return[4,new Promise(function(e){return setTimeout(e,r.attempts*r.retryTimeout)})];case 1:return n.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e){return(0,eD.__awaiter)(n,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return[4,e.json()];case 1:return t=r.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}})})},this.localConfig=t,this.configKeys=r}return e.prototype.getServerUrl=function(){return this.localConfig.configServerUrl?this.localConfig.configServerUrl:this.localConfig.serverZone===eT.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===eT.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,r=e.success;if(t)throw Error(t);r&&this.localConfig.loggerProvider.log(r)},e}(),u6=function(e){var t=e.localConfig,r=e.configKeys;return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,new u5({localConfig:t,configKeys:r})]})})},u8="medium",u9=function(e,t,r){switch(t){case"light":if("input"!==e)return!0;var n,i,s=r?(i=(n=r).type,n.hasAttribute("data-rr-is-password")?"password":i?i.toLowerCase():null):"";if(!s)return!1;if(["password","hidden","email","tel"].includes(s)||r.autocomplete.startsWith("cc-"))return!0;return!1;case"medium":case"conservative":return!0;default:return u9(e,u8,r)}},u7=function(e,t,r){var n,i,s;if(void 0===t&&(t={defaultMaskLevel:u8}),r){if(r.closest("."+i1)||(null!=(n=t.maskSelector)?n:[]).some(function(e){return r.closest(e)}))return!0;if(r.closest(".amp-unmask")||(null!=(i=t.unmaskSelector)?i:[]).some(function(e){return r.closest(e)}))return!1}return u9(e,null!=(s=t.defaultMaskLevel)?s:u8,r)},ce=function(e,t){return function(r,n){return u7(e,t,n)?r.replace(/[^\s]/g,"*"):r}},ct=function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t},cr=function(){var e=eY();return(null==e?void 0:e.location)?e.location.href:""},cn=function(e,t){return t||(e===eE.STAGING?"https://api-sr.stag2.amplitude.com/sessions/v2/track":e===eE.EU?"https://api-sr.eu.amplitude.com/sessions/v2/track":"https://api-sr.amplitude.com/sessions/v2/track")},ci=function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),!(e=eY()))return[3,2];return[4,e.navigator.storage.estimate()];case 1:return r=(t=i.sent()).usage,n=t.quota,[2,{totalStorageSize:r?Math.round(r/1024):0,percentOfQuota:r&&n?Math.round((r/n+Number.EPSILON)*1e3)/1e3:0,usageDetails:JSON.stringify(t.usageDetails)}];case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2,{totalStorageSize:0,percentOfQuota:0,usageDetails:""}]}})})},cs=function(e){var t=(0,eD.__assign)({},e),r=t.apiKey;return t.apiKey="****".concat(r.substring(r.length-4)),t},co=function(e,t){var r=document.createDocumentFragment(),n=function(e){if(void 0===e&&(e=[]),"string"==typeof e&&(e=[e]),0!==(e=e.filter(function(e){try{r.querySelector(e)}catch(r){return t.warn('[session-replay-browser] omitting selector "'.concat(e,'" because it is invalid')),!1}return!0})).length)return e};return e.blockSelector=n(e.blockSelector),e.maskSelector=n(e.maskSelector),e.unmaskSelector=n(e.unmaskSelector),e},ca=function(){function e(e,t){this.localConfig=t,this.remoteConfigFetch=e}return e.prototype.generateJoinedConfig=function(e){var t,r,n;return(0,eD.__awaiter)(this,void 0,void 0,function(){var i,s,o,a,l,u,c,h,d,p,f,g,m,v,y,b,w,_,S,I;return(0,eD.__generator)(this,function(C){switch(C.label){case 0:(i=(0,eD.__assign)({},this.localConfig)).optOut=this.localConfig.optOut,i.captureEnabled=!0,C.label=1;case 1:return C.trys.push([1,6,,7]),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_sampling_config",e)];case 2:return o=C.sent(),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_privacy_config",e)];case 3:return a=C.sent(),l=i,[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_interaction_config",e)];case 4:return l.interactionConfig=C.sent(),u=i,[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_logging_config",e)];case 5:return u.loggingConfig=C.sent(),(o||a)&&(s={},o&&(s.sr_sampling_config=o),a&&(s.sr_privacy_config=a)),[3,7];case 6:return c=C.sent(),this.localConfig.loggerProvider.warn(c.message),i.captureEnabled=!1,[3,7];case 7:if(!s)return[2,{localConfig:this.localConfig,joinedConfig:i,remoteConfig:s}];if(h=s.sr_sampling_config,d=s.sr_privacy_config,h&&Object.keys(h).length>0?(Object.prototype.hasOwnProperty.call(h,"capture_enabled")?i.captureEnabled=h.capture_enabled:i.captureEnabled=!1,Object.prototype.hasOwnProperty.call(h,"sample_rate")&&(i.sampleRate=h.sample_rate)):(i.captureEnabled=!0,this.localConfig.loggerProvider.debug("Remote config successfully fetched, but no values set for project, Session Replay capture enabled.")),d){p=null!=(t=i.privacyConfig)?t:{},f={defaultMaskLevel:null!=(n=null!=(r=d.defaultMaskLevel)?r:p.defaultMaskLevel)?n:"medium",blockSelector:[],maskSelector:[],unmaskSelector:[]},g=function(e){var t,r,n,i,s,o,a,l,u,c={};"string"==typeof e.blockSelector&&(e.blockSelector=[e.blockSelector]);try{for(var h=(0,eD.__values)(null!=(a=e.blockSelector)?a:[]),d=h.next();!d.done;d=h.next()){var p=d.value;c[p]="block"}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}try{for(var f=(0,eD.__values)(null!=(l=e.maskSelector)?l:[]),g=f.next();!g.done;g=f.next()){var p=g.value;c[p]="mask"}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}try{for(var m=(0,eD.__values)(null!=(u=e.unmaskSelector)?u:[]),v=m.next();!v.done;v=m.next()){var p=v.value;c[p]="unmask"}}catch(e){s={error:e}}finally{try{v&&!v.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}return c},m=(0,eD.__assign)((0,eD.__assign)({},g(p)),g(d));try{for(y=(v=(0,eD.__values)(Object.entries(m))).next();!y.done;y=v.next())w=(b=(0,eD.__read)(y.value,2))[0],_=b[1],"mask"===_?f.maskSelector.push(w):"block"===_?f.blockSelector.push(w):"unmask"===_&&f.unmaskSelector.push(w)}catch(e){S={error:e}}finally{try{y&&!y.done&&(I=v.return)&&I.call(v)}finally{if(S)throw S.error}}i.privacyConfig=co(f,this.localConfig.loggerProvider)}return this.localConfig.loggerProvider.debug(JSON.stringify({name:"session replay joined config",config:cs(i)},null,2)),[2,{localConfig:this.localConfig,joinedConfig:i,remoteConfig:s}]}})})},e}(),cl="Failed to store session replay events in IndexedDB",cu="1.22.10",cc=function(){function e(e){var t=e.trackServerUrl,r=e.loggerProvider,n=e.payloadBatcher;this.storageKey="",this.retryTimeout=1e3,this.scheduled=null,this.queue=[],this.loggerProvider=r,this.payloadBatcher=n||function(e){return e},this.trackServerUrl=t}return e.prototype.sendEventsList=function(e){this.addToQueue((0,eD.__assign)((0,eD.__assign)({},e),{attempts:0,timeout:0}))},e.prototype.addToQueue=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.filter(function(t){return t.attempts<(t.flushMaxRetries||0)?(t.attempts+=1,!0):(e.completeRequest({context:t,err:"Session replay event batch rejected due to exceeded retry count"}),!1)}).forEach(function(t){(e.queue=e.queue.concat(t),0===t.timeout)?e.schedule(0):setTimeout(function(){t.timeout=0,e.schedule(0)},t.timeout)})},e.prototype.schedule=function(e){var t=this;this.scheduled||(this.scheduled=setTimeout(function(){t.flush(!0).then(function(){t.queue.length>0&&t.schedule(e)})},e))},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n=this;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return t=[],r=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):r.push(e)}),this.queue=r,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(t.map(function(t){return n.send(t,e)}))];case 1:return i.sent(),[2]}})})},e.prototype.send=function(e,t){var r,n;return void 0===t&&(t=!0),(0,eD.__awaiter)(this,void 0,void 0,function(){var i,s,o,a,l,u,c,h,d,p,f,g;return(0,eD.__generator)(this,function(m){switch(m.label){case 0:if(!(i=e.apiKey))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing api key"})];if(!(s=e.deviceId))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing device ID"})];if(o=cr(),a=cu,l=e.sampleRate,u=new URLSearchParams({device_id:s,session_id:"".concat(e.sessionId),type:"".concat(e.type)}),c="".concat((null==(r=e.version)?void 0:r.type)||"standalone","/").concat((null==(n=e.version)?void 0:n.version)||a),0===(h=this.payloadBatcher({version:1,events:e.events})).events.length)return this.completeRequest({context:e}),[2];m.label=1;case 1:return m.trys.push([1,3,,4]),d={headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(i),"X-Client-Version":a,"X-Client-Library":c,"X-Client-Url":o.substring(0,1e3),"X-Client-Sample-Rate":"".concat(l)},body:JSON.stringify(h),method:"POST"},[4,fetch("".concat(cn(e.serverZone,this.trackServerUrl),"?").concat(u.toString()),d)];case 2:if(null===(p=m.sent()))return this.completeRequest({context:e,err:"Unexpected error occurred"}),[2];if(t)this.handleReponse(p.status,e);else{f="";try{f=JSON.stringify(p.body,null,2)}catch(e){}this.completeRequest({context:e,success:"".concat(p.status,": ").concat(f)})}return[3,4];case 3:return g=m.sent(),this.completeRequest({context:e,err:g}),[3,4];case 4:return[2]}})})},e.prototype.handleReponse=function(e,t){switch(new tF().buildStatus(e)){case em.Success:this.handleSuccessResponse(t);break;case em.Failed:this.handleOtherResponse(t);break;default:this.completeRequest({context:t,err:"Network error occurred, event batch rejected"})}},e.prototype.handleSuccessResponse=function(e){var t=Math.round(new Blob(e.events).size/1024);this.completeRequest({context:e,success:"Session replay event batch tracked successfully for session id ".concat(e.sessionId,", size of events: ").concat(t," KB")})},e.prototype.handleOtherResponse=function(e){this.addToQueue((0,eD.__assign)((0,eD.__assign)({},e),{timeout:e.attempts*this.retryTimeout}))},e.prototype.completeRequest=function(e){var t=e.context,r=e.err,n=e.success;t.onComplete(),r?this.loggerProvider.warn(r):n&&this.loggerProvider.log(n)},e}();let ch=(e,t)=>t.some(t=>e instanceof t),cd=new WeakMap,cp=new WeakMap,cf=new WeakMap,cg={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return cd.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return cm(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function cm(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(cm(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",s)}),cf.set(t,e),t}if(cp.has(e))return cp.get(e);let t=function(e){if("function"==typeof e)return(C||(C=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(cv(this),t),cm(this.request)}:function(...t){return cm(e.apply(cv(this),t))};return(e instanceof IDBTransaction&&function(e){if(cd.has(e))return;let t=new Promise((t,r)=>{let n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});cd.set(e,t)}(e),ch(e,I||(I=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,cg):e}(e);return t!==e&&(cp.set(e,t),cf.set(t,e)),t}let cv=e=>cf.get(e),cy=["get","getKey","getAll","getAllKeys","count"],cb=["put","add","delete","clear"],cw=new Map;function c_(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(cw.get(t))return cw.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,i=cb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||cy.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),o=s.store;return n&&(o=o.index(t.shift())),(await Promise.all([o[r](...t),i&&s.done]))[0]};return cw.set(t,s),s}cg={...E=cg,get:(e,t,r)=>c_(e,t)||E.get(e,t,r),has:(e,t)=>!!c_(e,t)||E.has(e,t)};let cS=["continue","continuePrimaryKey","advance"],cI={},cC=new WeakMap,cE=new WeakMap,ck={get(e,t){if(!cS.includes(t))return e[t];let r=cI[t];return r||(r=cI[t]=function(...e){cC.set(this,cE.get(this)[t](...e))}),r}};async function*cx(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let r=new Proxy(t,ck);for(cE.set(r,t),cf.set(r,cv(t));t;)yield r,t=await (cC.get(r)||t.continue()),cC.delete(r)}function cO(e,t){return t===Symbol.asyncIterator&&ch(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&ch(e,[IDBIndex,IDBObjectStore])}cg={...k=cg,get:(e,t,r)=>cO(e,t)?cx:k.get(e,t,r),has:(e,t)=>cO(e,t)||k.has(e,t)};var cR=function(){function e(e){var t,r,n,i=this;this.minInterval=500,this.maxInterval=1e4,this.maxPersistedEventsSize=1e6,this.interval=this.minInterval,this._timeAtLastSplit=Date.now(),this.shouldSplitEventsList=function(e,t){var r=new Blob([t]).size;return new Blob(e).size+r>=i.maxPersistedEventsSize||Date.now()-i.timeAtLastSplit>i.interval&&!!e.length&&(i.interval=Math.min(i.maxInterval,i.interval+i.minInterval),i._timeAtLastSplit=Date.now(),!0)},this.loggerProvider=e.loggerProvider,this.minInterval=null!=(t=e.minInterval)?t:this.minInterval,this.maxInterval=null!=(r=e.maxInterval)?r:this.maxInterval,this.maxPersistedEventsSize=null!=(n=e.maxPersistedEventsSize)?n:this.maxPersistedEventsSize}return Object.defineProperty(e.prototype,"timeAtLastSplit",{get:function(){return this._timeAtLastSplit},enumerable:!1,configurable:!0}),e}();(er=eA||(eA={})).RECORDING="recording",er.SENT="sent";var cT="sessionCurrentSequence",cA="sequencesToSend",cM=function(){var e=eY();return new Promise(function(t,r){if(!e)return r(Error("Global scope not found"));if(!e.indexedDB)return r(Error("Session Replay: cannot find indexedDB"));try{var n=e.indexedDB.open("keyval-store");n.onupgradeneeded=function(){1===n.result.version&&(n.result.close(),n.transaction&&n.transaction.abort(),e.indexedDB.deleteDatabase("keyval-store"),t())},n.onsuccess=function(){t(n.result)}}catch(e){r(e)}})},cP=function(e){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){switch(t.label){case 0:if(!(e.length>0))return[3,2];return[4,Promise.all(e.splice(0,10))];case 1:return t.sent(),[3,0];case 2:return[2]}})})},cN=function(e){var t,r;return e.objectStoreNames.contains(cT)||(r=e.createObjectStore(cT,{keyPath:"sessionId"})),e.objectStoreNames.contains(cA)||(t=e.createObjectStore(cA,{keyPath:"sequenceId",autoIncrement:!0})).createIndex("sessionId","sessionId"),{sequencesStore:t,currentSequenceStore:r}},cD=function(e){function t(t){var r=e.call(this,t)||this;return r.getSequencesToSend=function(){return(0,eD.__awaiter)(r,void 0,void 0,function(){var e,t,r,n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),e=[],[4,this.db.transaction("sequencesToSend").store.openCursor()];case 1:t=o.sent(),o.label=2;case 2:if(!t)return[3,4];return n=(r=t.value).sessionId,i=r.events,e.push({events:i,sequenceId:t.key,sessionId:n}),[4,t.continue()];case 3:return t=o.sent(),[3,2];case 4:return[2,e];case 5:return s=o.sent(),this.loggerProvider.warn("".concat(cl,": ").concat(s)),[3,6];case 6:return[2,void 0]}})})},r.storeCurrentSequence=function(e){return(0,eD.__awaiter)(r,void 0,void 0,function(){var t,r,n;return(0,eD.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,this.db.get(cT,e)];case 1:if(!(t=i.sent()))return[2,void 0];return[4,this.db.put(cA,{sessionId:e,events:t.events})];case 2:return r=i.sent(),[4,this.db.put(cT,{sessionId:e,events:[]})];case 3:return i.sent(),[2,(0,eD.__assign)((0,eD.__assign)({},t),{sessionId:e,sequenceId:r})];case 4:return n=i.sent(),this.loggerProvider.warn("".concat(cl,": ").concat(n)),[3,5];case 5:return[2,void 0]}})})},r.addEventToCurrentSequence=function(e,t){return(0,eD.__awaiter)(r,void 0,void 0,function(){var r,n,i,s,o,a;return(0,eD.__generator)(this,function(l){switch(l.label){case 0:return l.trys.push([0,10,,11]),[4,(r=this.db.transaction(cT,"readwrite")).store.get(e)];case 1:if(n=l.sent())return[3,3];return[4,r.store.put({sessionId:e,events:[t]})];case 2:return l.sent(),[2];case 3:if(i=void 0,!this.shouldSplitEventsList(n.events,t))return[3,5];return i=n.events,[4,r.store.put({sessionId:e,events:[t]})];case 4:return l.sent(),[3,7];case 5:return s=n.events.concat(t),[4,r.store.put({sessionId:e,events:s})];case 6:l.sent(),l.label=7;case 7:return[4,r.done];case 8:if(l.sent(),!i)return[2,void 0];return[4,this.storeSendingEvents(e,i)];case 9:if(!(o=l.sent()))return[2,void 0];return[2,{events:i,sessionId:e,sequenceId:o}];case 10:return a=l.sent(),this.loggerProvider.warn("".concat(cl,": ").concat(a)),[3,11];case 11:return[2,void 0]}})})},r.storeSendingEvents=function(e,t){return(0,eD.__awaiter)(r,void 0,void 0,function(){var r;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.db.put(cA,{sessionId:e,events:t})];case 1:return[2,n.sent()];case 2:return r=n.sent(),this.loggerProvider.warn("".concat(cl,": ").concat(r)),[3,3];case 3:return[2,void 0]}})})},r.cleanUpSessionEventsStore=function(e,t){return(0,eD.__awaiter)(r,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:if(!t)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.db.delete(cA,t)];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),this.loggerProvider.warn("".concat(cl,": ").concat(e)),[3,4];case 4:return[2]}})})},r.transitionFromKeyValStore=function(e){return(0,eD.__awaiter)(r,void 0,void 0,function(){var t,r,n,i,s,o,a,l=this;return(0,eD.__generator)(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),[4,cM()];case 1:if(!(t=u.sent()))return[2];r=function(e,t){return(0,eD.__awaiter)(l,void 0,void 0,function(){var r,n,i=this;return(0,eD.__generator)(this,function(s){switch(s.label){case 0:return r=t.sessionSequences,n=[],Object.keys(r).forEach(function(s){var o=parseInt(s,10),a=r[o];if(o===t.currentSequenceId){var l=a.events.map(function(t){return(0,eD.__awaiter)(i,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return[2,this.addEventToCurrentSequence(e,t)]})})});n.concat(l)}else a.status!==eA.SENT&&n.push(i.storeSendingEvents(e,a.events))}),[4,cP(n)];case 1:return s.sent(),[2]}})})},n="".concat(eL,"_").concat(this.apiKey.substring(0,10)),u.label=2;case 2:return u.trys.push([2,4,,5]),i=t.transaction("keyval").objectStore("keyval").getAll(n),[4,new Promise(function(t){i.onsuccess=function(n){return(0,eD.__awaiter)(l,void 0,void 0,function(){var i,s,o,a=this;return(0,eD.__generator)(this,function(l){switch(l.label){case 0:if(!(s=(i=n&&n.target.result)&&i[0]))return[3,2];return o=[],Object.keys(s).forEach(function(t){var n=parseInt(t,10),i=s[n];if(e===n)o.push(r(n,i));else{var l=i.sessionSequences;Object.keys(l).forEach(function(e){var t=parseInt(e,10);l[t].status!==eA.SENT&&o.push(a.storeSendingEvents(n,l[t].events))})}}),[4,cP(o)];case 1:l.sent(),l.label=2;case 2:return t(),[2]}})})}})];case 3:return u.sent(),(s=eY())&&s.indexedDB.deleteDatabase("keyval-store"),[3,5];case 4:return o=u.sent(),this.loggerProvider.warn("Failed to transition session replay events from keyval to new store: ".concat(o)),[3,5];case 5:return[3,7];case 6:return a=u.sent(),this.loggerProvider.warn("Failed to access keyval store: ".concat(a,". For more information, visit: https://www.docs.developers.amplitude.com/session-replay/sdks/standalone/#indexeddb-best-practices")),[3,7];case 7:return[2]}})})},r.apiKey=t.apiKey,r.db=t.db,r}return(0,eD.__extends)(t,e),t.new=function(e,r,n){return(0,eD.__awaiter)(this,void 0,void 0,function(){var i,s,o,a;return(0,eD.__generator)(this,function(l){switch(l.label){case 0:var u;return l.trys.push([0,3,,4]),i="replay"===e?"":"_".concat(e),[4,(u="".concat(r.apiKey.substring(0,10),"_amp_session_replay_events").concat(i),(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){switch(e.label){case 0:return[4,function(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let o=indexedDB.open(e,1),a=cm(o);return n&&o.addEventListener("upgradeneeded",e=>{n(cm(o.result),e.oldVersion,e.newVersion,cm(o.transaction),e)}),r&&o.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}(u,0,{upgrade:cN})];case 1:return[2,e.sent()]}})}))];case 1:return s=l.sent(),[4,(o=new t((0,eD.__assign)((0,eD.__assign)({},r),{db:s}))).transitionFromKeyValStore(n)];case 2:return l.sent(),[2,o];case 3:return a=l.sent(),r.loggerProvider.warn("".concat(cl,": ").concat(a)),[3,4];case 4:return[2]}})})},t.prototype.getCurrentSequenceEvents=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t,r,n,i,s,o;return(0,eD.__generator)(this,function(a){switch(a.label){case 0:if(!e)return[3,2];return[4,this.db.get("sessionCurrentSequence",e)];case 1:if(!(t=a.sent()))return[2,void 0];return[2,[t]];case 2:r=[],a.label=3;case 3:return a.trys.push([3,8,9,10]),[4,this.db.getAll("sessionCurrentSequence")];case 4:i=(n=eD.__values.apply(void 0,[a.sent()])).next(),a.label=5;case 5:if(i.done)return[3,7];t=i.value,r.push(t),a.label=6;case 6:return i=n.next(),[3,5];case 7:return[3,10];case 8:return s={error:a.sent()},[3,10];case 9:try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(s)throw s.error}return[7];case 10:return[2,r]}})})},t}(cR),cL=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.finalizedSequences={},t.sequences={},t.sequenceId=0,t}return(0,eD.__extends)(t,e),t.prototype.resetCurrentSequence=function(e){this.sequences[e]=[]},t.prototype.addSequence=function(e){var t=this.sequenceId++,r=(0,eD.__spreadArray)([],(0,eD.__read)(this.sequences[e]),!1);return this.finalizedSequences[t]={sessionId:e,events:r},this.resetCurrentSequence(e),{sequenceId:t,events:r,sessionId:e}},t.prototype.getSequencesToSend=function(){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return[2,Object.entries(this.finalizedSequences).map(function(e){var t=(0,eD.__read)(e,2),r=t[0],n=t[1],i=n.sessionId,s=n.events;return{sequenceId:Number(r),sessionId:i,events:s}})]})})},t.prototype.storeCurrentSequence=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){return this.sequences[e]?[2,this.addSequence(e)]:[2,void 0]})})},t.prototype.addEventToCurrentSequence=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r;return(0,eD.__generator)(this,function(n){return this.sequences[e]||this.resetCurrentSequence(e),this.shouldSplitEventsList(this.sequences[e],t)&&(r=this.addSequence(e)),this.sequences[e].push(t),[2,r]})})},t.prototype.storeSendingEvents=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return this.finalizedSequences[this.sequenceId]={sessionId:e,events:t},[2,this.sequenceId++]})})},t.prototype.cleanUpSessionEventsStore=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){return void 0!==t&&delete this.finalizedSequences[t],[2]})})},t}(cR),cU=function(e){var t=e.config,r=e.sessionId,n=e.minInterval,i=e.maxInterval,s=e.type,o=e.payloadBatcher,a=e.storeType;return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e,l,u,c,h;function d(t){return void 0===t&&(t=!1),(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return[2,e.flush(t)]})})}return(0,eD.__generator)(this,function(p){switch(p.label){case 0:if(e=new cc((0,eD.__assign)((0,eD.__assign)({},t),{loggerProvider:t.loggerProvider,payloadBatcher:o})),l=function(){return new cL({loggerProvider:t.loggerProvider,maxInterval:i,minInterval:n})},"idb"!==a)return[3,2];return[4,(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:return[4,cD.new(s,{loggerProvider:t.loggerProvider,minInterval:n,maxInterval:i,apiKey:t.apiKey},r)];case 1:return e=o.sent(),t.loggerProvider.log("Failed to initialize idb store, falling back to memory store."),[2,null!=e?e:l()]}})})];case 1:return c=p.sent(),[3,3];case 2:c=l(),p.label=3;case 3:return u=c,h=function(r){var n=r.events,i=r.sessionId,o=r.deviceId,a=r.sequenceId;t.debugMode&&ci().then(function(e){var r=e.totalStorageSize,n=e.percentOfQuota,i=e.usageDetails;t.loggerProvider.debug("Total storage size: ".concat(r," KB, percentage of quota: ").concat(n,"%, usage details: ").concat(i))}).catch(function(){}),e.sendEventsList({events:n,sessionId:i,flushMaxRetries:t.flushMaxRetries,apiKey:t.apiKey,deviceId:o,sampleRate:t.sampleRate,serverZone:t.serverZone,version:t.version,type:s,onComplete:function(){return(0,eD.__awaiter)(void 0,void 0,void 0,function(){return(0,eD.__generator)(this,function(e){switch(e.label){case 0:return[4,u.cleanUpSessionEventsStore(i,a)];case 1:return e.sent(),[2]}})})}})},[2,{sendCurrentSequenceEvents:function(e){var r=e.sessionId,n=e.deviceId;u.storeCurrentSequence(r).then(function(e){e&&h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:n})}).catch(function(e){t.loggerProvider.warn("Failed to get current sequence of session replay events for session:",e)})},addEvent:function(e){var r=e.event,n=e.sessionId,i=e.deviceId;u.addEventToCurrentSequence(n,r.data).then(function(e){return e&&h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:i})}).catch(function(e){t.loggerProvider.warn("Failed to add event to session replay capture:",e)})},sendStoredEvents:function(e){var t=e.deviceId;return(0,eD.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return[4,u.getSequencesToSend()];case 1:return(e=r.sent())&&e.forEach(function(e){h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:t})}),[2]}})})},flush:d}]}})})},cF=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new Map;e.forEach(function(e){r.set(e.name,e.manager)}),this.managers=r}return e.prototype.sendStoredEvents=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return t=[],this.managers.forEach(function(r){t.push(r.sendStoredEvents(e))}),[4,Promise.all(t)];case 1:return r.sent(),[2]}})})},e.prototype.addEvent=function(e){var t,r=e.sessionId,n=e.event,i=e.deviceId;null==(t=this.managers.get(n.type))||t.addEvent({sessionId:r,event:n,deviceId:i})},e.prototype.sendCurrentSequenceEvents=function(e){var t=e.sessionId,r=e.deviceId;this.managers.forEach(function(e){e.sendCurrentSequenceEvents({sessionId:t,deviceId:r})})},e.prototype.flush=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(r){switch(r.label){case 0:return t=[],this.managers.forEach(function(r){t.push(r.flush(e))}),[4,Promise.all(t)];case 1:return r.sent(),[2]}})})},e}(),cj=((en=cj||{})[en.DomContentLoaded=0]="DomContentLoaded",en[en.Load=1]="Load",en[en.FullSnapshot=2]="FullSnapshot",en[en.IncrementalSnapshot=3]="IncrementalSnapshot",en[en.Meta=4]="Meta",en[en.Custom=5]="Custom",en[en.Plugin=6]="Plugin",en),cB=((ei=cB||{})[ei.Mutation=0]="Mutation",ei[ei.MouseMove=1]="MouseMove",ei[ei.MouseInteraction=2]="MouseInteraction",ei[ei.Scroll=3]="Scroll",ei[ei.ViewportResize=4]="ViewportResize",ei[ei.Input=5]="Input",ei[ei.TouchMove=6]="TouchMove",ei[ei.MediaInteraction=7]="MediaInteraction",ei[ei.StyleSheetRule=8]="StyleSheetRule",ei[ei.CanvasMutation=9]="CanvasMutation",ei[ei.Font=10]="Font",ei[ei.Log=11]="Log",ei[ei.Drag=12]="Drag",ei[ei.StyleDeclaration=13]="StyleDeclaration",ei[ei.Selection=14]="Selection",ei[ei.AdoptedStyleSheet=15]="AdoptedStyleSheet",ei[ei.CustomElement=16]="CustomElement",ei),cq=((es=cq||{})[es.MouseUp=0]="MouseUp",es[es.MouseDown=1]="MouseDown",es[es.Click=2]="Click",es[es.ContextMenu=3]="ContextMenu",es[es.DblClick=4]="DblClick",es[es.Focus=5]="Focus",es[es.Blur=6]="Blur",es[es.TouchStart=7]="TouchStart",es[es.TouchMove_Departed=8]="TouchMove_Departed",es[es.TouchEnd=9]="TouchEnd",es[es.TouchCancel=10]="TouchCancel",es),cz=((eo=cz||{})[eo.Mouse=0]="Mouse",eo[eo.Pen=1]="Pen",eo[eo.Touch=2]="Touch",eo),cV=((ea=cV||{})[ea["2D"]=0]="2D",ea[ea.WebGL=1]="WebGL",ea[ea.WebGL2=2]="WebGL2",ea),cW=((el=cW||{})[el.Play=0]="Play",el[el.Pause=1]="Pause",el[el.Seeked=2]="Seeked",el[el.VolumeChange=3]="VolumeChange",el[el.RateChange=4]="RateChange",el),cG=((eu=cG||{}).Start="start",eu.Pause="pause",eu.Resume="resume",eu.Resize="resize",eu.Finish="finish",eu.FullsnapshotRebuilded="fullsnapshot-rebuilded",eu.LoadStylesheetStart="load-stylesheet-start",eu.LoadStylesheetEnd="load-stylesheet-end",eu.SkipStart="skip-start",eu.SkipEnd="skip-end",eu.MouseInteraction="mouse-interaction",eu.EventCast="event-cast",eu.CustomEvent="custom-event",eu.Flush="flush",eu.StateChange="state-change",eu.PlayBack="play-back",eu.Destroy="destroy",eu),cK=((ec=cK||{})[ec.Document=0]="Document",ec[ec.DocumentType=1]="DocumentType",ec[ec.Element=2]="Element",ec[ec.Text=3]="Text",ec[ec.CDATA=4]="CDATA",ec[ec.Comment=5]="Comment",ec);function cY(e,t,r){for(var n=null,i=[],s=e,o=0;s&&"break"!==function(){var e,a,l,u,c=new Date().getTime()-eN.getTime();if(void 0!==eM.timeoutMs&&c>eM.timeoutMs)throw Error("Timeout: Can't find a unique selector after ".concat(c,"ms"));var h=c1((e=s.getAttribute("id"))&&eM.idName(e)?{name:"#"+CSS.escape(e),penalty:0}:null)||c1.apply(void 0,(0,eD.__spreadArray)([],(0,eD.__read)(Array.from(s.attributes).filter(function(e){return eM.attr(e.name,e.value)}).map(function(e){return{name:"[".concat(CSS.escape(e.name),'="').concat(CSS.escape(e.value),'"]'),penalty:.5}})),!1))||c1.apply(void 0,(0,eD.__spreadArray)([],(0,eD.__read)(Array.from(s.classList).filter(eM.className).map(function(e){return{name:"."+CSS.escape(e),penalty:1}})),!1))||c1((a=s.tagName.toLowerCase(),eM.tagName(a)?{name:a,penalty:2}:null))||[cX()],d=function(e){var t=e.parentNode;if(!t)return null;var r=t.firstChild;if(!r)return null;for(var n=0;r&&(r.nodeType===Node.ELEMENT_NODE&&n++,r!==e);)r=r.nextSibling;return n}(s);if("all"==t)d&&(h=h.concat(h.filter(c0).map(function(e){return cQ(e,d)})));else if("two"==t)h=h.slice(0,1),d&&(h=h.concat(h.filter(c0).map(function(e){return cQ(e,d)})));else if("one"==t){var p=(0,eD.__read)(h=h.slice(0,1),1)[0];d&&c0(p)&&(h=[cQ(p,d)])}else"none"==t&&(h=[cX()],d&&(h=[cQ(h[0],d)]));try{for(var f=(l=void 0,(0,eD.__values)(h)),g=f.next();!g.done;g=f.next()){var p=g.value;p.level=o}}catch(e){l={error:e}}finally{try{g&&!g.done&&(u=f.return)&&u.call(f)}finally{if(l)throw l.error}}if(i.push(h),i.length>=eM.seedMinLength&&(n=cZ(i,r)))return"break";s=s.parentElement,o++}(););return(n||(n=cZ(i,r)),!n&&r)?r():n}function cZ(e,t){var r,n,i=c3(function e(t,r){var n,i,s,o,a;return void 0===r&&(r=[]),(0,eD.__generator)(this,function(l){switch(l.label){case 0:if(!(t.length>0))return[3,9];l.label=1;case 1:l.trys.push([1,6,7,8]),i=(n=(0,eD.__values)(t[0])).next(),l.label=2;case 2:if(i.done)return[3,5];return s=i.value,[5,(0,eD.__values)(e(t.slice(1,t.length),r.concat(s)))];case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return o={error:l.sent()},[3,8];case 7:try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}return[7];case 8:return[3,11];case 9:return[4,r];case 10:l.sent(),l.label=11;case 11:return[2]}})}(e));if(i.length>eM.threshold)return t?t():null;try{for(var s=(0,eD.__values)(i),o=s.next();!o.done;o=s.next()){var a=o.value;if(cJ(a))return a}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return null}function c$(e){for(var t=e[0],r=t.name,n=1;n<e.length;n++){var i=e[n].level||0;r=t.level===i-1?"".concat(e[n].name," > ").concat(r):"".concat(e[n].name," ").concat(r),t=e[n]}return r}function cH(e){return e.map(function(e){return e.penalty}).reduce(function(e,t){return e+t},0)}function cJ(e){var t=c$(e);switch(eP.querySelectorAll(t).length){case 0:throw Error("Can't select any node with this selector: ".concat(t));case 1:return!0;default:return!1}}function cX(){return{name:"*",penalty:3}}function cQ(e,t){return{name:e.name+":nth-child(".concat(t,")"),penalty:e.penalty+1}}function c0(e){return"html"!==e.name&&!e.name.startsWith("#")}function c1(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.filter(c2);return r.length>0?r:null}function c2(e){return null!=e}function c3(e){return(0,eD.__spreadArray)([],(0,eD.__read)(e),!1).sort(function(e,t){return cH(e)-cH(t)})}var c4=function(e){var t=e.version,r=e.events,n=[];return r.forEach(function(e){var t=JSON.parse(e);t.count=1,"click"===t.type&&n.push(t)}),{version:t,events:n}},c5=function(e){var t=e.version,r=e.events,n=[];return r.forEach(function(e){var t=JSON.parse(e);"click"===t.type&&n.push(t)}),{version:t,events:Object.values(n.reduce(function(e,t){var r=t.x,n=t.y,i=t.selector,s=t.timestamp,o=s-s%36e5,a="".concat(r,":").concat(n,":").concat(null!=i?i:"",":").concat(o);return e[a]?e[a].count+=1:e[a]=(0,eD.__assign)((0,eD.__assign)({},t),{timestamp:o,count:1}),e},{}))}},c6=function(e,t){var r=t.eventsManager,n=t.sessionId,i=t.deviceIdFn;return function(t){if(t.type!==cq.Click)return;var s,o=eY();if(o){var a=o.location,l=o.innerHeight,u=o.innerWidth;if(a){var c=t.x,h=t.y;if(void 0!==c&&void 0!==h){var d=uX.mirror.getNode(t.id);if(d)try{s=function(e,t){if(eN=new Date,e.nodeType!==Node.ELEMENT_NODE)throw Error("Can't generate CSS selector for non-element node type.");if("html"===e.tagName.toLowerCase())return"html";var r,n,i={root:document.body,idName:function(e){return!0},className:function(e){return!0},tagName:function(e){return!0},attr:function(e,t){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4,timeoutMs:void 0};r=(eM=(0,eD.__assign)((0,eD.__assign)({},i),void 0)).root,n=i,eP=r.nodeType===Node.DOCUMENT_NODE?r:r===n.root?r.ownerDocument:r;var s=cY(e,"all",function(){return cY(e,"two",function(){return cY(e,"one",function(){return cY(e,"none")})})});if(s){var o=c3(function e(t,r,n){var i,s,o;return void 0===n&&(n={counter:0,visited:new Map}),(0,eD.__generator)(this,function(a){switch(a.label){case 0:if(!(t.length>2&&t.length>eM.optimizedMinLength))return[3,5];i=1,a.label=1;case 1:var l,u;if(!(i<t.length-1))return[3,5];if(n.counter>eM.maxNumberOfTries||(n.counter+=1,(s=(0,eD.__spreadArray)([],(0,eD.__read)(t),!1)).splice(i,1),o=c$(s),n.visited.has(o)))return[2];if(!(cJ(s)&&(l=s,u=r,eP.querySelector(c$(l))===u)))return[3,4];return[4,s];case 2:return a.sent(),n.visited.set(o,!0),[5,(0,eD.__values)(e(s,r,n))];case 3:a.sent(),a.label=4;case 4:return i++,[3,1];case 5:return[2]}})}(s,e));return o.length>0&&(s=o[0]),c$(s)}throw Error("Selector was not found.")}(d)}catch(t){e.debug("error resolving selector from finder")}var p=ur.getWindowScroll(o),f={x:c+p.left,y:h+p.top,selector:s,viewportHeight:l,viewportWidth:u,pageUrl:a.href,timestamp:Date.now(),type:"click"},g=i();g&&r.addEvent({sessionId:n,event:{type:"interaction",data:JSON.stringify(f)},deviceId:g})}}}}},c8=function(){function e(e,t){var r=eY();r&&r.navigator&&"function"==typeof r.navigator.sendBeacon?this.sendBeacon=function(e,t){try{if(r.navigator.sendBeacon(e,JSON.stringify(t)))return!0}catch(e){}return!1}:this.sendBeacon=function(){return!1},this.sendXhr=function(e,t){var r=new XMLHttpRequest;return r.open("POST",e,!0),r.setRequestHeader("Accept","*/*"),r.send(JSON.stringify(t)),!0},this.basePageUrl=cn(t.serverZone,t.trackServerUrl),this.apiKey=t.apiKey,this.context=e}return e.prototype.send=function(e,t){var r=this.context,n=r.sessionId,i=r.type,s=new URLSearchParams({device_id:e,session_id:String(n),type:String(i),api_key:this.apiKey}),o="".concat(this.basePageUrl,"?").concat(s.toString());this.sendBeacon(o,t)||this.sendXhr(o,t)},e}(),c9=ur.getWindowHeight,c7=ur.getWindowWidth,he=function(){function e(e){var t=this;this.timestamp=Date.now(),this.hook=function(e){t.update(e)},this.send=function(e){return function(r){var n=e(),i=eY();i&&n&&t.transport.send(n,{version:1,events:[{maxScrollX:t._maxScrollX,maxScrollY:t._maxScrollY,maxScrollWidth:t._maxScrollWidth,maxScrollHeight:t._maxScrollHeight,viewportHeight:c9(),viewportWidth:c7(),pageUrl:i.location.href,timestamp:t.timestamp,type:"scroll"}]})}},this._maxScrollX=0,this._maxScrollY=0,this._maxScrollWidth=c7(),this._maxScrollHeight=c9(),this.transport=e}return e.default=function(t,r){return new e(new c8(t,r))},Object.defineProperty(e.prototype,"maxScrollX",{get:function(){return this._maxScrollX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollY",{get:function(){return this._maxScrollY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollWidth",{get:function(){return this._maxScrollWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollHeight",{get:function(){return this._maxScrollHeight},enumerable:!1,configurable:!0}),e.prototype.update=function(e){var t=Date.now();if(e.x>this._maxScrollX){var r=c7();this._maxScrollX=e.x;var n=e.x+r;n>this._maxScrollWidth&&(this._maxScrollWidth=n),this.timestamp=t}if(e.y>this._maxScrollY){var i=c9();this._maxScrollY=e.y;var s=e.y+i;s>this._maxScrollHeight&&(this._maxScrollHeight=s),this.timestamp=t}},e}(),ht=function(e){var t=e.sessionId,r=e.deviceId;this.deviceId=r,this.sessionId=t,t&&r&&(this.sessionReplayId="".concat(r,"/").concat(t))},hr=Uint8Array,hn=Uint16Array,hi=Uint32Array,hs=new hr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ho=new hr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ha=new hr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hl=function(e,t){for(var r=new hn(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new hi(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},hu=hl(hs,2),hc=hu[0],hh=hu[1];hc[28]=258,hh[258]=28;for(var hd=hl(ho,0),hp=(hd[0],hd[1]),hf=new hn(32768),hg=0;hg<32768;++hg){var hm=(43690&hg)>>>1|(21845&hg)<<1;hm=(61680&(hm=(52428&hm)>>>2|(13107&hm)<<2))>>>4|(3855&hm)<<4,hf[hg]=((65280&hm)>>>8|(255&hm)<<8)>>>1}for(var hv=function(e,t,r){for(var n,i=e.length,s=0,o=new hn(t);s<i;++s)++o[e[s]-1];var a=new hn(t);for(s=0;s<t;++s)a[s]=a[s-1]+o[s-1]<<1;if(r){n=new hn(1<<t);var l=15-t;for(s=0;s<i;++s)if(e[s])for(var u=s<<4|e[s],c=t-e[s],h=a[e[s]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)n[hf[h]>>>l]=u}else for(s=0,n=new hn(i);s<i;++s)n[s]=hf[a[e[s]-1]++]>>>15-e[s];return n},hy=new hr(288),hg=0;hg<144;++hg)hy[hg]=8;for(var hg=144;hg<256;++hg)hy[hg]=9;for(var hg=256;hg<280;++hg)hy[hg]=7;for(var hg=280;hg<288;++hg)hy[hg]=8;for(var hb=new hr(32),hg=0;hg<32;++hg)hb[hg]=5;var hw=hv(hy,9,0),h_=hv(hb,5,0),hS=function(e){return(e/8|0)+(7&e&&1)},hI=function(e,t,r){(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof hn?hn:e instanceof hi?hi:hr)(r-t);return n.set(e.subarray(t,r)),n},hC=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},hE=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},hk=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return[new hr(0),0];if(1==i){var o=new hr(r[0].s+1);return o[r[0].s]=1,[o,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var a=r[0],l=r[1],u=0,c=1,h=2;for(r[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=i-1;)a=r[r[u].f<r[h].f?u++:h++],l=r[u!=c&&r[u].f<r[h].f?u++:h++],r[c++]={s:-1,f:a.f+l.f,l:a,r:l};for(var d=s[0].s,n=1;n<i;++n)s[n].s>d&&(d=s[n].s);var p=new hn(d+1),f=hx(r[c-1],p,0);if(f>t){var n=0,g=0,m=f-t,v=1<<m;for(s.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});n<i;++n){var y=s[n].s;if(p[y]>t)g+=v-(1<<f-p[y]),p[y]=t;else break}for(g>>>=m;g>0;){var b=s[n].s;p[b]<t?g-=1<<t-p[b]++-1:++n}for(;n>=0&&g;--n){var w=s[n].s;p[w]==t&&(--p[w],++g)}f=t}return[new hr(p),f]},hx=function(e,t,r){return -1==e.s?Math.max(hx(e.l,t,r+1),hx(e.r,t,r+1)):t[e.s]=r},hO=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new hn(++t),n=0,i=e[0],s=1,o=function(e){r[n++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[a]}return[r.subarray(0,n),t]},hR=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},hT=function(e,t,r){var n=r.length,i=hS(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},hA=function(e,t,r,n,i,s,o,a,l,u,c){hC(t,c++,r),++i[256];for(var h,d,p,f,g=hk(i,15),m=g[0],v=g[1],y=hk(s,15),b=y[0],w=y[1],_=hO(m),S=_[0],I=_[1],C=hO(b),E=C[0],k=C[1],x=new hn(19),O=0;O<S.length;++O)x[31&S[O]]++;for(var O=0;O<E.length;++O)x[31&E[O]]++;for(var R=hk(x,7),T=R[0],A=R[1],M=19;M>4&&!T[ha[M-1]];--M);var P=u+5<<3,N=hR(i,hy)+hR(s,hb)+o,D=hR(i,m)+hR(s,b)+o+14+3*M+hR(x,T)+(2*x[16]+3*x[17]+7*x[18]);if(P<=N&&P<=D)return hT(t,c,e.subarray(l,l+u));if(hC(t,c,1+(D<N)),c+=2,D<N){h=hv(m,v,0),d=m,p=hv(b,w,0),f=b;var L=hv(T,A,0);hC(t,c,I-257),hC(t,c+5,k-1),hC(t,c+10,M-4),c+=14;for(var O=0;O<M;++O)hC(t,c+3*O,T[ha[O]]);c+=3*M;for(var U=[S,E],F=0;F<2;++F)for(var j=U[F],O=0;O<j.length;++O){var B=31&j[O];hC(t,c,L[B]),c+=T[B],B>15&&(hC(t,c,j[O]>>>5&127),c+=j[O]>>>12)}}else h=hw,d=hy,p=h_,f=hb;for(var O=0;O<a;++O)if(n[O]>255){var B=n[O]>>>18&31;hE(t,c,h[B+257]),c+=d[B+257],B>7&&(hC(t,c,n[O]>>>23&31),c+=hs[B]);var q=31&n[O];hE(t,c,p[q]),c+=f[q],q>3&&(hE(t,c,n[O]>>>5&8191),c+=ho[q])}else hE(t,c,h[n[O]]),c+=d[n[O]];return hE(t,c,h[256]),c+d[256]},hM=new hi([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hP=function(e,t,r,n,i,s){var o=e.length,a=new hr(n+o+5*(1+Math.floor(o/7e3))+i),l=a.subarray(n,a.length-i),u=0;if(!t||o<8)for(var c=0;c<=o;c+=65535){var h=c+65535;h<o?u=hT(l,u,e.subarray(c,h)):(l[c]=s,u=hT(l,u,e.subarray(c,o)))}else{for(var d=hM[t-1],p=d>>>13,f=8191&d,g=(1<<r)-1,m=new hn(32768),v=new hn(g+1),y=Math.ceil(r/3),b=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&g},_=new hi(25e3),S=new hn(288),I=new hn(32),C=0,E=0,c=0,k=0,x=0,O=0;c<o;++c){var R=w(c),T=32767&c,A=v[R];if(m[T]=A,v[R]=T,x<=c){var M=o-c;if((C>7e3||k>24576)&&M>423){u=hA(e,l,0,_,S,I,E,k,O,c-O,u),k=C=E=0,O=c;for(var P=0;P<286;++P)S[P]=0;for(var P=0;P<30;++P)I[P]=0}var N=2,D=0,L=f,U=T-A&32767;if(M>2&&R==w(c-U))for(var F=Math.min(p,M)-1,j=Math.min(32767,c),B=Math.min(258,M);U<=j&&--L&&T!=A;){if(e[c+N]==e[c+N-U]){for(var q=0;q<B&&e[c+q]==e[c+q-U];++q);if(q>N){if(N=q,D=U,q>F)break;for(var z=Math.min(U,q-2),V=0,P=0;P<z;++P){var W=c-U+P+32768&32767,G=m[W],K=W-G+32768&32767;K>V&&(V=K,A=W)}}}A=m[T=A],U+=T-A+32768&32767}if(D){_[k++]=0x10000000|hh[N]<<18|hp[D];var Y=31&hh[N],Z=31&hp[D];E+=hs[Y]+ho[Z],++S[257+Y],++I[Z],x=c+N,++C}else _[k++]=e[c],++S[e[c]]}}u=hA(e,l,s,_,S,I,E,k,O,c-O,u)}return hI(a,0,n+hS(u)+i)},hN=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length,o=0;o!=s;){for(var a=Math.min(o+5552,s);o<a;++o)n+=r[o],i+=n;n%=65521,i%=65521}e=n,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+((255&e)<<23)*2}}},hD=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},hL=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},hU=function(){function e(e,t,r,n){var i,s,o=this;this.taskQueue=[],this.isProcessing=!1,this.compressEvent=function(e){var t,r,n,i,s;return JSON.stringify(function(e,t){var r="";if(!t&&"undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);for(var n=0;n<e.length;){var i=e[n++];i<128||t?r+=String.fromCharCode(i):i<224?r+=String.fromCharCode((31&i)<<6|63&e[n++]):i<240?r+=String.fromCharCode((15&i)<<12|(63&e[n++])<<6|63&e[n++]):r+=String.fromCharCode(55296|(i=((15&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536)>>10,56320|1023&i)}return r}((t=function(e,t){var r=e.length;if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e);for(var n=new hr(e.length+(e.length>>>1)),i=0,s=function(e){n[i++]=e},o=0;o<r;++o){if(i+5>n.length){var a=new hr(i+8+(r-o<<1));a.set(n),n=a}var l=e.charCodeAt(o);l<128?s(l):(l<2048?s(192|l>>>6):(l>55295&&l<57344?(s(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++o))>>>18),s(128|l>>>12&63)):s(224|l>>>12),s(128|l>>>6&63)),s(128|63&l))}return hI(n,0,i)}(JSON.stringify({...e,v:"v1"})),void 0===r&&(r={}),(n=hN()).p(t),hL(s=hP(t,null==(i=r).level?6:i.level,null==i.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+i.mem,2,4,!0),r),hD(s,s.length-4,n.d()),s),!0))},this.addCompressedEventToManager=function(e,t){o.eventsManager&&o.deviceId&&o.eventsManager.addEvent({event:{type:"replay",data:e},sessionId:t,deviceId:o.deviceId})},this.addCompressedEvent=function(e,t){if(o.worker)o.worker.postMessage({event:e,sessionId:t});else{var r=o.compressEvent(e);o.addCompressedEventToManager(r,t)}},this.terminate=function(){var e;null==(e=o.worker)||e.terminate()};var a=eY();this.canUseIdleCallback=a&&"requestIdleCallback"in a,this.eventsManager=e,this.config=t,this.deviceId=r,this.timeout=(null==(i=t.performanceConfig)?void 0:i.timeout)||2e3;var l=n;if((null==(s=this.config.experimental)?void 0:s.useWebWorker)&&a&&a.Worker&&l){t.loggerProvider.log("[Experimental] Enabling web worker for compression");var u=new Worker(URL.createObjectURL(new Blob([l],{type:"application/javascript"})));u.onerror=function(e){t.loggerProvider.error(e)},u.onmessage=function(e){var t=e.data,r=t.compressedEvent,n=t.sessionId;o.addCompressedEventToManager(r,n)},this.worker=u}}return e.prototype.scheduleIdleProcessing=function(){var e=this;this.isProcessing||(this.isProcessing=!0,requestIdleCallback(function(t){e.processQueue(t)},{timeout:this.timeout}))},e.prototype.enqueueEvent=function(e,t){var r;this.canUseIdleCallback&&(null==(r=this.config.performanceConfig)?void 0:r.enabled)?(this.config.loggerProvider.debug("Enqueuing event for processing during idle time."),this.taskQueue.push({event:e,sessionId:t}),this.scheduleIdleProcessing()):(this.config.loggerProvider.debug("Processing event without idle callback."),this.addCompressedEvent(e,t))},e.prototype.processQueue=function(e){for(var t=this;this.taskQueue.length>0&&(e.timeRemaining()>0||e.didTimeout);){var r=this.taskQueue.shift();if(r){var n=r.event,i=r.sessionId;this.addCompressedEvent(n,i)}}this.taskQueue.length>0?requestIdleCallback(function(e){t.processQueue(e)},{timeout:this.timeout}):this.isProcessing=!1},e}(),hF=function(){function e(){this.fetchObserver=null}return e.prototype.start=function(e){this.eventCallback=e,this.observeFetch()},e.prototype.stop=function(){var e;null==(e=this.fetchObserver)||e.call(this),this.fetchObserver=null,this.eventCallback=void 0},e.prototype.notifyEvent=function(e){var t;null==(t=this.eventCallback)||t.call(this,e)},e.prototype.observeFetch=function(){var e=this,t=eY();if(t){var r=t.fetch;r&&(t.fetch=function(t,n){return(0,eD.__awaiter)(e,void 0,void 0,function(){var e,i,s,o,a,l,u;return(0,eD.__generator)(this,function(c){switch(c.label){case 0:i={timestamp:e=Date.now(),type:"fetch",method:(null==n?void 0:n.method)||"GET",url:t.toString(),requestHeaders:null==n?void 0:n.headers},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r(t,n)];case 2:return s=c.sent(),o=Date.now(),i.status=s.status,i.duration=o-e,a={},s.headers.forEach(function(e,t){a[t]=e}),i.responseHeaders=a,this.notifyEvent(i),[2,s];case 3:throw l=c.sent(),o=Date.now(),i.duration=o-e,u=l,i.error={name:u.name||"UnknownError",message:u.message||"An unknown error occurred"},this.notifyEvent(i),l;case 4:return[2]}})})},this.fetchObserver=function(){t.fetch=r})}},e}(),hj=function(){function t(){var e=this;this.name="@amplitude/session-replay-browser",this.recordCancelCallback=null,this.eventCount=0,this.pageLeaveFns=[],this.teardownEventListeners=function(t){var r=eY();r&&(r.removeEventListener("blur",e.blurListener),r.removeEventListener("focus",e.focusListener),t||r.addEventListener("blur",e.blurListener),t||r.addEventListener("focus",e.focusListener),r.self&&"onpagehide"in r.self?(r.removeEventListener("pagehide",e.pageLeaveListener),t||r.addEventListener("pagehide",e.pageLeaveListener)):(r.removeEventListener("beforeunload",e.pageLeaveListener),t||r.addEventListener("beforeunload",e.pageLeaveListener)))},this.blurListener=function(){e.sendEvents()},this.focusListener=function(){e.recordEvents(!1)},this.pageLeaveListener=function(t){e.pageLeaveFns.forEach(function(e){e(t)})},this.addCustomRRWebEvent=function(t,r,n){return void 0===r&&(r={}),void 0===n&&(n=!0),(0,eD.__awaiter)(e,void 0,void 0,function(){var e,i,s,o;return(0,eD.__generator)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,3,,4]),e=void 0,!((i=this.config)&&t!==ek.METADATA)||(e={config:cs(i),version:cu},!n))return[3,2];return[4,ci()];case 1:s=a.sent(),e=(0,eD.__assign)((0,eD.__assign)({},s),e),a.label=2;case 2:return this.recordCancelCallback?uX.addCustomEvent(t,(0,eD.__assign)((0,eD.__assign)({},r),e)):this.loggerProvider.debug("Not able to add custom replay capture event ".concat(t," due to no ongoing recording.")),[3,4];case 3:return o=a.sent(),this.loggerProvider.debug("Error while adding custom replay capture event: ",o),[3,4];case 4:return[2]}})})},this.stopRecordingEvents=function(){var t;try{e.loggerProvider.log("Session Replay capture stopping."),e.recordCancelCallback&&e.recordCancelCallback(),e.recordCancelCallback=null,null==(t=e.networkObservers)||t.stop()}catch(t){e.loggerProvider.warn("Error occurred while stopping replay capture: ".concat(t.toString()))}},this.loggerProvider=new i2(new e4)}return t.prototype.init=function(e,t){return e0(this._init(e,t))},t.prototype._init=function(e,t){var r,n,i,s,o,a,l,u;return(0,eD.__awaiter)(this,void 0,void 0,function(){var c,h,d,p,f,g,m,v,y,b,w,_;return(0,eD.__generator)(this,function(S){switch(S.label){case 0:return this.loggerProvider=new i2(t.loggerProvider||new e4),Object.prototype.hasOwnProperty.call(t,"logLevel")&&this.loggerProvider.enable(t.logLevel),this.identifiers=new ht({sessionId:t.sessionId,deviceId:t.deviceId}),c=this,[4,(0,eD.__awaiter)(void 0,void 0,void 0,function(){var r;return(0,eD.__generator)(this,function(n){switch(n.label){case 0:return[4,u6({localConfig:r=new i4(e,t),configKeys:["sessionReplay"]})];case 1:return[2,new ca(n.sent(),r)]}})})];case 1:return c.joinedConfigGenerator=S.sent(),[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 2:d=(h=S.sent()).joinedConfig,p=h.localConfig,f=h.remoteConfig,this.config=d,this.setMetadata(t.sessionId,d,p,f,null==(r=t.version)?void 0:r.version,cu,null==(n=t.version)?void 0:n.type),t.sessionId&&(null==(i=this.config.interactionConfig)?void 0:i.enabled)&&(g=he.default({sessionId:t.sessionId,type:"interaction"},this.config),this.pageLeaveFns=[g.send(this.getDeviceId.bind(this)).bind(g)],this.scrollHook=g.hook.bind(g)),m=[],"idb"!==(v=this.config.storeType)||(null==(s=eY())?void 0:s.indexedDB)||(v="memory",this.loggerProvider.warn("Could not use preferred indexedDB storage, reverting to in memory option.")),this.loggerProvider.log("Using ".concat(v," for event storage.")),S.label=3;case 3:return S.trys.push([3,5,,6]),[4,cU({config:this.config,sessionId:this.identifiers.sessionId,type:"replay",storeType:v})];case 4:return y=S.sent(),m.push({name:"replay",manager:y}),[3,6];case 5:return b=S.sent(),this.loggerProvider.warn("Error occurred while creating replay events manager: ".concat(b.toString())),[3,6];case 6:if(!(null==(o=this.config.interactionConfig)?void 0:o.enabled))return[3,10];w=this.config.interactionConfig.batch?c5:c4,S.label=7;case 7:return S.trys.push([7,9,,10]),[4,cU({config:this.config,sessionId:this.identifiers.sessionId,type:"interaction",minInterval:null!=(a=this.config.interactionConfig.trackEveryNms)?a:3e4,maxInterval:6e4,payloadBatcher:w,storeType:v})];case 8:return _=S.sent(),m.push({name:"interaction",manager:_}),[3,10];case 9:return b=S.sent(),this.loggerProvider.warn("Error occurred while creating interaction events manager: ".concat(b.toString())),[3,10];case 10:return this.eventsManager=new(cF.bind.apply(cF,(0,eD.__spreadArray)([void 0],(0,eD.__read)(m),!1))),this.eventCompressor&&this.eventCompressor.terminate(),this.eventCompressor=new hU(this.eventsManager,this.config,this.getDeviceId()),(null==(u=null==(l=this.config.loggingConfig)?void 0:l.network)?void 0:u.enabled)&&(this.networkObservers=new hF),this.loggerProvider.log("Installing @amplitude/session-replay-browser."),this.teardownEventListeners(!1),this.initialize(!0),[2]}})})},t.prototype.setSessionId=function(e,t){return e0(this.asyncSetSessionId(e,t))},t.prototype.asyncSetSessionId=function(e,t){return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n,i;return(0,eD.__generator)(this,function(s){switch(s.label){case 0:if((r=this.identifiers&&this.identifiers.sessionId)&&this.sendEvents(r),n=t||this.getDeviceId(),this.identifiers=new ht({sessionId:e,deviceId:n}),!(this.joinedConfigGenerator&&r))return[3,2];return[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 1:i=s.sent().joinedConfig,this.config=i,s.label=2;case 2:return this.recordEvents(),[2]}})})},t.prototype.getSessionReplayProperties=function(){var e,t=this.config,r=this.identifiers;if(!t||!r)return this.loggerProvider.warn("Session replay init has not been called, cannot get session replay properties."),{};var n=this.getShouldRecord(),i={};return n&&((e={})[iX]=r.sessionReplayId?r.sessionReplayId:null,i=e,t.debugMode&&(i[i0]=JSON.stringify({appHash:ct(t.apiKey).toString()}))),this.addCustomRRWebEvent(ek.GET_SR_PROPS,{shouldRecord:n,eventProperties:i},10===this.eventCount),10===this.eventCount&&(this.eventCount=0),this.eventCount++,i},t.prototype.sendEvents=function(e){var t,r=e||(null==(t=this.identifiers)?void 0:t.sessionId),n=this.getDeviceId();this.eventsManager&&r&&n&&this.eventsManager.sendCurrentSequenceEvents({sessionId:r,deviceId:n})},t.prototype.initialize=function(e){var t;return void 0===e&&(e=!1),(0,eD.__awaiter)(this,void 0,void 0,function(){var r;return(0,eD.__generator)(this,function(n){return(null==(t=this.identifiers)?void 0:t.sessionId)?(r=this.getDeviceId())?(this.eventsManager&&e&&this.eventsManager.sendStoredEvents({deviceId:r}),[2,this.recordEvents()]):(this.loggerProvider.log("Session is not being recorded due to lack of device id."),[2,Promise.resolve()]):(this.loggerProvider.log("Session is not being recorded due to lack of session id."),[2,Promise.resolve()])})})},t.prototype.shouldOptOut=function(){if(null==(e=this.config)?void 0:e.instanceName){var e,t,r;r=td(this.config.instanceName).identityStore.getIdentity().optOut}return void 0!==r?r:null==(t=this.config)?void 0:t.optOut},t.prototype.getShouldRecord=function(){if(!this.identifiers||!this.config||!this.identifiers.sessionId)return this.loggerProvider.warn("Session is not being recorded due to lack of config, please call sessionReplay.init."),!1;if(!this.config.captureEnabled)return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," not being captured due to capture being disabled for project or because the remote config could not be fetched.")),!1;if(this.shouldOptOut())return this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to optOut config.")),!1;var e,t,r=(e=this.identifiers.sessionId,t=this.config.sampleRate,31*Math.abs(ct(e.toString()))%1e6/1e6<t);return r||this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to sample rate.")),r},t.prototype.getBlockSelectors=function(){var e,t,r,n=null!=(r=null==(t=null==(e=this.config)?void 0:e.privacyConfig)?void 0:t.blockSelector)?r:[];if(0!==n.length)return n},t.prototype.getMaskTextSelectors=function(){if((null==(t=null==(e=this.config)?void 0:e.privacyConfig)?void 0:t.defaultMaskLevel)==="conservative")return"*";var e,t,r,n,i=null==(n=null==(r=this.config)?void 0:r.privacyConfig)?void 0:n.maskSelector;if(i)return i},t.prototype.getRecordingPlugins=function(t){var r;return(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i,s;return(0,eD.__generator)(this,function(o){switch(o.label){case 0:if(n=[],!(null==(r=null==t?void 0:t.console)?void 0:r.enabled))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.A(859285)];case 2:return i=o.sent().getRecordConsolePlugin,n.push(i({level:t.console.levels})),[3,4];case 3:return s=o.sent(),this.loggerProvider.warn("Failed to load console plugin:",s),[3,4];case 4:return[2,n.length>0?n:void 0]}})})},t.prototype.recordEvents=function(e){var t,r;return void 0===e&&(e=!0),(0,eD.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,a,l,u,c,h,d,p,f=this;return(0,eD.__generator)(this,function(g){switch(g.label){case 0:if(n=this.config,i=this.getShouldRecord(),s=null==(t=this.identifiers)?void 0:t.sessionId,!i||!s||!n)return[2];this.stopRecordingEvents(),null==(r=this.networkObservers)||r.start(function(e){f.addCustomRRWebEvent(ek.FETCH_REQUEST,e)}),o=n.privacyConfig,a=n.interactionConfig,l=n.loggingConfig,u=(null==a?void 0:a.enabled)?{mouseInteraction:this.eventsManager&&c6(this.loggerProvider,{eventsManager:this.eventsManager,sessionId:s,deviceIdFn:this.getDeviceId.bind(this)}),scroll:this.scrollHook}:{},this.loggerProvider.log("Session Replay capture beginning for ".concat(s,".")),g.label=1;case 1:return g.trys.push([1,3,,4]),c=this,h=uX,p={emit:function(e){if(f.shouldOptOut()){f.loggerProvider.log("Opting session ".concat(s," out of recording due to optOut config.")),f.stopRecordingEvents(),f.sendEvents();return}f.eventCompressor&&f.eventCompressor.enqueueEvent(e,s)},inlineStylesheet:n.shouldInlineStylesheet,hooks:u,maskAllInputs:!0,maskTextClass:i1,blockClass:"amp-block",blockSelector:this.getBlockSelectors(),maskInputFn:ce("input",o),maskTextFn:ce("text",o),maskTextSelector:this.getMaskTextSelectors(),recordCanvas:!1,errorHandler:function(e){if(e.message.includes("insertRule")&&e.message.includes("CSSStyleSheet")||e._external_)throw e;return f.loggerProvider.warn("Error while capturing replay: ",e.toString()),!0}},[4,this.getRecordingPlugins(l)];case 2:return c.recordCancelCallback=h.apply(void 0,[(p.plugins=g.sent(),p)]),this.addCustomRRWebEvent(ek.DEBUG_INFO),e&&this.addCustomRRWebEvent(ek.METADATA,this.metadata),[3,4];case 3:return d=g.sent(),this.loggerProvider.warn("Failed to initialize session replay:",d),[3,4];case 4:return[2]}})})},t.prototype.getDeviceId=function(){var e;return null==(e=this.identifiers)?void 0:e.deviceId},t.prototype.getSessionId=function(){var e;return null==(e=this.identifiers)?void 0:e.sessionId},t.prototype.flush=function(e){var t;return void 0===e&&(e=!1),(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(r){return[2,null==(t=this.eventsManager)?void 0:t.flush(e)]})})},t.prototype.shutdown=function(){this.teardownEventListeners(!0),this.stopRecordingEvents(),this.sendEvents()},t.prototype.mapSDKType=function(e){return"plugin"===e?"@amplitude/plugin-session-replay-browser":"segment"===e?"@amplitude/segment-session-replay-plugin":null},t.prototype.setMetadata=function(e,t,r,n,i,s,o){var a=(null==e?void 0:e.toString())?ct(e.toString()):void 0;this.metadata={joinedConfig:t,localConfig:r,remoteConfig:n,sessionId:e,hashValue:a,sampleRate:t.sampleRate,replaySDKType:this.mapSDKType(o),replaySDKVersion:i,standaloneSDKType:"@amplitude/session-replay-browser",standaloneSDKVersion:s}},t}(),hB=function(e){return function(){var t=e.config||i3();return{logger:t.loggerProvider,logLevel:t.logLevel}}};let hq={init:eG((eh=new hj).init.bind(eh),"init",hB(eh)),setSessionId:eG(eh.setSessionId.bind(eh),"setSessionId",hB(eh)),getSessionId:eG(eh.getSessionId.bind(eh),"getSessionId",hB(eh)),getSessionReplayProperties:eG(eh.getSessionReplayProperties.bind(eh),"getSessionReplayProperties",hB(eh)),flush:eG(eh.flush.bind(eh),"flush",hB(eh)),shutdown:eG(eh.shutdown.bind(eh),"shutdown",hB(eh))};var hz=hq.init,hV=hq.setSessionId,hW=hq.getSessionId,hG=hq.getSessionReplayProperties,hK=hq.flush,hY=hq.shutdown,hZ="1.16.13",h$=function(){function e(t){this.name=e.pluginName,this.type="enrichment",this.sr={flush:hK,getSessionId:hW,getSessionReplayProperties:hG,init:hz,setSessionId:hV,shutdown:hY},this.options=(0,eD.__assign)({forceSessionTracking:!1},t),this.srInitOptions=this.options}return e.prototype.setup=function(e,t){var r,n,i,s,o;return(0,eD.__awaiter)(this,void 0,void 0,function(){var t;return(0,eD.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),null==e||e.loggerProvider.log("Installing @amplitude/plugin-session-replay, version ".concat(hZ,".")),this.config=e,this.options.forceSessionTracking&&("boolean"==typeof e.defaultTracking?!1===e.defaultTracking&&(e.defaultTracking={pageViews:!1,formInteractions:!1,fileDownloads:!1,sessions:!0}):e.defaultTracking=(0,eD.__assign)((0,eD.__assign)({},e.defaultTracking),{sessions:!0})),this.srInitOptions={instanceName:this.config.instanceName,deviceId:null!=(r=this.options.deviceId)?r:this.config.deviceId,optOut:this.config.optOut,sessionId:this.options.customSessionId?void 0:this.config.sessionId,loggerProvider:this.config.loggerProvider,logLevel:this.config.logLevel,flushMaxRetries:this.config.flushMaxRetries,serverZone:this.config.serverZone,configServerUrl:this.options.configServerUrl,trackServerUrl:this.options.trackServerUrl,sampleRate:this.options.sampleRate,privacyConfig:{blockSelector:null==(n=this.options.privacyConfig)?void 0:n.blockSelector,maskSelector:null==(i=this.options.privacyConfig)?void 0:i.maskSelector,unmaskSelector:null==(s=this.options.privacyConfig)?void 0:s.unmaskSelector,defaultMaskLevel:null==(o=this.options.privacyConfig)?void 0:o.defaultMaskLevel},debugMode:this.options.debugMode,shouldInlineStylesheet:this.options.shouldInlineStylesheet,version:{type:"plugin",version:hZ},performanceConfig:this.options.performanceConfig,storeType:this.options.storeType,experimental:this.options.experimental},[4,this.sr.init(e.apiKey,this.srInitOptions).promise];case 1:return a.sent(),[3,3];case 2:return t=a.sent(),null==e||e.loggerProvider.error("Session Replay: Failed to initialize due to ".concat(t.message)),[3,3];case 3:return[2]}})})},e.prototype.onSessionIdChanged=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){switch(t.label){case 0:return this.config.loggerProvider.debug("Analytics session id is changed to ".concat(e,", SR session id is ").concat(String(this.sr.getSessionId()),".")),[4,this.sr.setSessionId(e).promise];case 1:return t.sent(),[2]}})})},e.prototype.onOptOutChanged=function(e){return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){switch(t.label){case 0:if(this.config.loggerProvider.debug("optOut is changed to ".concat(String(e),", calling ").concat(e?"sessionReplay.shutdown()":"sessionReplay.init()",".")),!e)return[3,1];return this.sr.shutdown(),[3,3];case 1:return[4,this.sr.init(this.config.apiKey,this.srInitOptions).promise];case 2:t.sent(),t.label=3;case 3:return[2]}})})},e.prototype.execute=function(e){var t;return(0,eD.__awaiter)(this,void 0,void 0,function(){var r,n,i;return(0,eD.__generator)(this,function(s){switch(s.label){case 0:if(s.trys.push([0,8,,9]),!this.options.customSessionId)return[3,4];if(!(r=this.options.customSessionId(e)))return[3,3];if(r===this.sr.getSessionId())return[3,2];return[4,this.sr.setSessionId(r).promise];case 1:s.sent(),s.label=2;case 2:n=this.sr.getSessionReplayProperties(),e.event_properties=(0,eD.__assign)((0,eD.__assign)({},e.event_properties),n),s.label=3;case 3:return[3,7];case 4:if(!((r=this.config.sessionId)&&r!==this.sr.getSessionId()))return[3,6];return[4,this.sr.setSessionId(r).promise];case 5:s.sent(),s.label=6;case 6:r&&r===e.session_id&&(n=this.sr.getSessionReplayProperties(),e.event_properties=(0,eD.__assign)((0,eD.__assign)({},e.event_properties),n)),s.label=7;case 7:return[2,Promise.resolve(e)];case 8:return i=s.sent(),null==(t=this.config)||t.loggerProvider.error("Session Replay: Failed to enrich event due to ".concat(i.message)),[2,Promise.resolve(e)];case 9:return[2]}})})},e.prototype.teardown=function(){var e;return(0,eD.__awaiter)(this,void 0,void 0,function(){return(0,eD.__generator)(this,function(t){try{this.sr.shutdown(),this.config=null}catch(t){null==(e=this.config)||e.loggerProvider.error("Session Replay: teardown failed due to ".concat(t.message))}return[2]})})},e.prototype.getSessionReplayProperties=function(){return this.sr.getSessionReplayProperties()},e.pluginName="@amplitude/plugin-session-replay-browser",e}(),hH=function(e){return new h$(e)};function hJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}e.s(["sessionReplayPlugin",()=>hH],766269),e.s(["CUSTOM_DEVICE_ID_KEY",0,"_device-id"],261873);var hX=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=hJ({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in i)i[o]&&(s+="; "+o,!0!==i[o]&&(s+="="+i[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+s}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",hJ({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,hJ({},this.attributes,t))},withConverter:function(t){return e(hJ({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});e.s(["default",()=>hX],722045);let hQ={path:"/",maxAge:31536e3,sameSite:"strict",secure:"production"===e.i(568552).NEXT_PUBLIC_TARGET_SERVER};e.s(["DEVICE_ID_COOKIE_OPTIONS",0,hQ],502123)},427232,e=>{"use strict";let t,r="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),n=new Uint8Array(16),i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));e.s(["v4",0,function(e,s,o){if(r&&!s&&!e)return r();let a=(e=e||{}).random??e.rng?.()??function(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(n)}();if(a.length<16)throw Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){if((o=o||0)<0||o+16>s.length)throw RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);for(let e=0;e<16;++e)s[o+e]=a[e];return s}return function(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}(a)}],427232)},453126,e=>{"use strict";var t=e.i(840930),r=e.i(540193),n=e.i(766269),i=e.i(261873),s=e.i(568552),o=e.i(722045),a=e.i(502123),l=e.i(427232);let u={isValid:()=>!0,initialize:e=>{let t;if(!u.isValid())return;let c=(0,n.sessionReplayPlugin)({debugMode:!1});if((0,r.add)(c),s.isRenderingClient){t=o.default.get(i.CUSTOM_DEVICE_ID_KEY)??(0,l.v4)();let{maxAge:e,...r}=a.DEVICE_ID_COOKIE_OPTIONS;o.default.set(i.CUSTOM_DEVICE_ID_KEY,t,{...r,expires:365})}(0,r.init)("59d5f13d189dd18103dd5fd4eefcd402",void 0,{...e,deviceId:t})},logEvent:(e,t)=>{if(u.isValid()){if(!t)return void(0,r.track)(e);(0,r.track)(e,t)}},setUserProperties:({id:e,...n})=>{if(!u.isValid())return;let i=new t.Identify;for(let[e,t]of(i.set("[Amplitude] Version","3.92.0"),Object.entries(n)))i.set(e,t);(0,r.identify)(i),e&&(0,r.setUserId)(e)},getSessionId:()=>{if(u.isValid())return(0,r.getSessionId)()},setUserId:e=>{u.isValid()&&(0,r.setUserId)(e)},getDeviceId:()=>{if(u.isValid())return(0,r.getDeviceId)()},reset:()=>{u.isValid()&&(0,r.reset)()}};e.s(["Amplitude",0,u])}]);

//# sourceMappingURL=2c32686370ed2f7d.js.map
//# debugId=c35bd250-fb5b-5a1d-a523-e287f3ddc1fd
